num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 24.863731622695923
--------------- finish training step 0
0 68.13934707641602
step time = 22.984668731689453
--------------- finish training step 1
1 127.74417638778687
step time = 23.3493914604187
--------------- finish training step 2
2 189.0952832698822
step time = 20.478872299194336
--------------- finish training step 3
3 247.50443530082703
step time = 22.141541719436646
--------------- finish training step 4
4 306.92074847221375
step time = 22.200820207595825
--------------- finish training step 5
5 367.12718391418457
step time = 21.93042016029358
--------------- finish training step 6
6 426.7416923046112
step time = 21.84267282485962
--------------- finish training step 7
7 485.8287544250488
step time = 21.76569414138794
--------------- finish training step 8
8 545.2184550762177
step time = 21.302610635757446
--------------- finish training step 9
9 604.3844294548035
step time = 21.575194120407104
--------------- finish training step 10
10 663.5071449279785
step time = 21.432095050811768
--------------- finish training step 11
11 722.6437270641327
step time = 21.601568460464478
--------------- finish training step 12
12 781.7751159667969
step time = 21.758974313735962
--------------- finish training step 13
13 840.9825239181519
step time = 21.835991144180298
--------------- finish training step 14
14 900.3887033462524
step time = 22.09350562095642
--------------- finish training step 15
15 960.6304540634155
step time = 21.860145807266235
--------------- finish training step 16
16 1020.4389970302582
step time = 21.85204768180847
--------------- finish training step 17
17 1079.9416317939758
step time = 21.835456609725952
--------------- finish training step 18
18 1139.7707901000977
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 21.800004720687866
--------------- finish training step 19
19 1199.3761060237885
cuda 0: Peak memory 16.83 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17115 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17936 MiB | 421928 MiB | 417926 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    883 MiB | 446635 MiB | 446007 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     551    |   10980    |   10855    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   32272    |   32227    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1199.3764629364014
cuda 3: Peak memory 14.03 GB ; Persistent memory 0.80 GB


num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 19.516377925872803
--------------- finish training step 0
0 74.55824685096741
step time = 18.18209719657898
--------------- finish training step 1
1 136.20972180366516
step time = 18.6065993309021
--------------- finish training step 2
2 197.38808250427246
step time = 18.393953561782837
--------------- finish training step 3
3 258.9843258857727
step time = 18.51820158958435
--------------- finish training step 4
4 321.4902503490448
step time = 18.11265277862549
--------------- finish training step 5
5 382.9077935218811
step time = 18.495360374450684
--------------- finish training step 6
6 445.37020564079285
step time = 18.18320941925049
--------------- finish training step 7
7 507.059814453125
step time = 18.57143497467041
--------------- finish training step 8
8 569.9550542831421
step time = 18.128587245941162
--------------- finish training step 9
9 631.4895629882812
step time = 18.530179977416992
--------------- finish training step 10
10 694.1871271133423
step time = 18.247605562210083
--------------- finish training step 11
11 755.5223579406738
step time = 18.835952758789062
--------------- finish training step 12
12 818.6063349246979
step time = 26.69263243675232
--------------- finish training step 13
13 917.8313257694244
step time = 20.298486709594727
--------------- finish training step 14
14 987.9715349674225
step time = 20.068352699279785
--------------- finish training step 15
15 1057.7963345050812
step time = 19.626797437667847
--------------- finish training step 16
16 1125.567174911499
step time = 19.03800654411316
--------------- finish training step 17
17 1191.9485189914703
step time = 19.536311864852905
--------------- finish training step 18
18 1258.977870941162
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 18.995842456817627
--------------- finish training step 19
19 1324.6733400821686
cuda 0: Peak memory 16.17 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17250 MiB | 413812 MiB | 409810 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    911 MiB | 423331 MiB | 422703 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     538    |   10846    |   10721    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   31209    |   31164    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1324.6737008094788
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 21.08063578605652
--------------- finish training step 0
0 80.2094738483429

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
offload_parallel=True
step time = 18.675775051116943
--------------- finish training step 0
0 44.61975407600403
step time = 15.529860496520996
--------------- finish training step 1
1 75.8632128238678
step time = 15.419750690460205
--------------- finish training step 2
2 107.04262399673462
step time = 15.288419246673584
--------------- finish training step 3
3 139.95732259750366
step time = 15.914733648300171
--------------- finish training step 4
4 172.97492575645447
step time = 17.275418281555176
--------------- finish training step 5
5 207.7070460319519
step time = 17.698665618896484
--------------- finish training step 6
6 242.28898644447327
step time = 17.438642501831055
--------------- finish training step 7
7 276.8655014038086
step time = 17.946666955947876
--------------- finish training step 8
8 313.2763681411743
step time = 18.066956281661987
--------------- finish training step 9
9 350.1675250530243
step time = 18.13210892677307
--------------- finish training step 10
10 385.66743659973145
step time = 17.614225149154663
--------------- finish training step 11
11 421.86288189888
step time = 17.73995804786682
--------------- finish training step 12
12 458.10243248939514
step time = 18.13353419303894
--------------- finish training step 13
13 493.3263623714447
step time = 18.168978691101074
--------------- finish training step 14
14 529.0224533081055
step time = 17.87777614593506
--------------- finish training step 15
15 565.2812049388885
step time = 17.624396800994873
--------------- finish training step 16
16 601.3664436340332
step time = 18.127846002578735
--------------- finish training step 17
17 637.271810054779
step time = 17.180988073349
--------------- finish training step 18
18 672.2906241416931
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
step time = 16.932090520858765
--------------- finish training step 19
19 706.4169690608978
cuda 0: Peak memory 16.74 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17030 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  19826 MiB | 384664 MiB | 380662 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    858 MiB | 295201 MiB | 294574 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     152    |     596    |   10166    |   10014    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |      66    |   22142    |   22095    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 706.4170227050781
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
step time = 24.710232973098755
--------------- finish training step 0
0 72.15781331062317
step time = 21.885071516036987
--------------- finish training step 1
1 133.18341493606567
step time = 25.32851767539978
--------------- finish training step 2
2 198.25091886520386
step time = 19.593878030776978
--------------- finish training step 3
3 258.63245677948
step time = 20.684062004089355
--------------- finish training step 4
4 321.7777247428894
step time = 20.418142080307007
--------------- finish training step 5
5 384.8710401058197
step time = 20.510064363479614
--------------- finish training step 6
6 447.6583638191223
step time = 20.512695789337158
--------------- finish training step 7
7 511.39996433258057
step time = 20.515226125717163
--------------- finish training step 8
8 575.8372778892517
step time = 20.16586709022522
--------------- finish training step 9
9 640.1412084102631
step time = 18.05255675315857
--------------- finish training step 10
10 700.7620093822479
step time = 17.180485486984253
--------------- finish training step 11
11 760.8219766616821
step time = 18.646287441253662
--------------- finish training step 12
12 821.7458672523499
step time = 18.600390672683716
--------------- finish training step 13
13 879.9301719665527
step time = 18.57701587677002
--------------- finish training step 14
14 938.7449312210083
step time = 18.697574615478516
--------------- finish training step 15
15 996.8560156822205
step time = 18.753479480743408
--------------- finish training step 16
16 1055.2936544418335
step time = 18.72821307182312
--------------- finish training step 17
17 1113.650264263153
step time = 18.480738162994385
--------------- finish training step 18
18 1172.1280798912048
step time = 18.248053312301636
--------------- finish training step 19
19 1229.496661901474
cuda 0: Peak memory 18.12 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18446 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  19736 MiB | 386172 MiB | 382026 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1080 MiB | 465214 MiB | 464443 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     577    |   10123    |    9984    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      79    |   28996    |   28940    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1229.4967288970947
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 23.53296160697937
--------------- finish training step 0
0 77.49955940246582
step time = 22.23126745223999
--------------- finish training step 1
1 141.22230553627014
step time = 22.730512857437134
--------------- finish training step 2
2 211.95583510398865
step time = 22.882915496826172
--------------- finish training step 3
3 280.39039158821106
step time = 19.194226026535034
--------------- finish training step 4
4 343.44962310791016
step time = 19.652443885803223
--------------- finish training step 5
5 407.216609954834
step time = 19.73197841644287
--------------- finish training step 6
6 471.59037494659424
step time = 19.678691387176514
--------------- finish training step 7
7 535.4801247119904
step time = 19.58760929107666
--------------- finish training step 8
8 599.254998922348
step time = 19.283612728118896
--------------- finish training step 9
9 662.7395868301392
step time = 20.258301973342896
--------------- finish training step 10
10 729.4503121376038
step time = 20.3509521484375
--------------- finish training step 11
11 795.1337962150574
step time = 20.559025287628174
--------------- finish training step 12
12 860.7982959747314
step time = 20.42425012588501
--------------- finish training step 13
13 925.2704739570618
step time = 20.448516845703125
--------------- finish training step 14
14 990.6466081142426
step time = 20.447324752807617
--------------- finish training step 15
15 1055.71058011055
step time = 20.395715951919556
--------------- finish training step 16
16 1121.2480461597443
step time = 20.650866508483887
--------------- finish training step 17
17 1187.3548674583435
step time = 20.26167941093445
--------------- finish training step 18
18 1252.5649244785309
step time = 20.615692615509033
--------------- finish training step 19
19 1318.4851989746094
cuda 0: Peak memory 16.71 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  18278 MiB | 383572 MiB | 379426 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1104 MiB | 453226 MiB | 452455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     550    |   10081    |    9942    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      78    |   28395    |   28339    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1318.4852530956268
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB

num_iterations = 20
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
num_stages = 8
use_prefetch = True
step time = 21.424659967422485
step time = 21.424659967422485
--------------- finish training step 0
0 54.08203434944153
step time = 18.320717573165894
0 54.08203434944153
step time = 18.320717573165894
--------------- finish training step 1
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
--------------- finish training step 0
0 56.61219573020935
step time = 16.060291051864624
0 56.61219573020935
step time = 16.060291051864624
--------------- finish training step 1
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
--------------- finish training step 0
0 48.25616478919983
step time = 16.869024515151978
0 48.25616478919983
step time = 16.869024515151978
--------------- finish training step 1
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     805    |   73550    |   73353    |
| Allocations           |     197    |     805    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     805    |   73550    |   73352    |
| Active allocs         |     198    |     805    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     507    |     507    |     507    |       0    |
| GPU reserved segments |     507    |     507    |     507    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 22.406066179275513
use_prefetch = False
step time = 22.406066179275513
--------------- finish training step 0
0 65.700026512146
step time = 18.978885173797607
0 65.700026512146
step time = 18.978885173797607
--------------- finish training step 1
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations=3
use_prefetch=True
batch_size=64
step time = 20.160987377166748
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations = 20
training time = 54.773149490356445
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
use_offload = False
step time = 19.949572324752808
use_offload = False
step time = 19.949572324752808
--------------- finish training step 0
0 48.54816651344299
step time = 17.192211866378784
0 48.54816651344299
step time = 17.192211866378784
--------------- finish training step 1
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305


num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 471.60452485084534
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
use_offload = False
step time = 19.12251114845276
--------------- finish training step 0
0 43.66464161872864
step time = 15.67203664779663
--------------- finish training step 1
1 28.545896768569946
step time = 15.987875938415527
--------------- finish training step 2
2 28.66563391685486
step time = 17.17708444595337
--------------- finish training step 3
3 30.382317781448364
step time = 17.64166498184204
--------------- finish training step 4
4 31.663018941879272
step time = 17.64940333366394
--------------- finish training step 5
5 31.66824722290039
step time = 17.903267860412598
--------------- finish training step 6
6 31.436365604400635
step time = 20.92046594619751
--------------- finish training step 7
7 34.29251003265381
step time = 17.946186780929565
--------------- finish training step 8
8 31.8657443523407
step time = 19.449439525604248
--------------- finish training step 9
9 33.71455693244934
step time = 19.906930685043335
--------------- finish training step 10
10 34.53290939331055
step time = 19.109283685684204
--------------- finish training step 11
11 33.14331769943237
step time = 18.885144472122192
--------------- finish training step 12
12 33.04104280471802
step time = 20.192808866500854
--------------- finish training step 13
13 34.2590606212616
step time = 20.00261926651001
--------------- finish training step 14
14 34.37171030044556
step time = 18.838423013687134
--------------- finish training step 15
15 33.465172290802
step time = 17.021500825881958
--------------- finish training step 16
16 31.487219095230103
step time = 18.857378244400024
--------------- finish training step 17
17 32.70635223388672
step time = 17.46001148223877
--------------- finish training step 18
18 31.195889472961426
cuda 1: Peak memory 13.58 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 17.0458505153656
--------------- finish training step 19
19 30.199638843536377
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19220 MiB |  19220 MiB |  19220 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1398 MiB | 513615 MiB | 513455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     517    |     517    |     517    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     108    |   31419    |   31399    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 287.50726985931396
cuda 3: Peak memory 14.06 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
use_offload = False
step time = 19.595433473587036
--------------- finish training step 0
0 59.64639115333557
step time = 16.14384126663208
--------------- finish training step 1
1 37.17316555976868
step time = 17.667024850845337
--------------- finish training step 2
2 42.135369062423706
step time = 17.03650736808777
--------------- finish training step 3
3 42.166722536087036
step time = 17.830848455429077
--------------- finish training step 4
4 49.358429193496704
step time = 17.866095542907715
--------------- finish training step 5
5 47.08287000656128
step time = 16.534761667251587
--------------- finish training step 6
6 40.93154001235962
step time = 16.39327621459961
--------------- finish training step 7
7 41.48125505447388
step time = 16.762920141220093
--------------- finish training step 8
8 41.99731421470642
step time = 16.659029483795166
--------------- finish training step 9
9 41.52932858467102
step time = 16.785332679748535
--------------- finish training step 10
10 41.74692916870117
step time = 18.795286417007446
--------------- finish training step 11
11 43.79169940948486
step time = 18.635895252227783
--------------- finish training step 12
12 44.471111536026
step time = 17.551458597183228
--------------- finish training step 13
13 42.78916692733765
step time = 17.15884256362915
--------------- finish training step 14
14 41.94341540336609
step time = 16.799932956695557
--------------- finish training step 15
15 41.48331809043884
step time = 16.756672382354736
--------------- finish training step 16
16 41.567408084869385
step time = 16.831297636032104
--------------- finish training step 17
17 42.88751435279846
step time = 16.82323718070984
--------------- finish training step 18
18 41.8032660484314
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 16.813072204589844
--------------- finish training step 19
19 42.38776755332947
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 522.9292905330658

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.180036067962646
step time = 10.180036067962646
--------------- finish training step 0
0 23.298501014709473
step time = 7.600374460220337
0 23.298501014709473
step time = 7.600374460220337
--------------- finish training step 1
1 19.86466693878174
step time = 7.146616220474243
1 19.86466693878174
step time = 7.146616220474243
--------------- finish training step 2
2 18.986379623413086
step time = 8.571488380432129
2 18.986379623413086
step time = 8.571488380432129
--------------- finish training step 3
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB

num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.600994110107422
--------------- finish training step 0
0 27.40497922897339
step time = 1.4444868564605713
--------------- finish training step 1
1 9.515098094940186
step time = 3.184945583343506
--------------- finish training step 2
2 11.176170587539673
step time = 1.7937588691711426
--------------- finish training step 3
3 11.166242361068726
cuda 0: Peak memory 16.22 GB ; Persistent memory 1.29 GB
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.525535583496094
--------------- finish training step 0
0 29.448948621749878
step time = 7.097088813781738
--------------- finish training step 1
1 17.279617309570312
step time = 9.885040283203125
--------------- finish training step 0
0 20.28204107284546
step time = 7.365418910980225
--------------- finish training step 1
1 17.43230366706848
step time = 10.103328466415405
--------------- finish training step 0
0 21.366511821746826
step time = 7.378365993499756
--------------- finish training step 1
1 17.410562753677368
step time = 10.049835443496704
--------------- finish training step 0
0 21.349315404891968
step time = 7.523381948471069
--------------- finish training step 1
1 17.91798758506775
step time = 10.078152894973755
--------------- finish training step 0
0 21.9055233001709
step time = 7.35413670539856
--------------- finish training step 1
1 17.3370840549469
step time = 8.77133846282959
--------------- finish training step 2
2 19.62940263748169
step time = 7.868212938308716
--------------- finish training step 3
3 18.316538095474243
step time = 8.322901248931885
--------------- finish training step 4
4 19.187187671661377
step time = 8.42562484741211
--------------- finish training step 5
5 19.067073822021484
step time = 7.64095664024353
--------------- finish training step 6
6 18.147786140441895
step time = 8.607338428497314
--------------- finish training step 7
7 19.30187726020813
step time = 7.363936424255371
--------------- finish training step 8
8 17.744693994522095
step time = 8.81081485748291
--------------- finish training step 9
9 19.62404155731201
step time = 7.384002923965454
--------------- finish training step 10
10 17.750698804855347
step time = 8.891631841659546
--------------- finish training step 11
11 19.908173322677612
step time = 7.578248739242554
--------------- finish training step 12
12 17.815377950668335
step time = 8.790925025939941
--------------- finish training step 13
13 20.015196323394775
step time = 7.724750518798828
--------------- finish training step 14
14 18.106260299682617
step time = 8.503696918487549
--------------- finish training step 15
15 19.586467742919922
step time = 8.070767879486084
--------------- finish training step 16
16 18.801446437835693
step time = 7.69559383392334
--------------- finish training step 17
17 18.35729956626892
step time = 8.202224731445312
--------------- finish training step 18
18 19.23240900039673
step time = 7.65532922744751
--------------- finish training step 19
19 18.771678924560547
cuda 0: Peak memory 18.21 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  18650 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  18650 MiB |   2156 GiB |   2155 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  18550 MiB |   2150 GiB |   2149 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19914 MiB |  19914 MiB |  19914 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   1351 MiB | 752647 MiB | 752564 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     833    |  101427    |  101419    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     833    |  101427    |  101417    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     515    |     515    |     515    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      99    |   41271    |   41262    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 214.86233043670654
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB

num_iterations = 20
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.388191223144531
--------------- finish training step 0
0 32.45280909538269
step time = 8.409068822860718
--------------- finish training step 1
1 19.320743083953857
step time = 9.658365964889526
--------------- finish training step 0
0 22.85837745666504
step time = 7.769536018371582
--------------- finish training step 1
1 21.189732313156128
step time = 9.534030199050903
--------------- finish training step 0
0 22.71248197555542
step time = 7.510866403579712
--------------- finish training step 1
1 17.773910999298096
step time = 9.858023405075073
--------------- finish training step 0
0 21.43290615081787
step time = 8.175463676452637
--------------- finish training step 1
1 18.77081608772278
step time = 9.75309705734253
--------------- finish training step 0
0 20.335635662078857
step time = 8.492257356643677
--------------- finish training step 1
1 19.33380889892578
step time = 7.165947914123535
--------------- finish training step 2
2 17.625859022140503
step time = 8.489813327789307
--------------- finish training step 3
3 19.619999647140503
step time = 7.180657386779785
--------------- finish training step 4
4 17.622913360595703
step time = 8.375628471374512
--------------- finish training step 5
5 19.78968644142151
step time = 7.544250965118408
--------------- finish training step 6
6 18.238121032714844
step time = 7.962826251983643
--------------- finish training step 7
7 19.00403618812561
step time = 8.010213375091553
--------------- finish training step 8
8 19.41239285469055
step time = 7.210340738296509
--------------- finish training step 9
9 17.620264291763306
step time = 8.352503538131714
--------------- finish training step 10
10 19.714614629745483
step time = 7.149158954620361
--------------- finish training step 11
11 17.475462913513184
step time = 8.404289722442627
--------------- finish training step 12
12 19.94911479949951
step time = 7.06643009185791
--------------- finish training step 13
13 17.447338104248047
step time = 8.445520401000977
--------------- finish training step 14
14 19.891947507858276
step time = 7.117880821228027
--------------- finish training step 15
15 17.51951241493225
step time = 8.329583644866943
--------------- finish training step 16
16 19.285008430480957
step time = 7.136727571487427
--------------- finish training step 17
17 17.623753309249878
step time = 8.27351450920105
--------------- finish training step 18
18 19.271270036697388
step time = 7.108473300933838
--------------- finish training step 19
19 17.45956587791443
cuda 0: Peak memory 32.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34682 MiB |  34682 MiB |  34682 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB |   2110 MiB |   1118 GiB |   1118 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     833    |  102995    |  102987    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     833    |  102995    |  102985    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     559    |     559    |     559    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      82    |   40733    |   40728    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 216.66805577278137
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.700294971466064
--------------- finish training step 0
0 30.82059669494629
step time = 6.926929235458374
--------------- finish training step 1
1 16.85610604286194
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.33 GB
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.57 GB
step time = 7.726982593536377
--------------- finish training step 2
2 18.20749068260193
cuda 0: Peak memory 27.87 GB ; Persistent memory 1.57 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1606 MiB |  28537 MiB | 412996 MiB | 411390 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1670 MiB |  28537 MiB | 412996 MiB | 411326 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1670 MiB |  28537 MiB | 412996 MiB | 411325 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349813 KiB |    833 MiB |  83846 MiB |  83505 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      49    |     697    |   11424    |   11375    |
|---------------------------------------------------------------------------|
| Active allocs         |      52    |     697    |   11424    |   11372    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      36    |    3565    |    3550    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 41.52961826324463
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.33 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.825533151626587
--------------- finish training step 0
0 30.3154513835907
step time = 6.971526145935059
--------------- finish training step 1
1 16.7472927570343
step time = 9.742247581481934
--------------- finish training step 0
0 20.12493586540222
step time = 7.316663026809692
--------------- finish training step 1
1 17.430805683135986
step time = 10.103415966033936
--------------- finish training step 0
0 23.12777042388916
step time = 8.665213108062744
--------------- finish training step 1
1 19.87171483039856
step time = 14.87504267692566
--------------- finish training step 0
0 26.081040143966675
step time = 9.161521673202515
--------------- finish training step 1
1 22.653180599212646
step time = 10.025335788726807
--------------- finish training step 0
0 20.92841148376465
step time = 8.367968559265137
--------------- finish training step 1
1 18.990674257278442
step time = 7.18370509147644
--------------- finish training step 2
2 17.43733048439026
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 344846 MiB | 344764 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      35    |   14045    |   14040    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 31.77884578704834
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.323086261749268
--------------- finish training step 0
0 29.83410334587097
step time = 6.912308216094971
--------------- finish training step 1
1 16.987714767456055
step time = 9.932269811630249
--------------- finish training step 0
0 21.223907947540283
step time = 8.109301805496216
--------------- finish training step 1
1 19.40508460998535
step time = 9.785153865814209
--------------- finish training step 0
0 21.00533628463745
step time = 8.340044975280762
--------------- finish training step 1
1 19.265332460403442
step time = 9.672089338302612
--------------- finish training step 0
0 20.280792713165283
step time = 8.60212516784668
--------------- finish training step 1
1 20.143778085708618
step time = 10.235557317733765
--------------- finish training step 0
0 21.93871545791626
step time = 8.620615720748901
--------------- finish training step 1
1 19.923208236694336
step time = 10.133023500442505
--------------- finish training step 2
2 21.328728437423706
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.54 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 732693 KiB | 344590 MiB | 344508 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      35    |   14032    |   14027    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.20090174674988
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.819866418838501
--------------- finish training step 0
0 30.042145252227783
step time = 6.938736200332642
--------------- finish training step 1
1 16.763733386993408
step time = 9.607038974761963
--------------- finish training step 0
0 19.8370623588562
step time = 7.203342437744141
--------------- finish training step 1
1 17.45730757713318
step time = 9.787200212478638
--------------- finish training step 0
0 20.71773862838745
step time = 8.202457904815674
--------------- finish training step 1
1 18.72393560409546
step time = 10.080139636993408
--------------- finish training step 0
0 26.684693098068237
step time = 8.087461709976196
--------------- finish training step 1
1 19.05155062675476
step time = 9.538063049316406
--------------- finish training step 0
0 20.088014841079712
step time = 7.247832298278809
--------------- finish training step 1
1 17.866029977798462
step time = 7.980339050292969
--------------- finish training step 2
2 18.85814332962036
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 345806 MiB | 345724 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      34    |   14055    |   14050    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 32.04544138908386
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.636011600494385
--------------- finish training step 0
0 29.67675018310547
step time = 6.998462200164795
--------------- finish training step 1
1 16.83334445953369
step time = 9.382531642913818
--------------- finish training step 0
0 19.174596309661865
step time = 9.668797731399536
--------------- finish training step 1
1 22.577726125717163
step time = 9.75375747680664
--------------- finish training step 0
0 25.191123962402344
step time = 7.331257104873657
--------------- finish training step 1
1 23.750856161117554
step time = 9.841214179992676
--------------- finish training step 0
0 21.667083263397217
step time = 8.330809831619263
--------------- finish training step 1
1 19.137477159500122
step time = 9.654526472091675
--------------- finish training step 0
0 19.920425415039062
step time = 8.590058326721191
--------------- finish training step 1
1 19.12352466583252
step time = 7.203738689422607
--------------- finish training step 2
2 17.582097053527832
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.54 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 346062 MiB | 345980 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      34    |   14075    |   14070    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 31.17715549468994
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.758909225463867
--------------- finish training step 0
0 32.29473257064819
step time = 8.143991947174072
--------------- finish training step 1
1 20.583457231521606
step time = 9.784606456756592
--------------- finish training step 0
0 21.839608192443848
step time = 8.47372317314148
--------------- finish training step 1
1 19.831454753875732
step time = 9.59046721458435
--------------- finish training step 0
0 20.57792019844055
step time = 8.117748975753784
--------------- finish training step 1
1 19.348073482513428
step time = 9.703936576843262
--------------- finish training step 0
0 20.901787519454956
step time = 7.019090890884399
--------------- finish training step 1
1 18.3791401386261
step time = 9.828765869140625
--------------- finish training step 0
0 22.22789478302002
step time = 8.268155813217163
--------------- finish training step 1
1 19.551173210144043
step time = 7.268896102905273
--------------- finish training step 2
2 18.217031240463257
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28820 MiB |  28820 MiB |  28820 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 691557 KiB | 337368 MiB | 337286 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     685    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     685    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     491    |     491    |     491    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      25    |   13463    |   13458    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.62977147102356
cuda 3: Peak memory 27.34 GB ; Persistent memory 0.54 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.29 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 11.907840967178345
--------------- finish training step 0
0 37.96296167373657
step time = 10.536652088165283
--------------- finish training step 1
1 24.12561297416687
step time = 13.62424898147583
--------------- finish training step 0
0 26.755193948745728
step time = 10.089781999588013
--------------- finish training step 1
1 25.382238388061523
step time = 10.795048952102661
--------------- finish training step 0
0 25.2339768409729
step time = 8.129295349121094
--------------- finish training step 1
1 24.86712408065796
step time = 10.54201626777649
--------------- finish training step 0
0 23.905683517456055
step time = 8.65411901473999
--------------- finish training step 1
1 21.263031482696533
step time = 10.743642330169678
--------------- finish training step 0
0 22.64579749107361
step time = 9.044533014297485
--------------- finish training step 1
1 21.940186977386475
step time = 7.838865756988525
--------------- finish training step 2
2 20.6036958694458
cuda 0: Peak memory 27.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28820 MiB |  28820 MiB |  28820 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 691557 KiB | 338488 MiB | 338406 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     685    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     685    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     491    |     491    |     491    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      25    |   13498    |   13493    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 37.5621280670166
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.34 GB ; Persistent memory 0.54 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.29 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 11.916611433029175
--------------- finish training step 0
0 39.656327962875366
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 24.00110960006714
--------------- finish training step 0
0 69.80800104141235
step time = 0.0003046989440917969
--------------- finish training step 1
1 10.880838394165039
step time = 0.00026416778564453125
--------------- finish training step 2
2 11.02877688407898
cuda 2: Peak memory 32.94 GB ; Persistent memory 12.43 GB
cuda 0: Peak memory 33.92 GB ; Persistent memory 13.67 GB
cuda 3: Peak memory 33.40 GB ; Persistent memory 12.68 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34956 MiB |  34956 MiB |  34956 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 527467 KiB | 658783 KiB |  67261 MiB |  66746 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     397    |     881    |   11040    |   10643    |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     881    |   11040    |   10642    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     599    |     599    |     599    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      23    |    2921    |    2901    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 67.71541786193848
cuda 1: Peak memory 32.94 GB ; Persistent memory 12.43 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 22.6373929977417
--------------- finish training step 0
0 67.95425415039062
step time = 0.00030040740966796875
--------------- finish training step 1
1 10.211488723754883
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 25.637232542037964
--------------- finish training step 0
0 70.5726523399353
step time = 0.00025463104248046875
--------------- finish training step 1
1 9.481906414031982
step time = 27.25737476348877
--------------- finish training step 0
0 56.48922300338745
step time = 0.0008327960968017578
--------------- finish training step 1
1 10.822683572769165
step time = 27.83768892288208
--------------- finish training step 0
0 57.51945734024048
step time = 0.00028824806213378906
--------------- finish training step 1
1 10.166680335998535
step time = 27.149933338165283
--------------- finish training step 0
0 55.92431163787842
step time = 0.0002884864807128906
--------------- finish training step 1
1 10.2383394241333
step time = 27.493374347686768
--------------- finish training step 0
0 57.42056894302368
step time = 0.00031185150146484375
--------------- finish training step 1
1 9.352262020111084
step time = 0.0008356571197509766
--------------- finish training step 2
2 9.261133909225464
cuda 2: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 33.40 GB ; Persistent memory 0.54 GB
cuda 0: Peak memory 33.92 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34956 MiB |  34956 MiB |  34956 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 658783 KiB | 312755 MiB | 312674 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     881    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     881    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     599    |     599    |     599    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      32    |   13047    |   13042    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 48.53898477554321
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 26.469393491744995
--------------- finish training step 0
0 56.06120443344116
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 25.660261631011963
--------------- finish training step 0
0 56.489152669906616
step time = 0.0003230571746826172
--------------- finish training step 1
1 10.703224897384644
step time = 26.44949197769165
--------------- finish training step 0
0 42.74637985229492
step time = 0.0006339550018310547
--------------- finish training step 1
1 11.330305337905884
step time = 25.192777395248413
--------------- finish training step 0
0 41.80966806411743
step time = 0.0002827644348144531
--------------- finish training step 1
1 10.0082426071167
step time = 26.548762798309326
--------------- finish training step 0
0 41.60054397583008
step time = 0.0006091594696044922
--------------- finish training step 1
1 11.121718168258667
step time = 27.443828344345093
--------------- finish training step 0
0 41.876142740249634
step time = 0.0003058910369873047
--------------- finish training step 1
1 10.153691530227661
step time = 0.0008194446563720703
--------------- finish training step 2
2 9.622679233551025
cuda 0: Peak memory 33.92 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14620 MiB |  35138 MiB | 118014 MiB | 103394 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB |   1099 MiB | 285957 MiB | 285843 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     881    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     881    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     257    |     600    |    2001    |    1744    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      39    |   10807    |   10801    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.207101583480835
cuda 2: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 33.48 GB ; Persistent memory 0.61 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 11.960780382156372
--------------- finish training step 0
0 28.267382621765137
step time = 10.351572751998901
--------------- finish training step 1
1 25.682641983032227
step time = 12.555165529251099
--------------- finish training step 0
0 28.470035076141357
step time = 12.595574140548706
--------------- finish training step 1
1 28.13100028038025
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 12.25487232208252
--------------- finish training step 0
0 27.32117247581482
step time = 9.00562071800232
--------------- finish training step 1
1 23.97038221359253
step time = 12.37321662902832
--------------- finish training step 0
0 28.436214923858643
step time = 10.318939447402954
--------------- finish training step 1
1 25.206428050994873
step time = 12.920966863632202
--------------- finish training step 0
0 27.018675565719604
step time = 10.401087760925293
--------------- finish training step 1
1 23.484978437423706
step time = 11.228470802307129
--------------- finish training step 0
0 27.320295333862305
step time = 9.747352600097656
--------------- finish training step 1
1 25.27406668663025
step time = 13.096773386001587
--------------- finish training step 0
0 29.82119631767273
step time = 9.637814998626709
--------------- finish training step 1
1 22.543370008468628
step time = 11.045491218566895
--------------- finish training step 2
2 25.14215874671936
cuda 2: Peak memory 15.67 GB ; Persistent memory 0.58 GB
cuda 3: Peak memory 16.06 GB ; Persistent memory 0.83 GB
cuda 1: Peak memory 15.67 GB ; Persistent memory 0.58 GB
cuda 0: Peak memory 16.16 GB ; Persistent memory 0.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    847 MiB |  16547 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    879 MiB |  16547 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    879 MiB |  16439 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1562 MiB |  19438 MiB |  90970 MiB |  89408 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 262903 KiB | 726347 KiB | 197271 MiB | 197014 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      16    |     705    |   39861    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |     705    |   39861    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      44    |     536    |    2522    |    2478    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      77    |   12510    |   12492    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 43.726093769073486
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.843275785446167
--------------- finish training step 0
0 56.2390251159668
step time = 0.0005695819854736328
--------------- finish training step 1
1 7.64837908744812
step time = 21.262930870056152
--------------- finish training step 0
0 46.45734357833862
step time = 0.0005884170532226562
--------------- finish training step 1
1 8.511941194534302
step time = 20.914355039596558
--------------- finish training step 0
0 46.29129695892334
step time = 0.0002510547637939453
--------------- finish training step 1
1 8.592395067214966
step time = 20.72027277946472
--------------- finish training step 0
0 46.40522766113281
step time = 0.0005424022674560547
--------------- finish training step 1
1 8.979269742965698
step time = 20.431649923324585
--------------- finish training step 0
0 45.818278789520264
step time = 0.0005967617034912109
--------------- finish training step 1
1 9.249359607696533
step time = 0.0006515979766845703
--------------- finish training step 2
2 7.811931610107422
cuda 0: Peak memory 22.15 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  22681 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  22681 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  22574 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14258 MiB |  24908 MiB |  65674 MiB |  51416 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 106231 KiB |    822 MiB | 237972 MiB | 237868 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     881    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     881    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     273    |     615    |    1808    |    1535    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      57    |   12382    |   12376    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 42.446077823638916
cuda 1: Peak memory 21.42 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 21.42 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 21.88 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.42607021331787
--------------- finish training step 0
0 54.97280979156494
step time = 17.96532106399536
--------------- finish training step 1
1 42.86231875419617
step time = 21.208235025405884
--------------- finish training step 0
0 46.91362285614014
step time = 18.299522161483765
--------------- finish training step 1
1 43.53775119781494
step time = 20.818448781967163
--------------- finish training step 0
0 46.354289054870605
step time = 17.884222269058228
--------------- finish training step 1
1 43.531983852386475
step time = 20.802207708358765
--------------- finish training step 0
0 47.34784722328186
step time = 17.910446882247925
--------------- finish training step 1
1 43.78108787536621
step time = 21.37635040283203
--------------- finish training step 0
0 47.305153131484985
step time = 17.951921224594116
--------------- finish training step 1
1 43.62018585205078
step time = 18.064619541168213
--------------- finish training step 2
2 43.899482011795044
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 16.09 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16478 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16478 MiB |    847 GiB |    847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16366 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1302 MiB |  17640 MiB |  83448 MiB |  82146 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  34551 KiB | 577443 KiB | 146656 MiB | 146622 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     689    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     689    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      41    |     497    |    2352    |    2311    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      55    |   12133    |   12128    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.43130803108215
cuda 3: Peak memory 15.82 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.736466646194458
--------------- finish training step 0
0 30.046811819076538
step time = 7.40253758430481
--------------- finish training step 1
1 17.53631019592285
step time = 9.670822143554688
--------------- finish training step 0
0 20.178544998168945
step time = 7.343843698501587
--------------- finish training step 1
1 17.39451003074646
step time = 9.752651929855347
--------------- finish training step 0
0 20.41055989265442
step time = 8.142191410064697
--------------- finish training step 1
1 18.224075078964233
step time = 9.686221837997437
--------------- finish training step 0
0 19.786240577697754
step time = 8.662398338317871
--------------- finish training step 1
1 19.35565710067749
step time = 9.686880111694336
--------------- finish training step 0
0 20.31678557395935
step time = 8.427072286605835
--------------- finish training step 1
1 26.562328577041626
step time = 8.340011358261108
--------------- finish training step 2
2 19.227943181991577
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4610 MiB |  18664 MiB |  75758 MiB |  71148 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 499249 KiB | 180065 MiB | 179965 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2107    |    2008    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12630    |   12620    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 39.652541637420654
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.563680171966553
--------------- finish training step 0
0 28.87427067756653
step time = 8.747629165649414
--------------- finish training step 1
1 19.277730703353882
step time = 9.774659872055054
--------------- finish training step 0
0 19.622090578079224
step time = 8.41214394569397
--------------- finish training step 1
1 18.478331089019775
step time = 9.823127269744873
--------------- finish training step 0
0 20.21616220474243
step time = 7.476970911026001
--------------- finish training step 1
1 17.710662841796875
step time = 9.937883853912354
--------------- finish training step 0
0 20.685786247253418
step time = 8.331696510314941
--------------- finish training step 1
1 18.424843788146973
step time = 9.824016332626343
--------------- finish training step 0
0 19.91899299621582
step time = 8.623204231262207
--------------- finish training step 1
1 18.851457834243774
step time = 7.391934633255005
--------------- finish training step 2
2 17.40852689743042
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4594 MiB |  18664 MiB |  75526 MiB |  70932 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 541809 KiB | 184481 MiB | 184381 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2107    |    2008    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12057    |   12047    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 30.33925175666809
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.319559097290039
--------------- finish training step 0
0 28.50598454475403
step time = 7.2542760372161865
--------------- finish training step 1
1 18.111726760864258
step time = 9.69202995300293
--------------- finish training step 0
0 20.79534149169922
step time = 7.520951271057129
--------------- finish training step 1
1 17.179726123809814
step time = 9.612393617630005
--------------- finish training step 0
0 19.607954025268555
step time = 8.149372339248657
--------------- finish training step 1
1 18.35782527923584
step time = 9.62613296508789
--------------- finish training step 0
0 19.677545070648193
step time = 8.312610149383545
--------------- finish training step 1
1 18.2513267993927
step time = 9.605538129806519
--------------- finish training step 0
0 19.316095113754272
step time = 8.234780311584473
--------------- finish training step 1
1 18.239602088928223
step time = 7.466759443283081
--------------- finish training step 2
2 17.354149341583252
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4610 MiB |  18664 MiB |  75666 MiB |  71056 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 541809 KiB | 182916 MiB | 182816 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2110    |    2011    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12383    |   12373    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 29.602224588394165
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.372409105300903
--------------- finish training step 0
0 28.645846366882324
step time = 7.18204927444458
--------------- finish training step 1
1 16.888756036758423
step time = 9.766259670257568
--------------- finish training step 0
0 19.872811794281006
step time = 7.670428037643433
--------------- finish training step 1
1 17.667900800704956
step time = 9.684253215789795
--------------- finish training step 0
0 19.76660394668579
step time = 8.233965158462524
--------------- finish training step 1
1 18.330552101135254
step time = 9.70747184753418
--------------- finish training step 0
0 19.90759301185608
step time = 8.54028606414795
--------------- finish training step 1
1 19.16215944290161
step time = 9.663204669952393
--------------- finish training step 0
0 19.983992099761963
step time = 8.238024711608887
--------------- finish training step 1
1 18.48824119567871
step time = 7.687150716781616
--------------- finish training step 2
2 18.054667711257935
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4610 MiB |  18664 MiB |  75742 MiB |  71132 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 499249 KiB | 180789 MiB | 180689 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2108    |    2009    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12667    |   12657    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 30.938010692596436
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.315242290496826
--------------- finish training step 0
0 29.001634120941162
step time = 7.318464756011963
--------------- finish training step 1
1 17.290828943252563
step time = 9.90916109085083
--------------- finish training step 0
0 20.321507453918457
step time = 7.661689281463623
--------------- finish training step 1
1 17.681801080703735
step time = 9.909854173660278
--------------- finish training step 0
0 21.053874969482422
step time = 8.320711374282837
--------------- finish training step 1
1 19.50583267211914
step time = 9.726086854934692
--------------- finish training step 0
0 20.733744144439697
step time = 8.632349729537964
--------------- finish training step 1
1 20.008684396743774
step time = 9.62899136543274
--------------- finish training step 0
0 20.242904663085938
step time = 7.7652060985565186
--------------- finish training step 1
1 18.29443097114563
step time = 7.721268177032471
--------------- finish training step 2
2 18.877309560775757
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4610 MiB |  18664 MiB |  75742 MiB |  71132 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 499249 KiB | 181923 MiB | 181823 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2106    |    2007    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12711    |   12701    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 32.298646688461304
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.919838190078735
--------------- finish training step 0
0 32.29748344421387
step time = 6.957188606262207
--------------- finish training step 1
1 17.757503986358643
step time = 10.070876598358154
--------------- finish training step 0
0 21.763859033584595
step time = 8.160671710968018
--------------- finish training step 1
1 19.451001405715942
step time = 9.864299058914185
--------------- finish training step 0
0 21.410892248153687
step time = 7.9353346824646
--------------- finish training step 1
1 19.15176820755005
step time = 9.885728120803833
--------------- finish training step 0
0 21.806146144866943
step time = 8.224470615386963
--------------- finish training step 1
1 19.456243753433228
step time = 9.733611822128296
--------------- finish training step 0
0 20.717439651489258
step time = 8.505040168762207
--------------- finish training step 1
1 20.039846181869507
step time = 7.221930503845215
--------------- finish training step 2
2 19.219451665878296
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 16.10 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16484 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16374 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4594 MiB |  18664 MiB |  75758 MiB |  71164 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 102135 KiB | 499249 KiB | 179697 MiB | 179597 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     701    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     701    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      99    |     510    |    2107    |    2008    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      10    |      56    |   12595    |   12585    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.5155987739563
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.588082313537598
--------------- finish training step 0
0 29.049787521362305
step time = 6.880557537078857
--------------- finish training step 1
1 16.53836226463318
step time = 9.631385564804077
--------------- finish training step 0
0 19.820826768875122
step time = 7.432355165481567
--------------- finish training step 1
1 19.460076093673706
step time = 9.832736015319824
--------------- finish training step 0
0 24.44250798225403
step time = 8.377887487411499
--------------- finish training step 1
1 18.846691370010376
step time = 9.884411334991455
--------------- finish training step 0
0 29.588735818862915
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 23.5566463470459
--------------- finish training step 0
0 46.42674684524536
step time = 20.947749376296997
--------------- finish training step 1
1 33.725494384765625
step time = 24.376872301101685
--------------- finish training step 0
0 37.16378974914551
step time = 20.468639850616455
--------------- finish training step 1
1 33.60290265083313
step time = 24.710203647613525
--------------- finish training step 0
0 38.05033326148987
step time = 21.061258554458618
--------------- finish training step 1
1 34.51597738265991
step time = 23.923582077026367
--------------- finish training step 0
0 37.808340549468994
step time = 20.579644918441772
--------------- finish training step 1
1 33.55229377746582
step time = 23.135063409805298
--------------- finish training step 0
0 36.651971101760864
step time = 19.229844570159912
--------------- finish training step 1
1 32.31110453605652
step time = 21.835039377212524
--------------- finish training step 2
2 35.4091317653656
cuda 2: Peak memory 16.87 GB ; Persistent memory 0.28 GB
cuda 1: Peak memory 16.87 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 17.33 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 17.60 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  18026 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  18026 MiB |    847 GiB |    846 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  17918 MiB |    845 GiB |    844 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4548 MiB |  19176 MiB |  76656 MiB |  72108 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 124663 KiB | 775921 KiB | 207802 MiB | 207680 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     737    |   39853    |   39845    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     737    |   39853    |   39843    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      98    |     516    |    2114    |    2016    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      65    |   12899    |   12890    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 40.171658754348755

num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 24.184085845947266
--------------- finish training step 0
0 48.36685657501221
step time = 16.17236590385437
--------------- finish training step 1
1 29.058332920074463
step time = 23.18843150138855
--------------- finish training step 0
0 40.703513383865356
step time = 20.485586166381836
--------------- finish training step 1
1 38.14767837524414
step time = 24.45735788345337
--------------- finish training step 0
0 38.10867238044739
step time = 20.720109701156616
--------------- finish training step 1
1 36.304699182510376
step time = 24.6000554561615
--------------- finish training step 0
0 38.296220779418945
step time = 22.749821662902832
--------------- finish training step 1
1 41.13282012939453
step time = 20.95797085762024
--------------- finish training step 0
0 34.793473958969116
step time = 17.2252037525177
--------------- finish training step 1
1 30.662105560302734
step time = 16.90984058380127
--------------- finish training step 2
2 30.024677276611328
cuda 1: Peak memory 28.39 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 28.39 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 28.94 GB ; Persistent memory 0.61 GB
cuda 0: Peak memory 29.38 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4856 MiB |  30334 MiB | 131722 MiB | 126866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 149239 KiB | 581297 KiB | 258025 MiB | 257879 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     737    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     737    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      90    |     516    |    2238    |    2148    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      26    |   11405    |   11398    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 40.38660192489624

num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 24.129395246505737
--------------- finish training step 0
0 46.370057106018066
step time = 14.856693267822266
--------------- finish training step 1
1 27.3065128326416
step time = 20.937771558761597
--------------- finish training step 0
0 33.58588409423828
step time = 20.698240756988525
--------------- finish training step 1
1 39.12255311012268
step time = 23.603280782699585
--------------- finish training step 0
0 36.12623047828674
step time = 17.322842597961426
--------------- finish training step 1
1 30.00118923187256
step time = 22.626514196395874
--------------- finish training step 0
0 35.26111459732056
step time = 17.021589279174805
--------------- finish training step 1
1 29.958269834518433
step time = 20.521435976028442
--------------- finish training step 0
0 32.70669436454773
step time = 15.192501544952393
--------------- finish training step 1
1 27.751564741134644
step time = 16.652600049972534
--------------- finish training step 2
2 28.731011152267456
cuda 2: Peak memory 34.44 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 34.44 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 34.99 GB ; Persistent memory 0.61 GB
cuda 0: Peak memory 29.38 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  30081 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4886 MiB |  33762 MiB | 145758 MiB | 140872 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB | 763169 KiB | 243437 MiB | 243353 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     737    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     737    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      97    |     591    |    2518    |    2421    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      28    |   10741    |   10735    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 36.82220196723938
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 24.73169207572937
--------------- finish training step 0
0 43.28072428703308
step time = 23.828550577163696
--------------- finish training step 1
1 34.95625305175781
step time = 28.236430406570435
--------------- finish training step 0
0 39.818543434143066
step time = 22.741376399993896
--------------- finish training step 1
1 33.81297302246094
step time = 24.39912986755371
--------------- finish training step 0
0 34.90819549560547
step time = 20.58033299446106
--------------- finish training step 1
1 31.732577562332153
step time = 25.70254421234131
--------------- finish training step 0
0 36.95048713684082
step time = 21.93141508102417
--------------- finish training step 1
1 32.71791195869446
step time = 24.227333307266235
--------------- finish training step 0
0 34.590680837631226
step time = 16.858624696731567
--------------- finish training step 1
1 27.95362401008606
cuda 1: Peak memory 34.44 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 34.99 GB ; Persistent memory 0.61 GB
cuda 2: Peak memory 34.44 GB ; Persistent memory 0.29 GB
step time = 20.147990703582764
--------------- finish training step 2
2 31.22087836265564
cuda 0: Peak memory 29.38 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  30081 MiB |   1542 GiB |   1542 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  30081 MiB |   1542 GiB |   1542 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  30081 MiB |   1542 GiB |   1542 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5100 MiB |  36004 MiB | 154990 MiB | 149890 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |    905 MiB | 277414 MiB | 277330 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     737    |   41525    |   41517    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     737    |   41525    |   41515    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      74    |     542    |    2397    |    2323    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      39    |   11483    |   11477    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 32.53062462806702
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.727757215499878
--------------- finish training step 0
0 40.06654334068298
step time = 16.848169565200806
--------------- finish training step 1
1 27.8014919757843
step time = 20.42622709274292
--------------- finish training step 0
0 30.87837266921997
step time = 18.421541690826416
--------------- finish training step 1
1 29.49836254119873
step time = 19.515869140625
--------------- finish training step 0
0 30.68901491165161
step time = 21.47381043434143
--------------- finish training step 1
1 32.977272033691406
step time = 20.662081003189087
--------------- finish training step 0
0 32.63997530937195
step time = 17.191375732421875
--------------- finish training step 1
1 28.9844388961792
step time = 22.09775185585022
--------------- finish training step 0
0 33.400246381759644
step time = 17.266231060028076
--------------- finish training step 1
1 28.051122903823853
step time = 20.04201579093933
--------------- finish training step 0
0 30.62597131729126
step time = 16.838757038116455
--------------- finish training step 1
1 27.636263370513916
step time = 15.973728895187378
--------------- finish training step 2
2 27.277215003967285
step time = 15.792192220687866
--------------- finish training step 3
3 26.62414526939392
cuda 1: Peak memory 38.92 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 38.20 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 39.55 GB ; Persistent memory 0.63 GB
cuda 0: Peak memory 29.63 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5562 MiB |  36090 MiB | 185684 MiB | 180122 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   1104 MiB | 362466 MiB | 362382 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     745    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     745    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      84    |     543    |    2873    |    2789    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      47    |   14792    |   14786    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 43.516159772872925
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.740076541900635
--------------- finish training step 0
0 39.705145597457886
step time = 17.7034432888031
--------------- finish training step 1
1 28.757333993911743
step time = 21.53688955307007
--------------- finish training step 0
0 33.04762554168701
step time = 18.80698537826538
--------------- finish training step 1
1 30.72996950149536
step time = 20.227535009384155
--------------- finish training step 0
0 31.346299648284912
step time = 17.908424377441406
--------------- finish training step 1
1 34.662785053253174
step time = 20.638176202774048
--------------- finish training step 0
0 32.486857891082764
step time = 17.261539697647095
--------------- finish training step 1
1 28.627350568771362
step time = 20.39819025993347
--------------- finish training step 0
0 31.650072813034058
step time = 17.097251892089844
--------------- finish training step 1
1 28.060749769210815
step time = 20.502103090286255
--------------- finish training step 0
0 31.833653926849365
step time = 16.41395139694214
--------------- finish training step 1
1 27.406173706054688
step time = 16.74937152862549
--------------- finish training step 2
2 27.926708698272705
step time = 15.61562967300415
--------------- finish training step 3
3 26.8672776222229
cuda 1: Peak memory 38.98 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 38.98 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 39.55 GB ; Persistent memory 0.63 GB
cuda 0: Peak memory 29.63 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  30337 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   5734 MiB |  33510 MiB | 394606 MiB | 388872 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB |   1015 MiB | 217526 MiB | 217410 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     745    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     745    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      80    |     519    |    6293    |    6213    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      44    |   10599    |   10592    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 42.94113326072693
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.414824724197388
--------------- finish training step 0
0 40.378570795059204
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 20.43213725090027
--------------- finish training step 0
0 40.30150246620178
step time = 14.955436944961548
--------------- finish training step 1
1 27.526837587356567
step time = 20.9586660861969
--------------- finish training step 0
0 36.820160150527954
step time = 16.728487730026245
--------------- finish training step 1
1 27.883214950561523
step time = 20.54480290412903
--------------- finish training step 0
0 32.12158823013306
step time = 16.746211767196655
--------------- finish training step 1
1 27.83473038673401
step time = 20.58458709716797
--------------- finish training step 0
0 32.37796211242676
step time = 16.816819667816162
--------------- finish training step 1
1 27.60846209526062
step time = 20.59836459159851
--------------- finish training step 0
0 31.97746515274048
step time = 16.75005030632019
--------------- finish training step 1
1 27.83538579940796
step time = 20.682859182357788
--------------- finish training step 0
0 32.26917505264282
step time = 16.535690784454346
--------------- finish training step 1
1 27.50532627105713
step time = 16.592405796051025
--------------- finish training step 2
2 28.039811611175537
step time = 15.740719079971313
--------------- finish training step 3
3 27.904434204101562
step time = 16.29448175430298
--------------- finish training step 4
4 27.17323112487793
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.37 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  31166 MiB | 434910 MiB | 432470 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 628179 KiB | 232085 MiB | 231969 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     717    |   56622    |   56614    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     717    |   56622    |   56612    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     502    |    6866    |    6811    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      36    |   11401    |   11394    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 54.706031799316406

num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 26.191640377044678
--------------- finish training step 0
0 59.390291690826416
step time = 19.35236692428589
--------------- finish training step 1
1 35.897528886795044
step time = 25.40716290473938
--------------- finish training step 0
0 43.03335094451904
step time = 23.5060977935791
--------------- finish training step 1
1 41.45929789543152
step time = 24.7820143699646
--------------- finish training step 0
0 41.00658130645752
step time = 21.32271957397461
--------------- finish training step 1
1 37.03544282913208
step time = 20.825167894363403
--------------- finish training step 0
0 37.5766077041626
step time = 21.20931315422058
--------------- finish training step 1
1 40.08700370788574
step time = 22.897006511688232
--------------- finish training step 0
0 35.384845495224
step time = 17.219547510147095
--------------- finish training step 1
1 29.928913593292236
step time = 23.690661907196045
--------------- finish training step 0
0 37.83256435394287
step time = 20.505962371826172
--------------- finish training step 1
1 32.30974459648132
step time = 18.58597159385681
--------------- finish training step 2
2 30.92237949371338
step time = 19.970832586288452
--------------- finish training step 3
3 32.91519021987915
step time = 21.090349435806274
--------------- finish training step 4
4 32.629859924316406
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 0: Peak memory 28.37 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  31166 MiB | 434910 MiB | 432470 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 628179 KiB | 231445 MiB | 231329 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     717    |   56622    |   56614    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     717    |   56622    |   56612    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     502    |    6866    |    6811    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      36    |   11381    |   11374    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 60.40731883049011
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 23.359182357788086
--------------- finish training step 0
0 45.76987671852112
step time = 16.770148992538452
--------------- finish training step 1
1 29.32833743095398
step time = 19.484509706497192
--------------- finish training step 0
0 35.410802602767944
step time = 15.505048274993896
--------------- finish training step 1
1 27.886516332626343
step time = 19.54935359954834
--------------- finish training step 0
0 31.189695596694946
step time = 16.26440668106079
--------------- finish training step 1
1 28.272955179214478
step time = 20.29798698425293
--------------- finish training step 0
0 32.82211089134216
step time = 16.4411723613739
--------------- finish training step 1
1 27.99421525001526
step time = 19.96865224838257
--------------- finish training step 0
0 32.562602519989014
step time = 17.040937662124634
--------------- finish training step 1
1 28.891478300094604
step time = 20.113442420959473
--------------- finish training step 0
0 32.35900616645813
step time = 15.330600500106812
--------------- finish training step 1
1 27.232390642166138
step time = 16.656620740890503
--------------- finish training step 2
2 29.80353569984436
step time = 17.04608416557312
--------------- finish training step 3
3 28.938635110855103
step time = 15.366841077804565
--------------- finish training step 4
4 27.39350724220276
step time = 16.736748218536377
--------------- finish training step 5
5 30.944560766220093
step time = 17.027690887451172
--------------- finish training step 6
6 28.66120982170105
step time = 15.48927927017212
--------------- finish training step 7
7 27.911543130874634
step time = 15.875433444976807
--------------- finish training step 8
8 29.3111515045166
step time = 17.059741258621216
--------------- finish training step 9
9 30.722167253494263
step time = 15.465796709060669
--------------- finish training step 10
10 27.874709129333496
step time = 16.46970248222351
--------------- finish training step 11
11 29.67243194580078
step time = 16.68021297454834
--------------- finish training step 12
12 29.057668447494507
step time = 15.944462776184082
--------------- finish training step 13
13 28.168548822402954
step time = 16.43894052505493
--------------- finish training step 14
14 28.301296949386597
step time = 16.378881692886353
--------------- finish training step 15
15 28.60709571838379
step time = 16.245002508163452
--------------- finish training step 16
16 29.622902154922485
step time = 16.04913020133972
--------------- finish training step 17
17 29.24669361114502
step time = 17.113362073898315
--------------- finish training step 18
18 29.660205602645874
step time = 17.068860054016113
--------------- finish training step 19
19 29.3324236869812
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 32.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  32889 MiB |   4206 GiB |   4205 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  32889 MiB |   4206 GiB |   4205 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  32889 MiB |   4206 GiB |   4205 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6756 MiB |  35006 MiB |    845 GiB |    839 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB |   1089 MiB | 471931 MiB | 471815 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     837    |  113232    |  113224    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     837    |  113232    |  113222    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     158    |     596    |   13592    |   13434    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      54    |   23075    |   23068    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 243.10335183143616
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
use_offload = False
step time = 25.07776165008545
--------------- finish training step 0
0 44.51900053024292
step time = 22.737663745880127
--------------- finish training step 1
1 37.18724060058594
step time = 21.910414934158325
--------------- finish training step 0
0 37.327383518218994
step time = 19.19476294517517
--------------- finish training step 1
1 37.16679120063782
step time = 20.78041982650757
--------------- finish training step 0
0 35.424718379974365
step time = 18.271954774856567
--------------- finish training step 1
1 32.46305775642395
step time = 24.77192521095276
--------------- finish training step 0
0 41.4375102519989
step time = 16.946280241012573
--------------- finish training step 1
1 28.769750833511353
step time = 20.73125386238098
--------------- finish training step 0
0 35.96866059303284
step time = 17.17530846595764
--------------- finish training step 1
1 31.526935815811157
step time = 20.46358299255371
--------------- finish training step 0
0 35.617470264434814
step time = 17.357187032699585
--------------- finish training step 1
1 31.313096523284912
step time = 16.78688669204712
--------------- finish training step 2
2 32.76434564590454
step time = 17.169929265975952
--------------- finish training step 3
3 30.40980315208435
step time = 18.00896167755127
--------------- finish training step 4
4 31.577197551727295
step time = 16.219690322875977
--------------- finish training step 5
5 30.209980487823486
step time = 17.037200450897217
--------------- finish training step 6
6 31.797101974487305
step time = 17.412879705429077
--------------- finish training step 7
7 29.983124494552612
step time = 16.450010776519775
--------------- finish training step 8
8 28.58422064781189
step time = 17.100829362869263
--------------- finish training step 9
9 31.26369881629944
step time = 16.598126888275146
--------------- finish training step 10
10 30.682103157043457
step time = 16.29414200782776
--------------- finish training step 11
11 32.012291431427
step time = 17.392489671707153
--------------- finish training step 12
12 30.609911680221558
step time = 17.336161613464355
--------------- finish training step 13
13 30.129594087600708
step time = 17.50257110595703
--------------- finish training step 14
14 32.091973543167114
step time = 16.850777864456177
--------------- finish training step 15
15 31.006388902664185
step time = 17.385734796524048
--------------- finish training step 16
16 30.810670137405396
step time = 17.684475898742676
--------------- finish training step 17
17 31.07930564880371
step time = 17.132233381271362
--------------- finish training step 18
18 31.534821271896362
step time = 18.36955165863037
--------------- finish training step 19
19 34.00746560096741
cuda 1: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 32.61 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6692 MiB |  34722 MiB |    839 GiB |    832 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB |    963 MiB | 461326 MiB | 461212 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     847    |  113952    |  113944    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     847    |  113952    |  113942    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     603    |   13847    |   13690    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      43    |   22231    |   22225    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 271.68600034713745
cuda 3: Peak memory 27.94 GB ; Persistent memory 0.63 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 4
seq_length = 256
use_prefetch = False
use_offload = False
step time = 22.03325915336609
--------------- finish training step 0
0 50.647146224975586
step time = 17.63775897026062
--------------- finish training step 1
1 30.44504189491272
step time = 20.814133405685425
--------------- finish training step 0
0 34.90454435348511
step time = 17.556232690811157
--------------- finish training step 1
1 33.31947898864746
step time = 22.488194704055786
--------------- finish training step 0
0 37.69230818748474
step time = 18.782352209091187
--------------- finish training step 1
1 34.141520977020264
step time = 22.53784990310669
--------------- finish training step 0
0 37.04931974411011
step time = 18.604328870773315
--------------- finish training step 1
1 34.00634217262268
step time = 22.533276557922363
--------------- finish training step 0
0 37.11635184288025
step time = 18.820190906524658
--------------- finish training step 1
1 34.318071365356445
step time = 22.79898190498352
--------------- finish training step 0
0 40.94784474372864
step time = 18.797445058822632
--------------- finish training step 1
1 33.55392646789551
step time = 19.059908866882324
--------------- finish training step 2
2 34.88717579841614
step time = 18.740270614624023
--------------- finish training step 3
3 33.526251792907715
step time = 18.59986639022827
--------------- finish training step 4
4 33.668466091156006
step time = 17.426268577575684
--------------- finish training step 5
5 32.982165575027466
step time = 18.639978885650635
--------------- finish training step 6
6 35.02811789512634
step time = 19.176828861236572
--------------- finish training step 7
7 34.66121864318848
step time = 18.47385597229004
--------------- finish training step 8
8 33.38522982597351
step time = 18.229653358459473
--------------- finish training step 9
9 33.69247269630432
step time = 17.704967260360718
--------------- finish training step 10
10 33.34997081756592
step time = 18.878364086151123
--------------- finish training step 11
11 35.2329535484314
step time = 18.443933963775635
--------------- finish training step 12
12 33.65356469154358
step time = 18.198525190353394
--------------- finish training step 13
13 33.72916054725647
step time = 17.86376643180847
--------------- finish training step 14
14 33.975815773010254
step time = 18.045926809310913
--------------- finish training step 15
15 34.74069333076477
step time = 18.672893524169922
--------------- finish training step 16
16 34.79772877693176
step time = 18.407079935073853
--------------- finish training step 17
17 34.162211894989014
step time = 18.311195611953735
--------------- finish training step 18
18 34.370906352996826
step time = 18.411333799362183
--------------- finish training step 19
19 34.70769715309143
cuda 1: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 31.88 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  32641 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  32673 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  32673 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8326 MiB |  36332 MiB |    868 GiB |    860 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   2627 MiB | 617999 MiB | 617915 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     841    |  112872    |  112864    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     842    |  112872    |  112862    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     155    |     570    |   13549    |   13394    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      93    |   26450    |   26444    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 306.9592123031616
cuda 2: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.23 GB ; Persistent memory 0.63 GB

num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 16
seq_length = 256
use_prefetch = False
offloadresize(0)
use_offload = False
step time = 26.235445737838745
--------------- finish training step 0
0 43.13700032234192
step time = 21.438014268875122
--------------- finish training step 1
1 32.76153302192688
step time = 24.70324444770813
--------------- finish training step 0
0 37.430861473083496
step time = 21.956364631652832
--------------- finish training step 1
1 32.987398862838745
step time = 20.078723192214966
--------------- finish training step 0
0 32.8829231262207
step time = 17.307514667510986
--------------- finish training step 1
1 30.44696068763733
step time = 20.83183979988098
--------------- finish training step 0
0 44.42490243911743
step time = 15.256153106689453
--------------- finish training step 1
1 27.464746952056885
step time = 21.78290820121765
--------------- finish training step 0
0 39.50627660751343
step time = 16.96654176712036
--------------- finish training step 1
1 28.799699783325195
step time = 19.8993558883667
--------------- finish training step 0
0 32.10793590545654
step time = 17.854557037353516
--------------- finish training step 1
1 29.343754768371582
step time = 15.1256685256958
--------------- finish training step 2
2 30.49228072166443
step time = 16.046589851379395
--------------- finish training step 3
3 28.842380046844482
step time = 16.608030796051025
--------------- finish training step 4
4 33.86019778251648
cuda 0: Peak memory 30.37 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  31101 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  31101 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  31101 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   9176 MiB |  33358 MiB | 374708 MiB | 365532 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB |   1200 MiB | 268501 MiB | 268386 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     763    |   56982    |   56974    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     763    |   56982    |   56972    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     143    |     534    |    6188    |    6045    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      55    |   12486    |   12479    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 67.11778235435486
cuda 1: Peak memory 28.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 28.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 29.45 GB ; Persistent memory 0.63 GB
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 16
seq_length = 256
use_prefetch = False
use_offload = False
step time = 27.049826622009277
--------------- finish training step 0
0 43.694018602371216
step time = 19.27000641822815
--------------- finish training step 1
1 30.79262900352478
step time = 24.374187469482422
--------------- finish training step 0
0 35.58989095687866
step time = 24.800549030303955
--------------- finish training step 1
1 37.97225046157837
step time = 20.32073664665222
--------------- finish training step 0
0 34.77702260017395
step time = 17.609750509262085
--------------- finish training step 1
1 29.49260926246643
step time = 20.939465522766113
--------------- finish training step 0
0 33.56026577949524
step time = 17.19692325592041
--------------- finish training step 1
1 28.25576615333557
step time = 20.367698669433594
--------------- finish training step 0
0 31.91747760772705
step time = 17.160558223724365
--------------- finish training step 1
1 32.5305871963501
step time = 20.068541526794434
--------------- finish training step 0
0 31.774425506591797
step time = 21.791718244552612
--------------- finish training step 1
1 35.80201268196106
step time = 15.838516473770142
--------------- finish training step 2
2 27.39191722869873
step time = 16.42905044555664
--------------- finish training step 3
3 29.80325675010681
step time = 21.122693061828613
--------------- finish training step 4
4 32.744518518447876
cuda 2: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.94 GB ; Persistent memory 0.63 GB
cuda 0: Peak memory 28.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2406 MiB |  30882 MiB | 431470 MiB | 429064 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB | 527923 KiB | 222005 MiB | 221892 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     727    |   56982    |   56974    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     727    |   56982    |   56972    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     509    |    7005    |    6952    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      30    |   11169    |   11163    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 59.89192819595337
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 16
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.227017879486084
--------------- finish training step 0
0 42.18975210189819
step time = 19.491089582443237
--------------- finish training step 1
1 30.542152404785156
step time = 29.508213758468628
--------------- finish training step 0
0 42.734596490859985
step time = 18.497111558914185
--------------- finish training step 1
1 32.5809543132782
step time = 20.655642986297607
--------------- finish training step 0
0 36.19173622131348
step time = 15.797523021697998
--------------- finish training step 1
1 27.32437562942505
step time = 22.392425060272217
--------------- finish training step 0
0 37.51507043838501
step time = 18.526506662368774
--------------- finish training step 1
1 32.75428223609924
step time = 21.961159706115723
--------------- finish training step 0
0 35.87841868400574
step time = 18.49121117591858
--------------- finish training step 1
1 33.178465843200684
step time = 22.053614377975464
--------------- finish training step 0
0 36.69628834724426
step time = 18.279988288879395
--------------- finish training step 1
1 32.0934112071991
step time = 18.586288452148438
--------------- finish training step 2
2 31.365899801254272
step time = 16.84202527999878
--------------- finish training step 3
3 29.654837369918823
step time = 17.931909561157227
--------------- finish training step 4
4 32.585519313812256
cuda 1: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29557 MiB |   2114 GiB |   2114 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2438 MiB |  30882 MiB | 431150 MiB | 428712 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB | 560691 KiB | 226213 MiB | 226100 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     727    |   56982    |   56974    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     727    |   56982    |   56972    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      54    |     508    |    6995    |    6941    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      31    |   11300    |   11294    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 66.32644987106323
cuda 2: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.94 GB ; Persistent memory 0.63 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
step time = 25.146032333374023
--------------- finish training step 0
0 43.28234362602234
step time = 21.192001342773438
--------------- finish training step 1
1 31.90857982635498
step time = 27.249192237854004
--------------- finish training step 0
0 37.83181405067444
step time = 21.615169286727905
--------------- finish training step 1
1 32.236462354660034
step time = 20.747480630874634
--------------- finish training step 0
0 33.65434169769287
step time = 17.5174720287323
--------------- finish training step 1
1 28.267674922943115
step time = 19.812023878097534
--------------- finish training step 0
0 31.6739342212677
step time = 19.909836769104004
--------------- finish training step 1
1 30.64352798461914
step time = 20.129931449890137
--------------- finish training step 0
0 31.03837299346924
step time = 16.04446315765381
--------------- finish training step 1
1 26.43052911758423
step time = 20.08592438697815
--------------- finish training step 0
0 31.916905641555786
step time = 16.972585439682007
--------------- finish training step 1
1 27.525750398635864
step time = 15.267690181732178
--------------- finish training step 2
2 26.185086011886597
step time = 16.543282508850098
--------------- finish training step 3
3 28.986568212509155
step time = 16.683443784713745
--------------- finish training step 4
4 27.503971576690674
step time = 15.663592338562012
--------------- finish training step 5
5 26.585177421569824
step time = 16.469441175460815
--------------- finish training step 6
6 28.282795429229736
step time = 16.200764417648315
--------------- finish training step 7
7 27.035097122192383
step time = 15.57137393951416
--------------- finish training step 8
8 26.472902297973633
step time = 16.44220495223999
--------------- finish training step 9
9 28.051733255386353
step time = 15.820201873779297
--------------- finish training step 10
10 26.80675458908081
step time = 15.5740327835083
--------------- finish training step 11
11 26.88369584083557
step time = 16.8721125125885
--------------- finish training step 12
12 28.562216758728027
step time = 15.404361486434937
--------------- finish training step 13
13 26.38503384590149
step time = 15.960562467575073
--------------- finish training step 14
14 27.844472646713257
step time = 16.314215898513794
--------------- finish training step 15
15 27.780320405960083
step time = 15.840570449829102
--------------- finish training step 16
16 26.622817277908325
step time = 16.48290705680847
--------------- finish training step 17
17 27.6911141872406
step time = 15.176461458206177
--------------- finish training step 18
18 26.293286561965942
step time = 15.46396780014038
--------------- finish training step 19
19 26.20882558822632
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 18.22 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  18662 MiB |   2493 GiB |   2492 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  18662 MiB |   2493 GiB |   2492 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  18550 MiB |   2485 GiB |   2485 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3972 MiB |  22716 MiB | 576348 MiB | 572376 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |    891 MiB | 512837 MiB | 512753 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     837    |  111552    |  111544    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     837    |  111552    |  111542    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     160    |     607    |   14045    |   13885    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      67    |   28408    |   28399    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 217.73110437393188
cuda 3: Peak memory 15.84 GB ; Persistent memory 0.62 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 4
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.938403129577637
--------------- finish training step 0
0 52.51999807357788
step time = 21.268100261688232
--------------- finish training step 1
1 34.460684061050415
step time = 25.621923208236694
--------------- finish training step 0
0 38.61789298057556
step time = 19.995041131973267
--------------- finish training step 1
1 37.129595041275024
step time = 27.5752375125885
--------------- finish training step 0
0 43.38350772857666
step time = 20.891202211380005
--------------- finish training step 1
1 34.094053983688354
step time = 26.48049283027649
--------------- finish training step 0
0 40.81252336502075
step time = 21.07417106628418
--------------- finish training step 1
1 34.1119430065155
step time = 25.931562900543213
--------------- finish training step 0
0 39.32612872123718
step time = 22.78311324119568
--------------- finish training step 1
1 36.152831077575684
step time = 25.021387815475464
--------------- finish training step 0
0 38.231703996658325
step time = 21.62196946144104
--------------- finish training step 1
1 34.901323318481445
step time = 20.03987145423889
--------------- finish training step 2
2 33.79084134101868
step time = 20.974567651748657
--------------- finish training step 3
3 33.99245071411133
step time = 21.649434328079224
--------------- finish training step 4
4 34.714465618133545
step time = 21.343345880508423
--------------- finish training step 5
5 34.25431680679321
step time = 20.999277591705322
--------------- finish training step 6
6 34.174330949783325
step time = 20.46228313446045
--------------- finish training step 7
7 34.19364047050476
step time = 20.815157651901245
--------------- finish training step 8
8 34.69285535812378
step time = 21.84015679359436
--------------- finish training step 9
9 34.75803065299988
step time = 21.608272314071655
--------------- finish training step 10
10 34.48829102516174
step time = 20.45387625694275
--------------- finish training step 11
11 33.9389169216156
step time = 20.53373098373413
--------------- finish training step 12
12 34.44935393333435
step time = 20.985400199890137
--------------- finish training step 13
13 34.76583290100098
step time = 22.025158643722534
--------------- finish training step 14
14 35.74138402938843
step time = 21.371885538101196
--------------- finish training step 15
15 34.47209072113037
step time = 20.633394718170166
--------------- finish training step 16
16 34.37279033660889
step time = 21.176437854766846
--------------- finish training step 17
17 35.67105150222778
step time = 22.2133150100708
--------------- finish training step 18
18 36.949697732925415
step time = 20.642823457717896
--------------- finish training step 19
19 34.68995141983032
cuda 1: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 31.88 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  32641 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  32673 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  32673 MiB |   4195 GiB |   4194 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   8294 MiB |  36332 MiB |    869 GiB |    861 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   2627 MiB | 607041 MiB | 606957 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     841    |  112872    |  112864    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     842    |  112872    |  112862    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     156    |     571    |   13581    |   13425    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      93    |   26115    |   26109    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 261.511248588562
cuda 3: Peak memory 27.23 GB ; Persistent memory 0.63 GB
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 4
seq_length = 256
use_prefetch = False
use_offload = False
step time = 26.43144965171814
--------------- finish training step 0
0 53.55592727661133
step time = 21.287219285964966
--------------- finish training step 1
1 34.8113112449646
step time = 24.514381408691406
--------------- finish training step 0
0 38.61256647109985
step time = 21.47314977645874
--------------- finish training step 1
1 37.87743878364563
step time = 26.029325246810913
--------------- finish training step 0
0 38.954819202423096
step time = 20.29571032524109
--------------- finish training step 1
1 35.15260148048401
step time = 20.135717153549194
--------------- finish training step 0
0 33.97597599029541
step time = 18.912532091140747
--------------- finish training step 1
1 32.575217723846436
step time = 21.381678581237793
--------------- finish training step 0
0 36.95758318901062
step time = 18.956507444381714
--------------- finish training step 1
1 32.6524658203125
step time = 21.04870343208313
--------------- finish training step 0
0 36.275928020477295
step time = 18.920535564422607
--------------- finish training step 1
1 32.49630379676819
step time = 16.784577131271362
--------------- finish training step 2
2 32.63601493835449
step time = 16.14885926246643
--------------- finish training step 3
3 29.782106161117554
step time = 16.3356192111969
--------------- finish training step 4
4 29.69321608543396
cuda 2: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.64 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.23 GB ; Persistent memory 0.63 GB
cuda 0: Peak memory 28.13 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28801 MiB |   2098 GiB |   2097 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28833 MiB |   2098 GiB |   2097 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28833 MiB |   2098 GiB |   2097 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2790 MiB |  32492 MiB | 453184 MiB | 450394 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |    899 MiB | 282496 MiB | 282412 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     721    |   56442    |   56434    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     722    |   56442    |   56432    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      53    |     507    |    6985    |    6932    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      38    |   12479    |   12473    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 69.19876050949097
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.11492156982422
--------------- finish training step 0
0 41.23074913024902
step time = 17.545791625976562
--------------- finish training step 1
1 28.427794933319092
step time = 25.1691677570343
--------------- finish training step 0
0 37.164337158203125
step time = 21.688003063201904
--------------- finish training step 1
1 34.68181109428406
step time = 21.83505415916443
--------------- finish training step 0
0 36.233471632003784
step time = 17.534456491470337
--------------- finish training step 1
1 28.7558434009552
step time = 21.624305486679077
--------------- finish training step 0
0 33.383310317993164
step time = 16.82562255859375
--------------- finish training step 1
1 28.33659267425537
step time = 21.250994205474854
--------------- finish training step 0
0 36.504897117614746
step time = 17.06136202812195
--------------- finish training step 1
1 28.051634788513184
step time = 20.600939989089966
--------------- finish training step 0
0 32.23713827133179
step time = 17.688559770584106
--------------- finish training step 1
1 28.82023000717163
step time = 16.08008050918579
--------------- finish training step 2
2 27.498367071151733
step time = 17.253948211669922
--------------- finish training step 3
3 29.75527572631836
step time = 17.592960357666016
--------------- finish training step 4
4 28.68706774711609
step time = 16.35340404510498
--------------- finish training step 5
5 27.802403688430786
step time = 17.255382299423218
--------------- finish training step 6
6 29.69045877456665
step time = 17.654160022735596
--------------- finish training step 7
7 29.702083110809326
step time = 17.04672646522522
--------------- finish training step 8
8 29.009060621261597
step time = 17.497302532196045
--------------- finish training step 9
9 29.62346601486206
step time = 17.769509315490723
--------------- finish training step 10
10 30.53921866416931
step time = 17.444833278656006
--------------- finish training step 11
11 29.891436338424683
step time = 17.80447244644165
--------------- finish training step 12
12 31.040961265563965
step time = 17.33172917366028
--------------- finish training step 13
13 29.600327730178833
step time = 17.730828523635864
--------------- finish training step 14
14 31.421069622039795
step time = 17.856351852416992
--------------- finish training step 15
15 30.094966650009155
step time = 16.795869827270508
--------------- finish training step 16
16 29.01271915435791
step time = 16.868003368377686
--------------- finish training step 17
17 31.30402374267578
step time = 17.613171577453613
--------------- finish training step 18
18 31.51225471496582
step time = 16.881595373153687
--------------- finish training step 19
19 28.98458957672119
cuda 1: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 27.38 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 32.61 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  33397 MiB |   4229 GiB |   4228 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   6756 MiB |  34722 MiB |    839 GiB |    832 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB |   1025 MiB | 464285 MiB | 464171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     847    |  113952    |  113944    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     847    |  113952    |  113942    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     157    |     601    |   13853    |   13696    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      44    |   23055    |   23049    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 237.82862377166748
cuda 3: Peak memory 27.94 GB ; Persistent memory 0.63 GB
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 20.196367502212524
--------------- finish training step 0
0 42.59905672073364
step time = 20.969768047332764
--------------- finish training step 1
1 33.71417164802551
step time = 20.49370312690735
--------------- finish training step 0
0 36.42728543281555
step time = 17.460745573043823
--------------- finish training step 1
1 31.73418927192688
step time = 20.89807415008545
--------------- finish training step 0
0 33.01042151451111
step time = 17.595260858535767
--------------- finish training step 1
1 30.287576913833618
step time = 20.947129011154175
--------------- finish training step 0
0 34.430922508239746
step time = 17.246164083480835
--------------- finish training step 1
1 29.55416226387024
step time = 19.728525638580322
--------------- finish training step 0
0 32.27771306037903
step time = 16.794978380203247
--------------- finish training step 1
1 29.122475147247314
step time = 21.25137233734131
--------------- finish training step 0
0 33.3447539806366
step time = 17.60383415222168
--------------- finish training step 1
1 31.501250505447388
step time = 17.13348078727722
--------------- finish training step 2
2 29.948762893676758
step time = 17.490736722946167
--------------- finish training step 3
3 29.89510726928711
step time = 16.3203341960907
--------------- finish training step 4
4 28.619082927703857
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.37 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29049 MiB |   2103 GiB |   2102 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  31166 MiB | 434910 MiB | 432470 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 628179 KiB | 230933 MiB | 230817 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     717    |   56622    |   56614    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     717    |   56622    |   56612    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     502    |    6866    |    6811    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      36    |   11365    |   11358    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 61.16216158866882
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 23.076653003692627
--------------- finish training step 0
0 44.03910708427429
step time = 19.48665165901184
--------------- finish training step 1
1 32.54848885536194
step time = 23.003965377807617
--------------- finish training step 2
2 38.818320751190186
step time = 19.970686674118042
--------------- finish training step 3
3 32.70018744468689
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
step time = 21.66936755180359
--------------- finish training step 4
4 33.66067719459534
cuda 0: Peak memory 28.37 GB ; Persistent memory 2.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2126 MiB |  29049 MiB | 718363 MiB | 716236 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   2126 MiB |  29049 MiB | 718363 MiB | 716236 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2126 MiB |  29049 MiB | 718362 MiB | 716236 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2408 MiB |  31166 MiB | 146504 MiB | 144096 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 288371 KiB | 595411 KiB |  79457 MiB |  79175 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      77    |     717    |   18876    |   18799    |
|---------------------------------------------------------------------------|
| Active allocs         |      77    |     717    |   18876    |   18799    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     503    |    2307    |    2252    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      35    |    3889    |    3864    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 72.1969804763794
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 22.20892596244812
--------------- finish training step 0
0 42.496312379837036
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18100 MiB |  17950 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     804    |     789    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.814478158950806
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 26.014479637145996
--------------- finish training step 0
0 46.34893321990967
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18100 MiB |  17950 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     819    |     804    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.857239961624146
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.642433166503906
--------------- finish training step 0
0 46.058916330337524
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     789    |     774    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.774266958236694
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 24.019750118255615
--------------- finish training step 0
0 43.91736388206482
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18100 MiB |  17950 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     832    |     817    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.278828382492065
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.81558060646057
--------------- finish training step 0
0 46.55533218383789
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     802    |     787    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 20.257547855377197
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 24.043766021728516
--------------- finish training step 0
0 44.28926873207092
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     774    |     759    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.60579562187195
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
step time = 24.931175708770752
--------------- finish training step 0
0 52.11424779891968
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144367 MiB | 143264 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144367 MiB | 143264 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144367 MiB | 143264 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17172 MiB |  17022 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    4036    |    3991    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    4036    |    3991    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      22    |     834    |     819    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 26.704128980636597
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
step time = 25.030141353607178
--------------- finish training step 0
0 51.45351219177246
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18164 MiB |  18014 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      22    |     821    |     806    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 25.943437337875366
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 24.818331003189087
--------------- finish training step 0
0 49.10601758956909
step time = 22.151919841766357
--------------- finish training step 1
1 42.99006795883179
step time = 22.85456132888794
--------------- finish training step 2
2 44.843443870544434
step time = 22.756914138793945
--------------- finish training step 3
3 45.65315318107605
step time = 22.39003038406372
--------------- finish training step 4
4 45.361539125442505
step time = 26.460660934448242
--------------- finish training step 0
0 49.462886095047
step time = 22.722082138061523
--------------- finish training step 1
1 44.5389609336853
step time = 21.93356418609619
--------------- finish training step 2
2 43.719215631484985
step time = 22.409361124038696
--------------- finish training step 3
3 43.92565107345581
step time = 22.29825234413147
--------------- finish training step 4
4 43.75942373275757
step time = 26.890991687774658
--------------- finish training step 0
0 48.454041957855225
step time = 21.95878314971924
--------------- finish training step 1
1 44.81764459609985
step time = 22.917993783950806
--------------- finish training step 2
2 45.44855809211731
step time = 22.54461669921875
--------------- finish training step 3
3 44.49287700653076
step time = 22.822054147720337
--------------- finish training step 4
4 44.25053787231445
step time = 26.504106998443604
--------------- finish training step 0
0 48.04551434516907
step time = 22.53109097480774
--------------- finish training step 1
1 45.77202844619751
step time = 22.71523690223694
--------------- finish training step 2
2 45.348989963531494
step time = 22.69986581802368
--------------- finish training step 3
3 44.29397177696228
step time = 22.855392932891846
--------------- finish training step 4
4 44.39171552658081
step time = 26.702478647232056
--------------- finish training step 0
0 48.29874324798584
step time = 21.849790334701538
--------------- finish training step 1
1 44.13603615760803
step time = 22.84276795387268
--------------- finish training step 2
2 45.484609603881836
step time = 22.32352375984192
--------------- finish training step 3
3 44.84988451004028
step time = 22.798585414886475
--------------- finish training step 4
4 45.2061243057251
step time = 26.501423835754395
--------------- finish training step 0
0 48.50325655937195
step time = 21.733524799346924
--------------- finish training step 1
1 44.80206608772278
step time = 22.59814453125
--------------- finish training step 2
2 45.425633907318115
step time = 22.26631784439087
--------------- finish training step 3
3 44.288416147232056
step time = 22.509494304656982
--------------- finish training step 4
4 44.754310607910156
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.37 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  29049 MiB |   4208 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  29049 MiB |   4208 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  29049 MiB |   4208 GiB |   4207 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2440 MiB |  31166 MiB |    846 GiB |    843 GiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 628179 KiB | 463692 MiB | 463576 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     717    |  115170    |  115162    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     717    |  115170    |  115160    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     503    |   13613    |   13558    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      37    |   23381    |   23374    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 109.81479406356812
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB

num_iterations = 5
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.677884578704834
--------------- finish training step 0
0 45.99115300178528
step time = 21.20607900619507
--------------- finish training step 1
1 37.648357629776
step time = 20.84646701812744
--------------- finish training step 2
2 39.316866397857666
step time = 21.489476680755615
--------------- finish training step 3
3 39.54245948791504
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
step time = 23.747382879257202
--------------- finish training step 4
4 44.96427249908447
cuda 0: Peak memory 28.37 GB ; Persistent memory 2.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   2126 MiB |  29049 MiB | 718683 MiB | 716556 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   2126 MiB |  29049 MiB | 718683 MiB | 716556 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   2126 MiB |  29049 MiB | 718682 MiB | 716556 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2408 MiB |  31166 MiB | 146504 MiB | 144096 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 288371 KiB | 628179 KiB |  79713 MiB |  79431 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      77    |     717    |   19199    |   19122    |
|---------------------------------------------------------------------------|
| Active allocs         |      77    |     717    |   19199    |   19122    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      55    |     503    |    2307    |    2252    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      36    |    3987    |    3962    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 92.05308604240417
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.516894817352295
--------------- finish training step 0
0 45.5438597202301
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     789    |     774    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.386094570159912
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.902839183807373
--------------- finish training step 0
0 45.571929693222046
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18100 MiB |  17950 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     819    |     804    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.198008060455322
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.824859857559204
--------------- finish training step 0
0 45.903361797332764
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144175 MiB | 143072 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3845    |    3800    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     789    |     774    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.606017589569092
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 21.6985924243927
--------------- finish training step 0
0 41.40665316581726
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144239 MiB | 143136 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  17140 MiB |  16990 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     802    |     787    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.239078044891357
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 22.07028603553772
--------------- finish training step 0
0 42.34257459640503
step time = 18.847958087921143
--------------- finish training step 1
1 35.261475801467896
step time = 19.332622051239014
--------------- finish training step 2
2 37.50518202781677
step time = 19.400277137756348
--------------- finish training step 3
3 36.273885011672974
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 575056 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 575056 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 575055 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 560595 KiB |  63513 MiB |  63266 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15360    |   15291    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15360    |   15291    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      30    |    3144    |    3125    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 69.85991716384888
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.558959484100342
--------------- finish training step 0
0 45.426543951034546
step time = 19.34384775161743
--------------- finish training step 1
1 30.939498901367188
step time = 20.541113138198853
--------------- finish training step 2
2 34.3977165222168
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
step time = 21.33946442604065
--------------- finish training step 3
3 36.051464557647705
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 574799 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 560595 KiB |  64473 MiB |  64225 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      30    |    3106    |    3087    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 58.01637315750122
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.634925603866577
--------------- finish training step 0
0 45.808855295181274
step time = 20.53202247619629
--------------- finish training step 1
1 36.844271659851074
step time = 21.726982355117798
--------------- finish training step 2
2 42.80510902404785
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
step time = 26.410226583480835
--------------- finish training step 3
3 48.15861487388611
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 575056 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 575056 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 575055 MiB | 573185 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 560595 KiB |  64601 MiB |  64354 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15362    |   15293    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15362    |   15293    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      30    |    3180    |    3161    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.4182608127594
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.59434747695923
--------------- finish training step 0
0 45.417482137680054
step time = 18.05684494972229
--------------- finish training step 1
1 34.2738983631134
step time = 20.297203302383423
--------------- finish training step 2
2 38.952558279037476
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
step time = 21.612377882003784
--------------- finish training step 3
3 41.48321294784546
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 574799 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 593363 KiB |  63257 MiB |  63009 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      31    |    3068    |    3049    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 72.6945686340332
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.77044939994812
--------------- finish training step 0
0 46.124486684799194
step time = 23.364187240600586
--------------- finish training step 1
1 40.97119951248169
step time = 21.636067867279053
--------------- finish training step 2
2 40.480974197387695
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
step time = 21.996496200561523
--------------- finish training step 3
3 42.14494562149048
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 574799 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 560595 KiB |  64249 MiB |  64001 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      30    |    3099    |    3080    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 75.06927418708801
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 26.6659996509552
--------------- finish training step 0
0 47.102596282958984
step time = 21.06587028503418
--------------- finish training step 1
1 32.11705160140991
step time = 25.32698678970337
--------------- finish training step 2
2 37.99081301689148
step time = 20.25737190246582
--------------- finish training step 3
3 32.89814281463623
step time = 19.789618968963623
--------------- finish training step 0
0 32.82281422615051
step time = 16.30906581878662
--------------- finish training step 1
1 29.74988341331482
step time = 15.183928489685059
--------------- finish training step 2
2 28.480507373809814
step time = 17.441636085510254
--------------- finish training step 3
3 33.64323449134827
step time = 20.589337587356567
--------------- finish training step 0
0 47.37596297264099
step time = 16.495237588882446
--------------- finish training step 1
1 30.547724723815918
step time = 16.53521752357483
--------------- finish training step 2
2 28.261720657348633
step time = 15.822511434555054
--------------- finish training step 3
3 28.01180124282837
step time = 20.01215362548828
--------------- finish training step 0
0 32.32211470603943
step time = 16.244208574295044
--------------- finish training step 1
1 27.56983256340027
step time = 16.992037534713745
--------------- finish training step 2
2 29.48607873916626
step time = 15.016815185546875
--------------- finish training step 3
3 26.998143196105957
step time = 19.918048858642578
--------------- finish training step 0
0 32.77337598800659
step time = 16.627604722976685
--------------- finish training step 1
1 27.95266842842102
step time = 15.643460273742676
--------------- finish training step 2
2 27.601165294647217
step time = 15.985239028930664
--------------- finish training step 3
3 27.471944570541382
step time = 20.025800466537476
--------------- finish training step 0
0 31.783376455307007
step time = 16.348820447921753
--------------- finish training step 1
1 27.718099355697632
step time = 15.892125129699707
--------------- finish training step 2
2 28.032780647277832
step time = 15.748986721038818
--------------- finish training step 3
3 27.48516297340393
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   3365 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   3365 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   3365 GiB |   3364 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2150 MiB |  30910 MiB | 693718 MiB | 691568 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 626131 KiB | 370770 MiB | 370654 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   90588    |   90580    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   90588    |   90578    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |   10916    |   10869    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      32    |   18223    |   18216    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 45.12817168235779
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.509679794311523
--------------- finish training step 0
0 45.47839570045471
step time = 18.888004541397095
--------------- finish training step 1
1 31.822380304336548
step time = 21.687952041625977
--------------- finish training step 2
2 35.428056716918945
step time = 22.206979036331177
--------------- finish training step 3
3 35.63217544555664
cuda 0: Peak memory 28.12 GB ; Persistent memory 1.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1870 MiB |  28793 MiB | 574800 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1870 MiB |  28793 MiB | 574799 MiB | 572929 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2118 MiB |  30910 MiB | 117456 MiB | 115338 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 253555 KiB | 560595 KiB |  63737 MiB |  63489 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| Active allocs         |      69    |     709    |   15102    |   15033    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     497    |    1851    |    1804    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      19    |      30    |    3083    |    3064    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 58.200783252716064
cuda 3: Peak memory 27.36 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.34 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.34 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.000556468963623
--------------- finish training step 0
0 45.130685806274414
step time = 20.52317214012146
--------------- finish training step 1
1 34.00679278373718
step time = 25.171542167663574
--------------- finish training step 0
0 38.56736350059509
step time = 21.979371786117554
--------------- finish training step 1
1 35.93333101272583
step time = 24.824013233184814
--------------- finish training step 0
0 40.86704182624817
step time = 19.750038146972656
--------------- finish training step 1
1 33.55531167984009
step time = 24.772308826446533
--------------- finish training step 0
0 39.22772765159607
step time = 19.8729190826416
--------------- finish training step 1
1 33.47293996810913
step time = 24.646130561828613
--------------- finish training step 0
0 39.165844678878784
step time = 19.94866442680359
--------------- finish training step 1
1 34.05197477340698
step time = 24.729700088500977
--------------- finish training step 0
0 38.508570432662964
step time = 20.155540466308594
--------------- finish training step 1
1 34.09629249572754
step time = 20.156242847442627
--------------- finish training step 2
2 33.67304277420044
step time = 19.775811433792114
--------------- finish training step 3
3 32.985068559646606
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2150 MiB |  30910 MiB | 405894 MiB | 403744 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 593363 KiB | 219582 MiB | 219466 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     496    |    6411    |    6364    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      31    |   10699    |   10692    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 52.568012952804565
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
cuda 3: Peak memory 27.31 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
step time = 25.497722625732422
--------------- finish training step 0
0 45.77967715263367
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 144111 MiB | 143008 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1252 MiB |  30118 MiB |  30118 MiB |  28866 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 153203 KiB | 460243 KiB |  18100 MiB |  17950 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3780    |    3735    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     476    |     476    |     451    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      23    |     804    |     789    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 19.802147150039673
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.840646743774414
--------------- finish training step 0
0 45.72500777244568
step time = 19.14886236190796
--------------- finish training step 1
1 30.541751384735107
step time = 26.416348934173584
--------------- finish training step 0
0 40.96262764930725
step time = 16.50948143005371
--------------- finish training step 1
1 28.935142517089844
step time = 21.99159049987793
--------------- finish training step 0
0 39.78458523750305
step time = 18.664739847183228
--------------- finish training step 1
1 32.38168716430664
step time = 22.63512635231018
--------------- finish training step 0
0 37.96655797958374
step time = 18.06339192390442
--------------- finish training step 1
1 31.61044692993164
step time = 21.30125617980957
--------------- finish training step 0
0 34.498213052749634
step time = 17.09536075592041
--------------- finish training step 1
1 32.37085199356079
step time = 22.00920295715332
--------------- finish training step 0
0 37.04337430000305
step time = 17.974329710006714
--------------- finish training step 1
1 32.06081795692444
step time = 16.836089611053467
--------------- finish training step 2
2 30.532094717025757
step time = 17.827524185180664
--------------- finish training step 3
3 32.72159171104431
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2150 MiB |  30910 MiB | 405894 MiB | 403744 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 626131 KiB | 213758 MiB | 213642 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     496    |    6410    |    6363    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      32    |   10517    |   10510    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 55.817994356155396
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 21.14456605911255
--------------- finish training step 0
0 41.353466510772705
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.708794355392456
--------------- finish training step 0
0 46.13921236991882
step time = 23.06212615966797
--------------- finish training step 1
1 34.36331582069397
step time = 26.27800416946411
--------------- finish training step 0
0 37.40094780921936
step time = 21.429603099822998
--------------- finish training step 1
1 36.05703401565552
step time = 25.4205002784729
--------------- finish training step 0
0 38.74349021911621
step time = 20.197859287261963
--------------- finish training step 1
1 32.16972780227661
step time = 25.498732328414917
--------------- finish training step 0
0 39.28402876853943
step time = 20.396974325180054
--------------- finish training step 1
1 32.72430443763733
step time = 25.443791389465332
--------------- finish training step 0
0 39.441683769226074
step time = 21.218032598495483
--------------- finish training step 1
1 33.45236110687256
step time = 25.57362389564514
--------------- finish training step 0
0 37.95858836174011
step time = 22.275996208190918
--------------- finish training step 1
1 33.71757626533508
step time = 20.876844882965088
--------------- finish training step 2
2 33.20999813079834
step time = 20.604323387145996
--------------- finish training step 3
3 32.54801058769226
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2150 MiB |  30910 MiB | 405894 MiB | 403744 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 626131 KiB | 216830 MiB | 216714 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     496    |    6411    |    6364    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      32    |   10613    |   10606    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 46.20684194564819
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 21.32741403579712
--------------- finish training step 0
0 40.924318075180054
step time = 14.89588475227356
--------------- finish training step 1
1 26.835703134536743
step time = 19.147480964660645
--------------- finish training step 0
0 33.76503562927246
step time = 15.58085298538208
--------------- finish training step 1
1 27.571861505508423
step time = 19.36870789527893
--------------- finish training step 0
0 31.768479585647583
step time = 16.170382261276245
--------------- finish training step 1
1 28.631145000457764
step time = 20.279056072235107
--------------- finish training step 0
0 32.122081995010376
step time = 16.692808866500854
--------------- finish training step 1
1 27.858866453170776
step time = 20.465062141418457
--------------- finish training step 0
0 32.797971963882446
step time = 16.85092258453369
--------------- finish training step 1
1 28.861352920532227
step time = 20.12258768081665
--------------- finish training step 0
0 32.36893820762634
step time = 16.927197217941284
--------------- finish training step 1
1 28.33895707130432
step time = 16.049678802490234
--------------- finish training step 2
2 28.19574236869812
step time = 16.7147536277771
--------------- finish training step 3
3 29.509419202804565
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2182 MiB |  30910 MiB | 405926 MiB | 403744 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 626131 KiB | 217392 MiB | 217276 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     496    |    6413    |    6366    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      32    |   10633    |   10626    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 46.725892782211304
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
step time = 25.563685417175293
--------------- finish training step 0
0 45.44300675392151
step time = 19.935808658599854
--------------- finish training step 1
1 31.045569896697998
step time = 28.652809619903564
--------------- finish training step 0
0 41.360633850097656
step time = 21.12096858024597
--------------- finish training step 1
1 32.72733116149902
step time = 27.85365867614746
--------------- finish training step 0
0 42.527275800704956
step time = 23.85033369064331
--------------- finish training step 1
1 34.87300753593445
step time = 23.77638840675354
--------------- finish training step 0
0 35.53792977333069
step time = 21.666356801986694
--------------- finish training step 1
1 33.86362552642822
step time = 24.8244149684906
--------------- finish training step 0
0 36.55526113510132
step time = 21.855400323867798
--------------- finish training step 1
1 34.08292555809021
step time = 24.26389789581299
--------------- finish training step 0
0 35.92641735076904
step time = 20.177842617034912
--------------- finish training step 1
1 31.79353928565979
step time = 20.402581453323364
--------------- finish training step 2
2 31.94102931022644
step time = 19.512007474899292
--------------- finish training step 3
3 31.339762210845947
cuda 3: Peak memory 27.44 GB ; Persistent memory 0.63 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 28.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28793 MiB |   1963 GiB |   1962 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2150 MiB |  30910 MiB | 405894 MiB | 403744 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118519 KiB | 626131 KiB | 215614 MiB | 215498 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     709    |   52848    |   52840    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     709    |   52848    |   52838    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      47    |     496    |    6411    |    6364    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      32    |   10575    |   10568    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 44.75517535209656
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 256
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
seq_length = 128
use_prefetch = False
use_offload = False

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
step time = 24.928057432174683
--------------- finish training step 0
0 79.11831760406494
step time = 19.286006212234497
--------------- finish training step 1
1 142.35634469985962
step time = 19.57509183883667
--------------- finish training step 2
2 208.2784321308136
step time = 19.8622624874115
--------------- finish training step 3
3 271.9808986186981
step time = 19.67688226699829
--------------- finish training step 4
4 334.24504375457764
step time = 19.928452491760254
--------------- finish training step 5
5 397.3928873538971
step time = 19.131690740585327
--------------- finish training step 6
6 460.2358956336975
step time = 19.02152967453003
--------------- finish training step 7
7 521.4894330501556
step time = 18.664573192596436
--------------- finish training step 8
8 584.7261090278625
step time = 18.762223958969116
--------------- finish training step 9
9 643.0578329563141
step time = 18.745667219161987
--------------- finish training step 10
10 700.997926235199
step time = 18.89520764350891
--------------- finish training step 11
11 759.7172501087189
step time = 18.880204439163208
--------------- finish training step 12
12 818.4149203300476
step time = 18.64653205871582
--------------- finish training step 13
13 876.4911947250366
step time = 18.97354221343994
--------------- finish training step 14
14 934.5290515422821
step time = 18.847499132156372
--------------- finish training step 15
15 993.1822464466095
step time = 18.904474020004272
--------------- finish training step 16
16 1052.303362607956
step time = 19.011760473251343
--------------- finish training step 17
17 1111.445915222168
step time = 19.197897911071777
--------------- finish training step 18
18 1170.984941482544
step time = 18.889930963516235
--------------- finish training step 19
19 1230.0269150733948
cuda 0: Peak memory 18.12 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18446 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  19736 MiB | 386172 MiB | 382026 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1080 MiB | 465018 MiB | 464247 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     577    |   10123    |    9984    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      79    |   28984    |   28928    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1230.0272607803345
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.60 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
step time = 25.90153956413269
--------------- finish training step 0
0 78.37031483650208
step time = 22.98365807533264
--------------- finish training step 1
1 145.0949091911316
step time = 22.41877055168152
--------------- finish training step 2
2 210.82700061798096
step time = 24.571685314178467
--------------- finish training step 3
3 278.3627333641052
step time = 25.062692880630493
--------------- finish training step 4
4 345.592787027359
step time = 20.63494372367859
--------------- finish training step 5
5 406.6189229488373
step time = 19.046321630477905
--------------- finish training step 6
6 466.8462121486664
step time = 18.720327615737915
--------------- finish training step 7
7 524.8965480327606
step time = 18.960514545440674
--------------- finish training step 8
8 584.0878398418427
step time = 18.74118185043335
--------------- finish training step 9
9 643.186461687088
step time = 19.027588605880737
--------------- finish training step 10
10 701.9955327510834
step time = 19.20953917503357
--------------- finish training step 11
11 761.825790643692
step time = 18.96905755996704
--------------- finish training step 12
12 821.3516404628754
step time = 18.769493103027344
--------------- finish training step 13
13 880.0280108451843
step time = 19.1824631690979
--------------- finish training step 14
14 938.7434194087982
step time = 19.919534921646118
--------------- finish training step 15
15 999.111090183258
step time = 18.81316304206848
--------------- finish training step 16
16 1058.7086226940155
step time = 18.83401107788086
--------------- finish training step 17
17 1116.9364326000214
step time = 18.93609356880188
--------------- finish training step 18
18 1175.7321465015411
step time = 19.052132844924927
--------------- finish training step 19
19 1234.860315322876
cuda 0: Peak memory 18.12 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18446 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  19736 MiB | 386172 MiB | 382026 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1080 MiB | 465178 MiB | 464407 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     577    |   10123    |    9984    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      79    |   28995    |   28939    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1234.8606696128845
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.60 GB ; Persistent memory 0.80 GB
num_iterations = 2
batch_size = 64
num_layers = 32
num_stages = 8
step time = 18.541093111038208
--------------- finish training step 0
0 67.34739232063293
step time = 17.944698095321655
--------------- finish training step 1
1 126.97931909561157
step time = 21.71913719177246
--------------- finish training step 0
0 69.23759007453918
step time = 18.186768531799316
--------------- finish training step 1
1 125.99437403678894
step time = 21.571561813354492
--------------- finish training step 0
0 68.69460248947144
step time = 18.074858903884888
--------------- finish training step 1
1 125.4704008102417
step time = 21.543142795562744
--------------- finish training step 0
0 68.70253801345825
step time = 18.306746244430542
--------------- finish training step 1
1 125.5009925365448
step time = 21.451618671417236
--------------- finish training step 0
0 69.33068633079529
step time = 18.293526887893677
--------------- finish training step 1
1 125.4304666519165
cuda 0: Peak memory 15.94 GB ; Persistent memory 0.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    847 MiB |  16320 MiB |    785 GiB |    785 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    879 MiB |  16320 MiB |    785 GiB |    785 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    879 MiB |  16207 MiB |    783 GiB |    782 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1490 MiB |  17704 MiB | 197460 MiB | 195970 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 246519 KiB | 653475 KiB | 200635 MiB | 200394 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      16    |     654    |   36479    |   36463    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |     654    |   36479    |   36461    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     505    |    5292    |    5252    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      67    |   12840    |   12823    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 125.43085932731628
cuda 3: Peak memory 14.66 GB ; Persistent memory 0.83 GB
cuda 1: Peak memory 14.19 GB ; Persistent memory 0.58 GB
cuda 2: Peak memory 14.16 GB ; Persistent memory 0.58 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
step time = 21.540113925933838
--------------- finish training step 0
0 65.67824625968933
step time = 18.18490481376648
--------------- finish training step 1
1 122.57358837127686
step time = 18.295294046401978
--------------- finish training step 2
2 177.60017466545105
step time = 18.402039527893066
--------------- finish training step 3
3 234.36029624938965
step time = 18.421406030654907
--------------- finish training step 4
4 291.09335708618164
step time = 18.259023666381836
--------------- finish training step 5
5 347.70767998695374
step time = 18.16101312637329
--------------- finish training step 6
6 402.44095849990845
step time = 18.14121961593628
--------------- finish training step 7
7 457.23176193237305
step time = 18.181779146194458
--------------- finish training step 8
8 512.1224801540375
step time = 18.266737937927246
--------------- finish training step 9
9 566.9247884750366
step time = 18.35845971107483
--------------- finish training step 10
10 621.677984714508
step time = 18.52144742012024
--------------- finish training step 11
11 677.0773513317108
step time = 18.231659412384033
--------------- finish training step 12
12 732.1824066638947
step time = 18.493831634521484
--------------- finish training step 13
13 787.3429956436157
step time = 18.299520015716553
--------------- finish training step 14
14 843.0088179111481
step time = 18.4469575881958
--------------- finish training step 15
15 898.3439617156982
step time = 18.40729284286499
--------------- finish training step 16
16 953.7636070251465
step time = 18.8428738117218
--------------- finish training step 17
17 1009.7626106739044
step time = 18.442187547683716
--------------- finish training step 18
18 1064.8602604866028
cuda 1: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 18.476980686187744
--------------- finish training step 19
19 1119.9125216007233
cuda 0: Peak memory 16.83 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17115 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17936 MiB | 421972 MiB | 417970 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    899 MiB | 445963 MiB | 445335 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     551    |   10982    |   10857    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   32233    |   32188    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1119.9128761291504
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.06 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
step time = 20.156001091003418
--------------- finish training step 0
0 63.82406139373779
step time = 18.399998903274536
--------------- finish training step 1
1 119.92310905456543
step time = 18.680777072906494
--------------- finish training step 2
2 173.9935884475708
step time = 18.20179772377014
--------------- finish training step 3
3 228.12591171264648
step time = 18.274394035339355
--------------- finish training step 4
4 283.3370180130005
step time = 18.308457136154175
--------------- finish training step 5
5 338.1918225288391
step time = 18.337685108184814
--------------- finish training step 6
6 392.97134804725647
step time = 18.332424640655518
--------------- finish training step 7
7 448.25250029563904
step time = 18.228739023208618
--------------- finish training step 8
8 502.90189576148987
step time = 18.445693016052246
--------------- finish training step 9
9 557.9215595722198
step time = 18.14653968811035
--------------- finish training step 10
10 612.800831079483
step time = 18.458452463150024
--------------- finish training step 11
11 667.7998797893524
step time = 18.709280490875244
--------------- finish training step 12
12 723.1783030033112
step time = 18.728237628936768
--------------- finish training step 13
13 778.7232713699341
step time = 18.53780436515808
--------------- finish training step 14
14 833.9750895500183
step time = 18.502660274505615
--------------- finish training step 15
15 889.4798667430878
step time = 18.818562746047974
--------------- finish training step 16
16 944.8733298778534
step time = 18.517691612243652
--------------- finish training step 17
17 1000.3867478370667
step time = 18.554454803466797
--------------- finish training step 18
18 1055.217604637146
cuda 1: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 18.227718830108643
--------------- finish training step 19
19 1110.314412355423
cuda 0: Peak memory 16.83 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17115 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   3970 MiB |  17936 MiB | 421860 MiB | 417890 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 609971 KiB |    883 MiB | 446579 MiB | 445983 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     124    |     551    |   10976    |   10852    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      43    |      57    |   32264    |   32221    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1110.3147609233856
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.03 GB ; Persistent memory 0.80 GB
num_iterations = 2
batch_size = 64
num_layers = 32
num_stages = 16
step time = 21.968944311141968
--------------- finish training step 0
0 65.38410067558289
step time = 18.261167764663696
--------------- finish training step 1
1 120.17952108383179
step time = 21.657843351364136
--------------- finish training step 0
0 63.909637689590454
step time = 18.560487508773804
--------------- finish training step 1
1 117.99552178382874
step time = 21.717131853103638
--------------- finish training step 0
0 64.044588804245
step time = 18.752151489257812
--------------- finish training step 1
1 119.13620281219482
step time = 22.127622365951538
--------------- finish training step 0
0 64.6835069656372
step time = 18.674216985702515
--------------- finish training step 1
1 119.10269403457642
step time = 22.23920965194702
--------------- finish training step 0
0 64.84710717201233
step time = 18.665340423583984
--------------- finish training step 1
1 119.36299419403076
cuda 2: Peak memory 13.61 GB ; Persistent memory 0.58 GB
cuda 0: Peak memory 14.65 GB ; Persistent memory 0.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    847 MiB |  14997 MiB |    797 GiB |    796 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    879 MiB |  14997 MiB |    797 GiB |    796 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    879 MiB |  14876 MiB |    794 GiB |    793 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1474 MiB |  15904 MiB | 215188 MiB | 213714 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 262903 KiB | 644931 KiB | 202131 MiB | 201875 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      16    |     651    |   36899    |   36883    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |     651    |   36899    |   36881    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      40    |     489    |    5717    |    5677    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      69    |   15081    |   15063    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 119.36340618133545
cuda 1: Peak memory 13.61 GB ; Persistent memory 0.58 GB
cuda 3: Peak memory 14.06 GB ; Persistent memory 0.83 GB


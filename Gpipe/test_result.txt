num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 24.863731622695923
--------------- finish training step 0
0 68.13934707641602
step time = 22.984668731689453
--------------- finish training step 1
1 127.74417638778687
step time = 23.3493914604187
--------------- finish training step 2
2 189.0952832698822
step time = 20.478872299194336
--------------- finish training step 3
3 247.50443530082703
step time = 22.141541719436646
--------------- finish training step 4
4 306.92074847221375
step time = 22.200820207595825
--------------- finish training step 5
5 367.12718391418457
step time = 21.93042016029358
--------------- finish training step 6
6 426.7416923046112
step time = 21.84267282485962
--------------- finish training step 7
7 485.8287544250488
step time = 21.76569414138794
--------------- finish training step 8
8 545.2184550762177
step time = 21.302610635757446
--------------- finish training step 9
9 604.3844294548035
step time = 21.575194120407104
--------------- finish training step 10
10 663.5071449279785
step time = 21.432095050811768
--------------- finish training step 11
11 722.6437270641327
step time = 21.601568460464478
--------------- finish training step 12
12 781.7751159667969
step time = 21.758974313735962
--------------- finish training step 13
13 840.9825239181519
step time = 21.835991144180298
--------------- finish training step 14
14 900.3887033462524
step time = 22.09350562095642
--------------- finish training step 15
15 960.6304540634155
step time = 21.860145807266235
--------------- finish training step 16
16 1020.4389970302582
step time = 21.85204768180847
--------------- finish training step 17
17 1079.9416317939758
step time = 21.835456609725952
--------------- finish training step 18
18 1139.7707901000977
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 21.800004720687866
--------------- finish training step 19
19 1199.3761060237885
cuda 0: Peak memory 16.83 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17115 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17936 MiB | 421928 MiB | 417926 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    883 MiB | 446635 MiB | 446007 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     551    |   10980    |   10855    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   32272    |   32227    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1199.3764629364014
cuda 3: Peak memory 14.03 GB ; Persistent memory 0.80 GB


num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 19.516377925872803
--------------- finish training step 0
0 74.55824685096741
step time = 18.18209719657898
--------------- finish training step 1
1 136.20972180366516
step time = 18.6065993309021
--------------- finish training step 2
2 197.38808250427246
step time = 18.393953561782837
--------------- finish training step 3
3 258.9843258857727
step time = 18.51820158958435
--------------- finish training step 4
4 321.4902503490448
step time = 18.11265277862549
--------------- finish training step 5
5 382.9077935218811
step time = 18.495360374450684
--------------- finish training step 6
6 445.37020564079285
step time = 18.18320941925049
--------------- finish training step 7
7 507.059814453125
step time = 18.57143497467041
--------------- finish training step 8
8 569.9550542831421
step time = 18.128587245941162
--------------- finish training step 9
9 631.4895629882812
step time = 18.530179977416992
--------------- finish training step 10
10 694.1871271133423
step time = 18.247605562210083
--------------- finish training step 11
11 755.5223579406738
step time = 18.835952758789062
--------------- finish training step 12
12 818.6063349246979
step time = 26.69263243675232
--------------- finish training step 13
13 917.8313257694244
step time = 20.298486709594727
--------------- finish training step 14
14 987.9715349674225
step time = 20.068352699279785
--------------- finish training step 15
15 1057.7963345050812
step time = 19.626797437667847
--------------- finish training step 16
16 1125.567174911499
step time = 19.03800654411316
--------------- finish training step 17
17 1191.9485189914703
step time = 19.536311864852905
--------------- finish training step 18
18 1258.977870941162
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 18.995842456817627
--------------- finish training step 19
19 1324.6733400821686
cuda 0: Peak memory 16.17 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17250 MiB | 413812 MiB | 409810 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    911 MiB | 423331 MiB | 422703 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     538    |   10846    |   10721    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   31209    |   31164    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1324.6737008094788
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 21.08063578605652
--------------- finish training step 0
0 80.2094738483429

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
offload_parallel=True
step time = 18.675775051116943
--------------- finish training step 0
0 44.61975407600403
step time = 15.529860496520996
--------------- finish training step 1
1 75.8632128238678
step time = 15.419750690460205
--------------- finish training step 2
2 107.04262399673462
step time = 15.288419246673584
--------------- finish training step 3
3 139.95732259750366
step time = 15.914733648300171
--------------- finish training step 4
4 172.97492575645447
step time = 17.275418281555176
--------------- finish training step 5
5 207.7070460319519
step time = 17.698665618896484
--------------- finish training step 6
6 242.28898644447327
step time = 17.438642501831055
--------------- finish training step 7
7 276.8655014038086
step time = 17.946666955947876
--------------- finish training step 8
8 313.2763681411743
step time = 18.066956281661987
--------------- finish training step 9
9 350.1675250530243
step time = 18.13210892677307
--------------- finish training step 10
10 385.66743659973145
step time = 17.614225149154663
--------------- finish training step 11
11 421.86288189888
step time = 17.73995804786682
--------------- finish training step 12
12 458.10243248939514
step time = 18.13353419303894
--------------- finish training step 13
13 493.3263623714447
step time = 18.168978691101074
--------------- finish training step 14
14 529.0224533081055
step time = 17.87777614593506
--------------- finish training step 15
15 565.2812049388885
step time = 17.624396800994873
--------------- finish training step 16
16 601.3664436340332
step time = 18.127846002578735
--------------- finish training step 17
17 637.271810054779
step time = 17.180988073349
--------------- finish training step 18
18 672.2906241416931
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
step time = 16.932090520858765
--------------- finish training step 19
19 706.4169690608978
cuda 0: Peak memory 16.74 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17030 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  19826 MiB | 384664 MiB | 380662 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    858 MiB | 295201 MiB | 294574 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     152    |     596    |   10166    |   10014    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |      66    |   22142    |   22095    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 706.4170227050781
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
step time = 24.710232973098755
--------------- finish training step 0
0 72.15781331062317
step time = 21.885071516036987
--------------- finish training step 1
1 133.18341493606567
step time = 25.32851767539978
--------------- finish training step 2
2 198.25091886520386
step time = 19.593878030776978
--------------- finish training step 3
3 258.63245677948
step time = 20.684062004089355
--------------- finish training step 4
4 321.7777247428894
step time = 20.418142080307007
--------------- finish training step 5
5 384.8710401058197
step time = 20.510064363479614
--------------- finish training step 6
6 447.6583638191223
step time = 20.512695789337158
--------------- finish training step 7
7 511.39996433258057
step time = 20.515226125717163
--------------- finish training step 8
8 575.8372778892517
step time = 20.16586709022522
--------------- finish training step 9
9 640.1412084102631
step time = 18.05255675315857
--------------- finish training step 10
10 700.7620093822479
step time = 17.180485486984253
--------------- finish training step 11
11 760.8219766616821
step time = 18.646287441253662
--------------- finish training step 12
12 821.7458672523499
step time = 18.600390672683716
--------------- finish training step 13
13 879.9301719665527
step time = 18.57701587677002
--------------- finish training step 14
14 938.7449312210083
step time = 18.697574615478516
--------------- finish training step 15
15 996.8560156822205
step time = 18.753479480743408
--------------- finish training step 16
16 1055.2936544418335
step time = 18.72821307182312
--------------- finish training step 17
17 1113.650264263153
step time = 18.480738162994385
--------------- finish training step 18
18 1172.1280798912048
step time = 18.248053312301636
--------------- finish training step 19
19 1229.496661901474
cuda 0: Peak memory 18.12 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18446 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  19736 MiB | 386172 MiB | 382026 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1080 MiB | 465214 MiB | 464443 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     577    |   10123    |    9984    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      79    |   28996    |   28940    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1229.4967288970947
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 23.53296160697937
--------------- finish training step 0
0 77.49955940246582
step time = 22.23126745223999
--------------- finish training step 1
1 141.22230553627014
step time = 22.730512857437134
--------------- finish training step 2
2 211.95583510398865
step time = 22.882915496826172
--------------- finish training step 3
3 280.39039158821106
step time = 19.194226026535034
--------------- finish training step 4
4 343.44962310791016
step time = 19.652443885803223
--------------- finish training step 5
5 407.216609954834
step time = 19.73197841644287
--------------- finish training step 6
6 471.59037494659424
step time = 19.678691387176514
--------------- finish training step 7
7 535.4801247119904
step time = 19.58760929107666
--------------- finish training step 8
8 599.254998922348
step time = 19.283612728118896
--------------- finish training step 9
9 662.7395868301392
step time = 20.258301973342896
--------------- finish training step 10
10 729.4503121376038
step time = 20.3509521484375
--------------- finish training step 11
11 795.1337962150574
step time = 20.559025287628174
--------------- finish training step 12
12 860.7982959747314
step time = 20.42425012588501
--------------- finish training step 13
13 925.2704739570618
step time = 20.448516845703125
--------------- finish training step 14
14 990.6466081142426
step time = 20.447324752807617
--------------- finish training step 15
15 1055.71058011055
step time = 20.395715951919556
--------------- finish training step 16
16 1121.2480461597443
step time = 20.650866508483887
--------------- finish training step 17
17 1187.3548674583435
step time = 20.26167941093445
--------------- finish training step 18
18 1252.5649244785309
step time = 20.615692615509033
--------------- finish training step 19
19 1318.4851989746094
cuda 0: Peak memory 16.71 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  18278 MiB | 383572 MiB | 379426 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1104 MiB | 453226 MiB | 452455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     550    |   10081    |    9942    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      78    |   28395    |   28339    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1318.4852530956268
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB

num_iterations = 20
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
num_stages = 8
use_prefetch = True
step time = 21.424659967422485
step time = 21.424659967422485
--------------- finish training step 0
0 54.08203434944153
step time = 18.320717573165894
0 54.08203434944153
step time = 18.320717573165894
--------------- finish training step 1
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
--------------- finish training step 0
0 56.61219573020935
step time = 16.060291051864624
0 56.61219573020935
step time = 16.060291051864624
--------------- finish training step 1
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
--------------- finish training step 0
0 48.25616478919983
step time = 16.869024515151978
0 48.25616478919983
step time = 16.869024515151978
--------------- finish training step 1
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     805    |   73550    |   73353    |
| Allocations           |     197    |     805    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     805    |   73550    |   73352    |
| Active allocs         |     198    |     805    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     507    |     507    |     507    |       0    |
| GPU reserved segments |     507    |     507    |     507    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 22.406066179275513
use_prefetch = False
step time = 22.406066179275513
--------------- finish training step 0
0 65.700026512146
step time = 18.978885173797607
0 65.700026512146
step time = 18.978885173797607
--------------- finish training step 1
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations=3
use_prefetch=True
batch_size=64
step time = 20.160987377166748
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations=3
use_prefetch=True
batch_size=64
step time = 20.160987377166748
--------------- finish training step 0
0 51.81324791908264
step time = 16.60845947265625
0 51.81324791908264
step time = 16.60845947265625
--------------- finish training step 1
1 36.15450620651245
step time = 17.031460762023926
--------------- finish training step 2
2 37.423696994781494
step time = 19.782208919525146
1 36.15450620651245
step time = 17.031460762023926
--------------- finish training step 2
2 37.423696994781494
step time = 19.782208919525146
--------------- finish training step 0
0 50.99935221672058
step time = 16.861259937286377
0 50.99935221672058
step time = 16.861259937286377
--------------- finish training step 1
1 37.710001945495605
step time = 16.902612447738647
--------------- finish training step 2
2 38.06140947341919
step time = 19.98851776123047
1 37.710001945495605
step time = 16.902612447738647
--------------- finish training step 2
2 38.06140947341919
step time = 19.98851776123047
--------------- finish training step 0
0 53.89370679855347
step time = 16.8837993144989
0 53.89370679855347
step time = 16.8837993144989
--------------- finish training step 1
1 37.336872816085815
step time = 16.976738691329956
--------------- finish training step 2
2 38.203232765197754
step time = 20.605685710906982
1 37.336872816085815
step time = 16.976738691329956
--------------- finish training step 2
2 38.203232765197754
step time = 20.605685710906982
--------------- finish training step 0
0 53.20567536354065
step time = 16.927310943603516
0 53.20567536354065
step time = 16.927310943603516
--------------- finish training step 1
1 37.870715856552124
step time = 16.14418649673462
--------------- finish training step 2
2 39.67826175689697
step time = 19.608344316482544
--------------- finish training step 0
0 54.148728132247925
step time = 17.028959274291992
--------------- finish training step 1
1 38.74731373786926
step time = 16.81213092803955
--------------- finish training step 2
2 39.24374961853027
step time = 19.75131607055664
--------------- finish training step 0
0 51.530622243881226
step time = 16.89538884162903
--------------- finish training step 1
1 37.37753224372864
step time = 16.99202537536621
--------------- finish training step 2
2 38.35167670249939
cuda 3: Peak memory 14.77 GB ; Persistent memory 0.84 GB
cuda 0: Peak memory 14.87 GB ; Persistent memory 0.84 GB
1 37.870715856552124
step time = 16.14418649673462
--------------- finish training step 2
2 39.67826175689697
step time = 19.608344316482544
--------------- finish training step 0
0 54.148728132247925
step time = 17.028959274291992
--------------- finish training step 1
1 38.74731373786926
step time = 16.81213092803955
--------------- finish training step 2
2 39.24374961853027
step time = 19.75131607055664
--------------- finish training step 0
0 51.530622243881226
step time = 16.89538884162903
--------------- finish training step 1
1 37.37753224372864
step time = 16.99202537536621
--------------- finish training step 2
2 38.35167670249939
cuda 3: Peak memory 14.77 GB ; Persistent memory 0.84 GB
cuda 0: Peak memory 14.87 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  15231 MiB |   1434 GiB |   1433 GiB |
| Allocated memory      |    863 MiB |  15231 MiB |   1434 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  15231 MiB |   1434 GiB |   1433 GiB |
| Active memory         |    895 MiB |  15231 MiB |   1434 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  15115 MiB |   1429 GiB |   1429 GiB |
| Requested memory      |    895 MiB |  15115 MiB |   1429 GiB |   1429 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  31890 MiB |  39692 MiB |  94610 MiB |  62720 MiB |
| GPU reserved memory   |  31890 MiB |  39692 MiB |  94610 MiB |  62720 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 295415 KiB |    882 MiB | 268794 MiB | 268505 MiB |
| Non-releasable memory | 295415 KiB |    882 MiB | 268794 MiB | 268505 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     679    |   66334    |   66316    |
| Allocations           |      18    |     679    |   66334    |   66316    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     679    |   66334    |   66314    |
| Active allocs         |      20    |     679    |   66334    |   66314    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     956    |    1205    |    2849    |    1893    |
| GPU reserved segments |     956    |    1205    |    2849    |    1893    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      81    |   21677    |   21657    |
| Non-releasable allocs |      20    |      81    |   21677    |   21657    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 73.62053442001343
cuda 1: Peak memory 14.38 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 14.38 GB ; Persistent memory 0.60 GB
num_iterations = 3
training time = 73.62053442001343
cuda 1: Peak memory 14.38 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 14.38 GB ; Persistent memory 0.60 GB
num_iterations = 3
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
use_offload = False
step time = 20.37730073928833
use_offload = False
step time = 20.37730073928833
--------------- finish training step 0
0 46.4435453414917
step time = 17.407851219177246
0 46.4435453414917
step time = 17.407851219177246
--------------- finish training step 1
1 30.65177273750305
step time = 17.48245596885681
--------------- finish training step 2
2 32.1515257358551
step time = 21.289278030395508
1 30.65177273750305
step time = 17.48245596885681
--------------- finish training step 2
2 32.1515257358551
step time = 21.289278030395508
--------------- finish training step 0
0 44.21890830993652
step time = 18.40003752708435
0 44.21890830993652
step time = 18.40003752708435
--------------- finish training step 1
1 32.85870170593262
step time = 18.659985780715942
--------------- finish training step 2
2 32.6927433013916
step time = 20.98446488380432
1 32.85870170593262
step time = 18.659985780715942
--------------- finish training step 2
2 32.6927433013916
step time = 20.98446488380432
--------------- finish training step 0
0 45.60642695426941
step time = 17.177622318267822
0 45.60642695426941
step time = 17.177622318267822
--------------- finish training step 1
1 31.494473457336426
step time = 15.706093072891235
--------------- finish training step 2
2 30.024470567703247
step time = 19.474403381347656
1 31.494473457336426
step time = 15.706093072891235
--------------- finish training step 2
2 30.024470567703247
step time = 19.474403381347656
--------------- finish training step 0
0 42.89285469055176
step time = 15.658419609069824
0 42.89285469055176
step time = 15.658419609069824
--------------- finish training step 1
1 29.248390913009644
step time = 17.190690755844116
--------------- finish training step 2
2 33.9497230052948
step time = 21.63336706161499
1 29.248390913009644
step time = 17.190690755844116
--------------- finish training step 2
2 33.9497230052948
step time = 21.63336706161499
--------------- finish training step 0
0 48.04526138305664
step time = 18.23299288749695
0 48.04526138305664
step time = 18.23299288749695
--------------- finish training step 1
1 33.22351026535034
step time = 17.19928765296936
--------------- finish training step 2
2 31.439828634262085
step time = 21.0539972782135
--------------- finish training step 0
0 43.849886655807495
step time = 17.09161949157715
--------------- finish training step 1
1 34.59147095680237
step time = 16.831990718841553
--------------- finish training step 2
2 31.310053825378418
cuda 3: Peak memory 14.08 GB ; Persistent memory 0.84 GB
cuda 2: Peak memory 13.65 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 13.63 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 14.12 GB ; Persistent memory 0.84 GB
1 33.22351026535034
step time = 17.19928765296936
--------------- finish training step 2
2 31.439828634262085
step time = 21.0539972782135
--------------- finish training step 0
0 43.849886655807495
step time = 17.09161949157715
--------------- finish training step 1
1 34.59147095680237
step time = 16.831990718841553
--------------- finish training step 2
2 31.310053825378418
cuda 3: Peak memory 14.08 GB ; Persistent memory 0.84 GB
cuda 2: Peak memory 13.65 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 13.63 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 14.12 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  14459 MiB |   1434 GiB |   1433 GiB |
| Allocated memory      |    863 MiB |  14459 MiB |   1434 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  14459 MiB |   1434 GiB |   1433 GiB |
| Active memory         |    895 MiB |  14459 MiB |   1434 GiB |   1433 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  14343 MiB |   1429 GiB |   1429 GiB |
| Requested memory      |    895 MiB |  14343 MiB |   1429 GiB |   1429 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  32718 MiB |  44078 MiB |  97636 MiB |  64918 MiB |
| GPU reserved memory   |  32718 MiB |  44078 MiB |  97636 MiB |  64918 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 295415 KiB |    794 MiB | 257989 MiB | 257700 MiB |
| Non-releasable memory | 295415 KiB |    794 MiB | 257989 MiB | 257700 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     661    |   66334    |   66316    |
| Allocations           |      18    |     661    |   66334    |   66316    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     661    |   66334    |   66314    |
| Active allocs         |      20    |     661    |   66334    |   66314    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     965    |    1336    |    2885    |    1920    |
| GPU reserved segments |     965    |    1336    |    2885    |    1920    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      84    |   21540    |   21519    |
| Non-releasable allocs |      21    |      84    |   21540    |   21519    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 54.773149490356445
num_iterations = 20
training time = 54.773149490356445
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
use_offload = False
step time = 19.949572324752808
use_offload = False
step time = 19.949572324752808
--------------- finish training step 0
0 48.54816651344299
step time = 17.192211866378784
0 48.54816651344299
step time = 17.192211866378784
--------------- finish training step 1
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305
step time = 20.95038938522339
--------------- finish training step 0
0 48.2725293636322
step time = 15.970069885253906
--------------- finish training step 1
1 30.126051425933838
step time = 17.62681007385254
--------------- finish training step 2
2 32.805365800857544
step time = 17.48748517036438
--------------- finish training step 3
3 32.9462833404541
step time = 17.27612566947937
--------------- finish training step 4
4 32.49534344673157
step time = 17.561965465545654
--------------- finish training step 5
5 32.71591854095459
step time = 17.740312099456787
--------------- finish training step 6
6 33.373260498046875
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305
step time = 20.95038938522339
--------------- finish training step 0
0 48.2725293636322
step time = 15.970069885253906
--------------- finish training step 1
1 30.126051425933838
step time = 17.62681007385254
--------------- finish training step 2
2 32.805365800857544
step time = 17.48748517036438
--------------- finish training step 3
3 32.9462833404541
step time = 17.27612566947937
--------------- finish training step 4
4 32.49534344673157
step time = 17.561965465545654
--------------- finish training step 5
5 32.71591854095459
step time = 17.740312099456787
--------------- finish training step 6
6 33.373260498046875
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 471.60452485084534
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
use_offload = False
step time = 19.12251114845276
--------------- finish training step 0
0 43.66464161872864
step time = 15.67203664779663
--------------- finish training step 1
1 28.545896768569946
step time = 15.987875938415527
--------------- finish training step 2
2 28.66563391685486
step time = 17.17708444595337
--------------- finish training step 3
3 30.382317781448364
step time = 17.64166498184204
--------------- finish training step 4
4 31.663018941879272
step time = 17.64940333366394
--------------- finish training step 5
5 31.66824722290039
step time = 17.903267860412598
--------------- finish training step 6
6 31.436365604400635
step time = 20.92046594619751
--------------- finish training step 7
7 34.29251003265381
step time = 17.946186780929565
--------------- finish training step 8
8 31.8657443523407
step time = 19.449439525604248
--------------- finish training step 9
9 33.71455693244934
step time = 19.906930685043335
--------------- finish training step 10
10 34.53290939331055
step time = 19.109283685684204
--------------- finish training step 11
11 33.14331769943237
step time = 18.885144472122192
--------------- finish training step 12
12 33.04104280471802
step time = 20.192808866500854
--------------- finish training step 13
13 34.2590606212616
step time = 20.00261926651001
--------------- finish training step 14
14 34.37171030044556
step time = 18.838423013687134
--------------- finish training step 15
15 33.465172290802
step time = 17.021500825881958
--------------- finish training step 16
16 31.487219095230103
step time = 18.857378244400024
--------------- finish training step 17
17 32.70635223388672
step time = 17.46001148223877
--------------- finish training step 18
18 31.195889472961426
cuda 1: Peak memory 13.58 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 17.0458505153656
--------------- finish training step 19
19 30.199638843536377
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19220 MiB |  19220 MiB |  19220 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1398 MiB | 513615 MiB | 513455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     517    |     517    |     517    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     108    |   31419    |   31399    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 287.50726985931396
cuda 3: Peak memory 14.06 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
use_offload = False
step time = 19.595433473587036
--------------- finish training step 0
0 59.64639115333557
step time = 16.14384126663208
--------------- finish training step 1
1 37.17316555976868
step time = 17.667024850845337
--------------- finish training step 2
2 42.135369062423706
step time = 17.03650736808777
--------------- finish training step 3
3 42.166722536087036
step time = 17.830848455429077
--------------- finish training step 4
4 49.358429193496704
step time = 17.866095542907715
--------------- finish training step 5
5 47.08287000656128
step time = 16.534761667251587
--------------- finish training step 6
6 40.93154001235962
step time = 16.39327621459961
--------------- finish training step 7
7 41.48125505447388
step time = 16.762920141220093
--------------- finish training step 8
8 41.99731421470642
step time = 16.659029483795166
--------------- finish training step 9
9 41.52932858467102
step time = 16.785332679748535
--------------- finish training step 10
10 41.74692916870117
step time = 18.795286417007446
--------------- finish training step 11
11 43.79169940948486
step time = 18.635895252227783
--------------- finish training step 12
12 44.471111536026
step time = 17.551458597183228
--------------- finish training step 13
13 42.78916692733765
step time = 17.15884256362915
--------------- finish training step 14
14 41.94341540336609
step time = 16.799932956695557
--------------- finish training step 15
15 41.48331809043884
step time = 16.756672382354736
--------------- finish training step 16
16 41.567408084869385
step time = 16.831297636032104
--------------- finish training step 17
17 42.88751435279846
step time = 16.82323718070984
--------------- finish training step 18
18 41.8032660484314
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 16.813072204589844
--------------- finish training step 19
19 42.38776755332947
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 522.9292905330658


num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.3328535556793213
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.3328535556793213
--------------- finish training step 0
0 11.158151388168335
step time = 1.7171926498413086
0 11.158151388168335
step time = 1.7171926498413086
--------------- finish training step 1
1 4.743576765060425
step time = 1.8694055080413818
1 4.743576765060425
step time = 1.8694055080413818
--------------- finish training step 2
2 4.964357852935791
step time = 1.71913743019104
2 4.964357852935791
step time = 1.71913743019104
--------------- finish training step 3
3 4.780698537826538
step time = 2.3699896335601807
--------------- finish training step 0
0 8.344735383987427
step time = 1.7263646125793457
--------------- finish training step 1
1 5.041599273681641
step time = 1.869929552078247
--------------- finish training step 2
2 5.217939853668213
step time = 1.8929495811462402
--------------- finish training step 3
3 4.844923734664917
step time = 2.4216928482055664
--------------- finish training step 0
0 8.388510465621948
step time = 1.865851640701294
--------------- finish training step 1
1 5.168453693389893
step time = 1.9060938358306885
--------------- finish training step 2
2 5.195591449737549
step time = 1.8512449264526367
--------------- finish training step 3
3 5.1164820194244385
step time = 2.330504894256592
--------------- finish training step 0
0 8.571029901504517
step time = 1.796112298965454
--------------- finish training step 1
1 5.435134410858154
step time = 1.7101237773895264
--------------- finish training step 2
2 5.122635364532471
step time = 1.738593339920044
--------------- finish training step 3
3 4.943081617355347
step time = 2.397883653640747
--------------- finish training step 0
0 8.884345293045044
step time = 1.7066903114318848
--------------- finish training step 1
1 5.365793704986572
step time = 1.8395540714263916
--------------- finish training step 2
2 5.041285753250122
step time = 1.9777376651763916
--------------- finish training step 3
3 5.282381296157837
step time = 2.4201605319976807
--------------- finish training step 0
0 8.965756893157959
step time = 1.9123601913452148
--------------- finish training step 1
1 5.399929046630859
step time = 1.8580756187438965
--------------- finish training step 2
2 5.394315481185913
step time = 1.8365478515625
--------------- finish training step 3
3 4.917793035507202
cuda 2: Peak memory 5.10 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 5.10 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 5.71 GB ; Persistent memory 0.84 GB
3 4.780698537826538
step time = 2.3699896335601807
--------------- finish training step 0
0 8.344735383987427
step time = 1.7263646125793457
--------------- finish training step 1
1 5.041599273681641
step time = 1.869929552078247
--------------- finish training step 2
2 5.217939853668213
step time = 1.8929495811462402
--------------- finish training step 3
3 4.844923734664917
step time = 2.4216928482055664
--------------- finish training step 0
0 8.388510465621948
step time = 1.865851640701294
--------------- finish training step 1
1 5.168453693389893
step time = 1.9060938358306885
--------------- finish training step 2
2 5.195591449737549
step time = 1.8512449264526367
--------------- finish training step 3
3 5.1164820194244385
step time = 2.330504894256592
--------------- finish training step 0
0 8.571029901504517
step time = 1.796112298965454
--------------- finish training step 1
1 5.435134410858154
step time = 1.7101237773895264
--------------- finish training step 2
2 5.122635364532471
step time = 1.738593339920044
--------------- finish training step 3
3 4.943081617355347
step time = 2.397883653640747
--------------- finish training step 0
0 8.884345293045044
step time = 1.7066903114318848
--------------- finish training step 1
1 5.365793704986572
step time = 1.8395540714263916
--------------- finish training step 2
2 5.041285753250122
step time = 1.9777376651763916
--------------- finish training step 3
3 5.282381296157837
step time = 2.4201605319976807
--------------- finish training step 0
0 8.965756893157959
step time = 1.9123601913452148
--------------- finish training step 1
1 5.399929046630859
step time = 1.8580756187438965
--------------- finish training step 2
2 5.394315481185913
step time = 1.8365478515625
--------------- finish training step 3
3 4.917793035507202
cuda 2: Peak memory 5.10 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 5.10 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 5.71 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |   5846 MiB | 499663 MiB | 498800 MiB |
| Allocated memory      |    863 MiB |   5846 MiB | 499663 MiB | 498800 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |   5846 MiB | 499663 MiB | 498768 MiB |
| Active memory         |    895 MiB |   5846 MiB | 499663 MiB | 498768 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |   5825 MiB | 498423 MiB | 497528 MiB |
| Requested memory      |    895 MiB |   5825 MiB | 498423 MiB | 497528 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34760 MiB |  34760 MiB |  34760 MiB |      0 B   |
| GPU reserved memory   |  34760 MiB |  34760 MiB |  34760 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |    932 MiB | 143335 MiB | 143030 MiB |
| Non-releasable memory | 311799 KiB |    932 MiB | 143335 MiB | 143030 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     236    |   22330    |   22312    |
| Allocations           |      18    |     236    |   22330    |   22312    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     236    |   22330    |   22310    |
| Active allocs         |      20    |     236    |   22330    |   22310    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     880    |     880    |     880    |       0    |
| GPU reserved segments |     880    |     880    |     880    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      66    |    7837    |    7816    |
| Non-releasable allocs |      21    |      66    |    7837    |    7816    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 16.65010094642639
cuda 3: Peak memory 5.48 GB ; Persistent memory 0.84 GB
training time = 16.65010094642639
cuda 3: Peak memory 5.48 GB ; Persistent memory 0.84 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.3455514907836914
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.3455514907836914
--------------- finish training step 0
0 7.253283739089966
step time = 1.739079236984253
0 7.253283739089966
step time = 1.739079236984253
--------------- finish training step 1
1 4.721790790557861
step time = 1.7422294616699219
1 4.721790790557861
step time = 1.7422294616699219
--------------- finish training step 2
2 4.673340320587158
step time = 1.7496159076690674
2 4.673340320587158
step time = 1.7496159076690674
--------------- finish training step 3
3 4.68064284324646
step time = 2.4750566482543945
--------------- finish training step 0
0 5.413019180297852
step time = 1.7440013885498047
--------------- finish training step 1
1 4.7543981075286865
step time = 1.7486772537231445
--------------- finish training step 2
2 4.873239517211914
step time = 1.7479116916656494
--------------- finish training step 3
3 5.058620452880859
step time = 2.3505218029022217
--------------- finish training step 0
0 5.315932750701904
step time = 1.735147476196289
--------------- finish training step 1
1 4.748796224594116
step time = 1.7790381908416748
--------------- finish training step 2
2 4.860647916793823
step time = 1.7386717796325684
--------------- finish training step 3
3 5.03572940826416
step time = 2.4240050315856934
--------------- finish training step 0
0 5.53757905960083
step time = 1.9840114116668701
--------------- finish training step 1
1 5.0742340087890625
step time = 1.7649321556091309
--------------- finish training step 2
2 5.071014404296875
step time = 1.7313244342803955
--------------- finish training step 3
3 4.904968976974487
step time = 2.369110345840454
--------------- finish training step 0
0 5.473120927810669
step time = 1.7954633235931396
--------------- finish training step 1
1 5.172162055969238
step time = 1.7405078411102295
--------------- finish training step 2
2 5.042685031890869
step time = 1.8883910179138184
--------------- finish training step 3
3 5.091851711273193
step time = 2.343059539794922
--------------- finish training step 0
0 5.401479959487915
step time = 1.930281162261963
--------------- finish training step 1
1 5.374734401702881
step time = 1.742006778717041
--------------- finish training step 2
2 5.429773330688477
step time = 2.002699375152588
--------------- finish training step 3
3 5.1378984451293945
cuda 1: Peak memory 5.02 GB ; Persistent memory 0.52 GB
cuda 2: Peak memory 5.02 GB ; Persistent memory 0.52 GB
cuda 0: Peak memory 5.63 GB ; Persistent memory 0.76 GB
3 4.68064284324646
step time = 2.4750566482543945
--------------- finish training step 0
0 5.413019180297852
step time = 1.7440013885498047
--------------- finish training step 1
1 4.7543981075286865
step time = 1.7486772537231445
--------------- finish training step 2
2 4.873239517211914
step time = 1.7479116916656494
--------------- finish training step 3
3 5.058620452880859
step time = 2.3505218029022217
--------------- finish training step 0
0 5.315932750701904
step time = 1.735147476196289
--------------- finish training step 1
1 4.748796224594116
step time = 1.7790381908416748
--------------- finish training step 2
2 4.860647916793823
step time = 1.7386717796325684
--------------- finish training step 3
3 5.03572940826416
step time = 2.4240050315856934
--------------- finish training step 0
0 5.53757905960083
step time = 1.9840114116668701
--------------- finish training step 1
1 5.0742340087890625
step time = 1.7649321556091309
--------------- finish training step 2
2 5.071014404296875
step time = 1.7313244342803955
--------------- finish training step 3
3 4.904968976974487
step time = 2.369110345840454
--------------- finish training step 0
0 5.473120927810669
step time = 1.7954633235931396
--------------- finish training step 1
1 5.172162055969238
step time = 1.7405078411102295
--------------- finish training step 2
2 5.042685031890869
step time = 1.8883910179138184
--------------- finish training step 3
3 5.091851711273193
step time = 2.343059539794922
--------------- finish training step 0
0 5.401479959487915
step time = 1.930281162261963
--------------- finish training step 1
1 5.374734401702881
step time = 1.742006778717041
--------------- finish training step 2
2 5.429773330688477
step time = 2.002699375152588
--------------- finish training step 3
3 5.1378984451293945
cuda 1: Peak memory 5.02 GB ; Persistent memory 0.52 GB
cuda 2: Peak memory 5.02 GB ; Persistent memory 0.52 GB
cuda 0: Peak memory 5.63 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |   5768 MiB | 499727 MiB | 498945 MiB |
| Allocated memory      |    782 MiB |   5768 MiB | 499727 MiB | 498945 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |   5768 MiB | 499727 MiB | 498913 MiB |
| Active memory         |    814 MiB |   5768 MiB | 499727 MiB | 498913 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |   5744 MiB | 498342 MiB | 497528 MiB |
| Requested memory      |    814 MiB |   5744 MiB | 498342 MiB | 497528 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  10474 MiB |  10474 MiB |  10474 MiB |      0 B   |
| GPU reserved memory   |  10474 MiB |  10474 MiB |  10474 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 100087 KiB | 345870 KiB | 106807 MiB | 106709 MiB |
| Non-releasable memory | 100087 KiB | 345870 KiB | 106807 MiB | 106709 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     226    |   22320    |   22312    |
| Allocations           |       8    |     226    |   22320    |   22312    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     226    |   22320    |   22310    |
| Active allocs         |      10    |     226    |   22320    |   22310    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     238    |     238    |     238    |       0    |
| GPU reserved segments |     238    |     238    |     238    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      37    |    7970    |    7962    |
| Non-releasable allocs |       8    |      37    |    7970    |    7962    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 13.325276851654053
cuda 3: Peak memory 5.40 GB ; Persistent memory 0.76 GB
training time = 13.325276851654053
cuda 3: Peak memory 5.40 GB ; Persistent memory 0.76 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.3104827404022217
--------------- finish training step 0
0 7.192077875137329
step time = 1.7183146476745605
--------------- finish training step 1
1 4.777778625488281
step time = 2.3104827404022217
--------------- finish training step 0
0 7.192077875137329
step time = 1.7183146476745605
--------------- finish training step 1
1 4.777778625488281
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 2.4172046184539795
--------------- finish training step 0
0 7.294121026992798
step time = 1.7541921138763428
--------------- finish training step 1
1 4.803698539733887
step time = 1.742511510848999
--------------- finish training step 2
2 4.693946599960327
step time = 1.748936414718628
--------------- finish training step 3
3 4.697770833969116
step time = 2.485640287399292
--------------- finish training step 0
0 5.465430736541748
step time = 1.7460007667541504
--------------- finish training step 1
1 4.689336538314819
step time = 1.7521731853485107
--------------- finish training step 2
2 4.728979587554932
step time = 1.822300672531128
--------------- finish training step 3
3 5.0475568771362305
step time = 2.334582567214966
--------------- finish training step 0
0 5.347849130630493
step time = 1.737987756729126
--------------- finish training step 1
1 4.680919408798218
step time = 1.7389051914215088
--------------- finish training step 2
2 4.705979585647583
step time = 1.8552577495574951
--------------- finish training step 3
3 4.814582109451294
step time = 2.3451309204101562
--------------- finish training step 0
0 5.4839208126068115
step time = 2.008725881576538
--------------- finish training step 1
1 5.014405965805054
step time = 1.8052594661712646
--------------- finish training step 2
2 4.899225234985352
step time = 1.8876373767852783
--------------- finish training step 3
3 4.871422529220581
step time = 2.363926887512207
--------------- finish training step 0
0 6.028920650482178
step time = 1.995955228805542
--------------- finish training step 1
1 5.081820964813232
step time = 1.7747032642364502
--------------- finish training step 2
2 4.7986650466918945
step time = 1.8931069374084473
--------------- finish training step 3
3 4.958645820617676
step time = 2.3438031673431396
--------------- finish training step 0
0 5.5831427574157715
step time = 2.005176544189453
--------------- finish training step 1
1 5.200283527374268
step time = 1.7928788661956787
--------------- finish training step 2
2 4.804856061935425
step time = 1.853370189666748
--------------- finish training step 3
3 4.865900754928589
cuda 2: Peak memory 6.99 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 6.99 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 7.61 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |   7790 MiB | 499741 MiB | 498878 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |   7790 MiB | 499741 MiB | 498846 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |   7767 MiB | 498495 MiB | 497600 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35338 MiB |  35338 MiB |  35338 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |    911 MiB | 154093 MiB | 153788 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     299    |   22438    |   22420    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     299    |   22438    |   22418    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     887    |     887    |     887    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      60    |    8130    |    8109    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 12.458425283432007
cuda 3: Peak memory 7.38 GB ; Persistent memory 0.84 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 2.4172046184539795
--------------- finish training step 0
0 7.294121026992798
step time = 1.7541921138763428
--------------- finish training step 1
1 4.803698539733887
step time = 1.742511510848999
--------------- finish training step 2
2 4.693946599960327
step time = 1.748936414718628
--------------- finish training step 3
3 4.697770833969116
step time = 2.485640287399292
--------------- finish training step 0
0 5.465430736541748
step time = 1.7460007667541504
--------------- finish training step 1
1 4.689336538314819
step time = 1.7521731853485107
--------------- finish training step 2
2 4.728979587554932
step time = 1.822300672531128
--------------- finish training step 3
3 5.0475568771362305
step time = 2.334582567214966
--------------- finish training step 0
0 5.347849130630493
step time = 1.737987756729126
--------------- finish training step 1
1 4.680919408798218
step time = 1.7389051914215088
--------------- finish training step 2
2 4.705979585647583
step time = 1.8552577495574951
--------------- finish training step 3
3 4.814582109451294
step time = 2.3451309204101562
--------------- finish training step 0
0 5.4839208126068115
step time = 2.008725881576538
--------------- finish training step 1
1 5.014405965805054
step time = 1.8052594661712646
--------------- finish training step 2
2 4.899225234985352
step time = 1.8876373767852783
--------------- finish training step 3
3 4.871422529220581
step time = 2.363926887512207
--------------- finish training step 0
0 6.028920650482178
step time = 1.995955228805542
--------------- finish training step 1
1 5.081820964813232
step time = 1.7747032642364502
--------------- finish training step 2
2 4.7986650466918945
step time = 1.8931069374084473
--------------- finish training step 3
3 4.958645820617676
step time = 2.3438031673431396
--------------- finish training step 0
0 5.5831427574157715
step time = 2.005176544189453
--------------- finish training step 1
1 5.200283527374268
step time = 1.7928788661956787
--------------- finish training step 2
2 4.804856061935425
step time = 1.853370189666748
--------------- finish training step 3
3 4.865900754928589
cuda 2: Peak memory 6.99 GB ; Persistent memory 0.60 GB
cuda 1: Peak memory 6.99 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 7.61 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |   7790 MiB | 499741 MiB | 498878 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |   7790 MiB | 499741 MiB | 498846 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |   7767 MiB | 498495 MiB | 497600 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35338 MiB |  35338 MiB |  35338 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |    911 MiB | 154093 MiB | 153788 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     299    |   22438    |   22420    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     299    |   22438    |   22418    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     887    |     887    |     887    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      21    |      60    |    8130    |    8109    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 12.458425283432007
cuda 3: Peak memory 7.38 GB ; Persistent memory 0.84 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.180036067962646
step time = 10.180036067962646
--------------- finish training step 0
0 23.298501014709473
step time = 7.600374460220337
0 23.298501014709473
step time = 7.600374460220337
--------------- finish training step 1
1 19.86466693878174
step time = 7.146616220474243
1 19.86466693878174
step time = 7.146616220474243
--------------- finish training step 2
2 18.986379623413086
step time = 8.571488380432129
2 18.986379623413086
step time = 8.571488380432129
--------------- finish training step 3
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.758641242980957
--------------- finish training step 0
0 39.718183279037476
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.292932033538818
--------------- finish training step 0
0 23.59179401397705
step time = 7.094132423400879
--------------- finish training step 1
1 18.65003228187561
step time = 8.787808179855347
--------------- finish training step 2
2 21.354671001434326
step time = 7.745500087738037
--------------- finish training step 3
3 19.443853616714478
step time = 9.579043626785278
--------------- finish training step 0
0 21.999890327453613
step time = 8.607156753540039
--------------- finish training step 1
1 21.303159952163696
step time = 7.47771143913269
--------------- finish training step 2
2 19.156214714050293
step time = 8.37932276725769
--------------- finish training step 3
3 21.19980549812317
step time = 9.935779333114624
--------------- finish training step 0
0 25.1234610080719
step time = 8.122731924057007
--------------- finish training step 1
1 20.421676874160767
step time = 8.137483835220337
--------------- finish training step 2
2 20.115924835205078
step time = 8.189379692077637
--------------- finish training step 3
3 21.3676495552063
step time = 9.96174144744873
--------------- finish training step 0
0 22.90093421936035
step time = 7.796846866607666
--------------- finish training step 1
1 19.451209545135498
step time = 7.988969802856445
--------------- finish training step 2
2 20.2703275680542
step time = 7.622713804244995
--------------- finish training step 3
3 20.64853000640869
step time = 10.197582960128784
--------------- finish training step 0
0 25.766765356063843
step time = 8.504954099655151
--------------- finish training step 1
1 21.736475467681885
step time = 8.280858516693115
--------------- finish training step 2
2 21.06488299369812
step time = 7.829766750335693
--------------- finish training step 3
3 21.1092746257782
step time = 10.255677461624146
--------------- finish training step 0
0 25.703478574752808
step time = 8.709559202194214
--------------- finish training step 1
1 21.22169852256775
step time = 8.4834623336792
--------------- finish training step 2
2 20.8741238117218
step time = 7.917112112045288
--------------- finish training step 3
3 20.320783615112305
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 16.30 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  16691 MiB |   1848 GiB |   1847 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  16691 MiB |   1848 GiB |   1847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  16583 MiB |   1843 GiB |   1842 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  33988 MiB |  44108 MiB |  93256 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB | 775243 KiB | 470064 MiB | 469760 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     715    |   86950    |   86932    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     715    |   86950    |   86930    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     955    |    1298    |    2698    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |      82    |   28344    |   28321    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 52.7535343170166
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.600994110107422
--------------- finish training step 0
0 27.40497922897339
step time = 1.4444868564605713
--------------- finish training step 1
1 9.515098094940186
step time = 3.184945583343506
--------------- finish training step 2
2 11.176170587539673
step time = 1.7937588691711426
--------------- finish training step 3
3 11.166242361068726
cuda 0: Peak memory 16.22 GB ; Persistent memory 1.29 GB
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.758641242980957
--------------- finish training step 0
0 39.718183279037476
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.292932033538818
--------------- finish training step 0
0 23.59179401397705
step time = 7.094132423400879
--------------- finish training step 1
1 18.65003228187561
step time = 8.787808179855347
--------------- finish training step 2
2 21.354671001434326
step time = 7.745500087738037
--------------- finish training step 3
3 19.443853616714478
step time = 9.579043626785278
--------------- finish training step 0
0 21.999890327453613
step time = 8.607156753540039
--------------- finish training step 1
1 21.303159952163696
step time = 7.47771143913269
--------------- finish training step 2
2 19.156214714050293
step time = 8.37932276725769
--------------- finish training step 3
3 21.19980549812317
step time = 9.935779333114624
--------------- finish training step 0
0 25.1234610080719
step time = 8.122731924057007
--------------- finish training step 1
1 20.421676874160767
step time = 8.137483835220337
--------------- finish training step 2
2 20.115924835205078
step time = 8.189379692077637
--------------- finish training step 3
3 21.3676495552063
step time = 9.96174144744873
--------------- finish training step 0
0 22.90093421936035
step time = 7.796846866607666
--------------- finish training step 1
1 19.451209545135498
step time = 7.988969802856445
--------------- finish training step 2
2 20.2703275680542
step time = 7.622713804244995
--------------- finish training step 3
3 20.64853000640869
step time = 10.197582960128784
--------------- finish training step 0
0 25.766765356063843
step time = 8.504954099655151
--------------- finish training step 1
1 21.736475467681885
step time = 8.280858516693115
--------------- finish training step 2
2 21.06488299369812
step time = 7.829766750335693
--------------- finish training step 3
3 21.1092746257782
step time = 10.255677461624146
--------------- finish training step 0
0 25.703478574752808
step time = 8.709559202194214
--------------- finish training step 1
1 21.22169852256775
step time = 8.4834623336792
--------------- finish training step 2
2 20.8741238117218
step time = 7.917112112045288
--------------- finish training step 3
3 20.320783615112305
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 0: Peak memory 16.30 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  16691 MiB |   1848 GiB |   1847 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  16691 MiB |   1848 GiB |   1847 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  16583 MiB |   1843 GiB |   1842 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  33988 MiB |  44108 MiB |  93256 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB | 775243 KiB | 470064 MiB | 469760 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     715    |   86950    |   86932    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     715    |   86950    |   86930    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     955    |    1298    |    2698    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |      82    |   28344    |   28321    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 52.7535343170166
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.600994110107422
--------------- finish training step 0
0 27.40497922897339
step time = 1.4444868564605713
--------------- finish training step 1
1 9.515098094940186
step time = 3.184945583343506
--------------- finish training step 2
2 11.176170587539673
step time = 1.7937588691711426
--------------- finish training step 3
3 11.166242361068726
cuda 0: Peak memory 16.22 GB ; Persistent memory 1.29 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1318 MiB |  16614 MiB | 316037 MiB | 314718 MiB |
| Allocated memory      |   1318 MiB |  16614 MiB | 316037 MiB | 314718 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1318 MiB |  16614 MiB | 316037 MiB | 314718 MiB |
| Active memory         |   1318 MiB |  16614 MiB | 316037 MiB | 314718 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1318 MiB |  16502 MiB | 315013 MiB | 313694 MiB |
| Requested memory      |   1318 MiB |  16502 MiB | 315013 MiB | 313694 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1538 MiB |  18974 MiB |  71114 MiB |  69576 MiB |
| GPU reserved memory   |   1538 MiB |  18974 MiB |  71114 MiB |  69576 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 136885 KiB | 354549 KiB |  46613 MiB |  46479 MiB |
| Non-releasable memory | 136885 KiB | 354549 KiB |  46613 MiB |  46479 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      57    |     705    |   14494    |   14437    |
| Allocations           |      57    |     705    |   14494    |   14437    |
|---------------------------------------------------------------------------|
| Active allocs         |      57    |     705    |   14494    |   14437    |
| Active allocs         |      57    |     705    |   14494    |   14437    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      42    |     525    |    1966    |    1924    |
| GPU reserved segments |      42    |     525    |    1966    |    1924    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      49    |    3639    |    3624    |
| Non-releasable allocs |      15    |      49    |    3639    |    3624    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 41.75993371009827
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.30 GB
cuda 3: Peak memory 15.75 GB ; Persistent memory 0.54 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.30 GB
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.951533079147339
--------------- finish training step 0
0 28.602105140686035
step time = 1.87093186378479
--------------- finish training step 1
1 11.16714358329773
step time = 10.58967924118042
--------------- finish training step 0
0 19.644585132598877
step time = 1.764484167098999
--------------- finish training step 1
1 10.63292121887207
step time = 10.898927688598633
--------------- finish training step 0
0 19.357768535614014
step time = 1.798591136932373
--------------- finish training step 1
1 11.363125801086426
step time = 11.522542238235474
--------------- finish training step 0
0 20.880191802978516
step time = 2.938433885574341
--------------- finish training step 1
1 14.041161298751831
step time = 10.469665765762329
--------------- finish training step 0
0 23.221890449523926
step time = 1.74238920211792
--------------- finish training step 1
1 10.404965877532959
step time = 9.838907241821289
--------------- finish training step 0
0 18.434149742126465
step time = 1.4167473316192627
--------------- finish training step 1
1 9.935256719589233
num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.670130252838135
--------------- finish training step 0
0 29.584840774536133
step time = 7.0216851234436035
--------------- finish training step 1
1 16.24901056289673
step time = 9.94407343864441
--------------- finish training step 0
0 19.90590763092041
step time = 7.841419458389282
--------------- finish training step 1
1 17.627234935760498
step time = 9.486590385437012
--------------- finish training step 0
0 19.671106815338135
step time = 7.150528907775879
--------------- finish training step 1
1 16.919204473495483
step time = 9.659780740737915
--------------- finish training step 0
0 19.76496720314026
step time = 8.009068012237549
--------------- finish training step 1
1 18.173042058944702
step time = 10.059401035308838
--------------- finish training step 0
0 19.972222566604614
step time = 7.034048557281494
--------------- finish training step 1
1 16.613389015197754
step time = 9.730099439620972
--------------- finish training step 2
2 21.729272842407227
step time = 8.768928289413452
--------------- finish training step 3
3 19.61489725112915
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.75 GB ; Persistent memory 0.52 GB
cuda 0: Peak memory 16.22 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16614 MiB |    924 GiB |    924 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16614 MiB |    924 GiB |    924 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16502 MiB |    921 GiB |    921 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18914 MiB |  18914 MiB |  18914 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  67319 KiB | 459827 KiB | 206236 MiB | 206170 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     705    |   43475    |   43467    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     705    |   43475    |   43465    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     511    |     511    |     511    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      57    |   15568    |   15561    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 42.336665391922
step time = 9.375033855438232
--------------- finish training step 0
0 29.154049158096313
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.525535583496094
--------------- finish training step 0
0 29.448948621749878
step time = 7.097088813781738
--------------- finish training step 1
1 17.279617309570312
step time = 9.885040283203125
--------------- finish training step 0
0 20.28204107284546
step time = 7.365418910980225
--------------- finish training step 1
1 17.43230366706848
step time = 10.103328466415405
--------------- finish training step 0
0 21.366511821746826
step time = 7.378365993499756
--------------- finish training step 1
1 17.410562753677368
step time = 10.049835443496704
--------------- finish training step 0
0 21.349315404891968
step time = 7.523381948471069
--------------- finish training step 1
1 17.91798758506775
step time = 10.078152894973755
--------------- finish training step 0
0 21.9055233001709
step time = 7.35413670539856
--------------- finish training step 1
1 17.3370840549469
step time = 8.77133846282959
--------------- finish training step 2
2 19.62940263748169
step time = 7.868212938308716
--------------- finish training step 3
3 18.316538095474243
step time = 8.322901248931885
--------------- finish training step 4
4 19.187187671661377
step time = 8.42562484741211
--------------- finish training step 5
5 19.067073822021484
step time = 7.64095664024353
--------------- finish training step 6
6 18.147786140441895
step time = 8.607338428497314
--------------- finish training step 7
7 19.30187726020813
step time = 7.363936424255371
--------------- finish training step 8
8 17.744693994522095
step time = 8.81081485748291
--------------- finish training step 9
9 19.62404155731201
step time = 7.384002923965454
--------------- finish training step 10
10 17.750698804855347
step time = 8.891631841659546
--------------- finish training step 11
11 19.908173322677612
step time = 7.578248739242554
--------------- finish training step 12
12 17.815377950668335
step time = 8.790925025939941
--------------- finish training step 13
13 20.015196323394775
step time = 7.724750518798828
--------------- finish training step 14
14 18.106260299682617
step time = 8.503696918487549
--------------- finish training step 15
15 19.586467742919922
step time = 8.070767879486084
--------------- finish training step 16
16 18.801446437835693
step time = 7.69559383392334
--------------- finish training step 17
17 18.35729956626892
step time = 8.202224731445312
--------------- finish training step 18
18 19.23240900039673
step time = 7.65532922744751
--------------- finish training step 19
19 18.771678924560547
cuda 0: Peak memory 18.21 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  18650 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  18650 MiB |   2156 GiB |   2155 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  18550 MiB |   2150 GiB |   2149 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19914 MiB |  19914 MiB |  19914 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   1351 MiB | 752647 MiB | 752564 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     833    |  101427    |  101419    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     833    |  101427    |  101417    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     515    |     515    |     515    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      99    |   41271    |   41262    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 214.86233043670654
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.693018198013306
--------------- finish training step 0
0 30.220471620559692
step time = 7.17401909828186
--------------- finish training step 1
1 16.7950336933136

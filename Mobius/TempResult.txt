num_iterations = 1
batch_size = 128
num_layers = 32
num_stages = 8
step time = 25.710164785385132
--------------- finish training step 0
0 79.44217014312744
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 0: Peak memory 27.12 GB ; Persistent memory 1.08 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1102 MiB |  27767 MiB | 139447 MiB | 138344 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1102 MiB |  27767 MiB | 139447 MiB | 138344 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1102 MiB |  27767 MiB | 139446 MiB | 138344 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1250 MiB |  27850 MiB |  30152 MiB |  28902 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 151155 KiB | 497915 KiB |  20362 MiB |  20215 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      46    |     672    |    3723    |    3677    |
|---------------------------------------------------------------------------|
| Active allocs         |      46    |     672    |    3723    |    3677    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     483    |     516    |     493    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      34    |     904    |     889    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 79.45912504196167
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.34 GB
cuda 3: Peak memory 27.30 GB ; Persistent memory 0.58 GB

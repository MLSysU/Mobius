num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.443849086761475
--------------- finish training step 0
0 93.12858867645264
step time = 21.628644704818726
--------------- finish training step 0
0 69.03165292739868
step time = 21.397411346435547
--------------- finish training step 0
0 70.6842749118805
cuda 0: Peak memory 15.84 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16222 MiB | 241841 MiB | 241058 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16222 MiB | 241841 MiB | 241026 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16110 MiB | 241073 MiB | 240258 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1042 MiB |  17388 MiB |  59076 MiB |  58034 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  67319 KiB | 414883 KiB |  51452 MiB |  51386 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     673    |   10983    |   10975    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     673    |   10983    |   10973    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     494    |    1580    |    1557    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      53    |    3775    |    3768    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 70.68502449989319
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.74 GB ; Persistent memory 0.52 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.192936420440674
--------------- finish training step 0
0 95.51504969596863
cuda 3: Peak memory 15.74 GB ; Persistent memory 0.52 GB
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  15972 MiB |  80968 MiB |  80186 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  15972 MiB |  80968 MiB |  80154 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  15860 MiB |  80712 MiB |  79898 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17126 MiB |  20440 MiB |  19382 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  50935 KiB | 348484 KiB |  14062 MiB |  14013 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     671    |    3665    |    3657    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     671    |    3665    |    3655    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     494    |     540    |     516    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      53    |    1299    |    1293    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 95.5154128074646
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.28 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.97627282142639
--------------- finish training step 0
0 93.60194182395935
step time = 21.805439472198486
--------------- finish training step 0
0 69.60281372070312
step time = 21.560812950134277
--------------- finish training step 0
0 69.409099817276
step time = 21.748663187026978
--------------- finish training step 0
0 69.55050230026245
step time = 21.9634907245636
--------------- finish training step 0
0 69.68115425109863
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 0: Peak memory 15.84 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  16222 MiB | 402713 MiB | 401931 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  16222 MiB | 402713 MiB | 401899 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  16110 MiB | 401433 MiB | 400619 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1042 MiB |  17388 MiB |  97744 MiB |  96702 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  67319 KiB | 414883 KiB |  90297 MiB |  90232 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     673    |   18301    |   18293    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     673    |   18301    |   18291    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      23    |     494    |    2622    |    2599    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      53    |    6350    |    6343    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 69.68160009384155
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.74 GB ; Persistent memory 0.52 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.198502779006958
--------------- finish training step 0
0 95.43979668617249
step time = 21.350197553634644
--------------- finish training step 0
0 71.60610961914062
step time = 21.18515419960022
--------------- finish training step 0
0 67.22003960609436
step time = 21.31238865852356
--------------- finish training step 0
0 68.89942383766174
step time = 21.2587628364563
--------------- finish training step 0
0 69.35969352722168
cuda 0: Peak memory 15.91 GB ; Persistent memory 0.83 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    847 MiB |  16287 MiB | 402778 MiB | 401931 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    879 MiB |  16287 MiB | 402778 MiB | 401899 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    879 MiB |  16175 MiB | 401498 MiB | 400619 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1436 MiB |  17804 MiB |  98908 MiB |  97472 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 486135 KiB | 744819 KiB |  72641 MiB |  72167 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      16    |     681    |   18309    |   18293    |
|---------------------------------------------------------------------------|
| Active allocs         |      18    |     681    |   18309    |   18291    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      29    |     499    |    2651    |    2622    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      64    |    6227    |    6207    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 69.36002802848816
cuda 2: Peak memory 15.42 GB ; Persistent memory 0.34 GB
cuda 1: Peak memory 15.42 GB ; Persistent memory 0.34 GB
cuda 3: Peak memory 15.82 GB ; Persistent memory 0.60 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.28216862678528
--------------- finish training step 0
0 100.04016757011414
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80696 MiB |  79754 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14890 MiB |  14605 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1259    |    1242    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 100.04052329063416
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.74 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.517677545547485
--------------- finish training step 0
0 94.3084363937378
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80696 MiB |  79754 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17126 MiB |  20440 MiB |  19382 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118451 KiB | 348484 KiB |  13990 MiB |  13875 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     494    |     540    |     516    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      53    |    1286    |    1268    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 94.30880045890808
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.629732131958008
--------------- finish training step 0
0 99.90573072433472
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14890 MiB |  14605 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1292    |    1275    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 99.90605092048645
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.095799684524536
--------------- finish training step 0
0 93.17752695083618
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14858 MiB |  14573 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1290    |    1273    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 93.17822313308716
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.129746913909912
--------------- finish training step 0
0 94.9839837551117
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1244 MiB |  17144 MiB |  20740 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 308915 KiB | 497604 KiB |  14202 MiB |  13901 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     495    |     544    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |      53    |    1248    |    1232    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 94.98463416099548
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.698189735412598
--------------- finish training step 0
0 97.08127284049988
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14890 MiB |  14605 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1292    |    1275    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 97.08157277107239
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 21.063138723373413
--------------- finish training step 0
0 94.47609734535217
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14858 MiB |  14573 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1290    |    1273    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 94.47694873809814
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.74 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 19.454577207565308
--------------- finish training step 0
0 77.58187985420227
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17126 MiB |  20440 MiB |  19382 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118451 KiB | 352580 KiB |  14062 MiB |  13947 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     493    |     539    |     515    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      53    |    1324    |    1306    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.58203029632568
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 21.286396265029907
--------------- finish training step 0
0 77.35067844390869
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14906 MiB |  14621 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1293    |    1276    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.35097622871399
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 21.041187047958374
--------------- finish training step 0
0 77.07111835479736
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81016 MiB |  80074 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80760 MiB |  79818 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14906 MiB |  14621 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3794    |    3749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1293    |    1276    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.0718367099762
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 20.26066565513611
--------------- finish training step 0
0 75.88449501991272
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  87193 MiB |  86251 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  87193 MiB |  86251 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  86936 MiB |  85994 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17054 MiB |  20870 MiB |  19642 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 531012 KiB |  18771 MiB |  18486 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    5770    |    5725    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    5770    |    5725    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     487    |     537    |     513    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      55    |    1984    |    1967    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 75.88486051559448
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.412935733795166
--------------- finish training step 0
0 77.63681626319885
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  87193 MiB |  86251 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  87193 MiB |  86251 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  86936 MiB |  85994 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17054 MiB |  20870 MiB |  19642 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  18855 MiB |  18570 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    5770    |    5725    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    5770    |    5725    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     487    |     537    |     513    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      55    |    1996    |    1979    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.63710379600525
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 20.670750617980957
--------------- finish training step 0
0 76.71683716773987
step time = 21.875115871429443
--------------- finish training step 0
0 60.49181628227234
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
step time = 21.422871112823486
--------------- finish training step 0
0 77.75579619407654
step time = 21.270212173461914
--------------- finish training step 0
0 59.51300239562988
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 20.894485235214233
--------------- finish training step 0
0 76.4530897140503
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20756 MiB |  19528 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14914 MiB |  14629 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3910    |    3865    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3910    |    3865    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     496    |     545    |     521    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      54    |    1324    |    1307    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.45393419265747
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.210750818252563
--------------- finish training step 0
0 77.29661417007446
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  84169 MiB |  83226 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  84169 MiB |  83226 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  83912 MiB |  82970 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17054 MiB |  20666 MiB |  19438 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 531012 KiB |  18771 MiB |  18485 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    4898    |    4853    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    4898    |    4853    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     487    |     536    |     512    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      55    |    1691    |    1674    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.29690384864807
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 20.603577136993408
--------------- finish training step 0
0 76.14929294586182
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1260 MiB |  17144 MiB |  20740 MiB |  19480 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 325299 KiB | 431116 KiB |  15066 MiB |  14749 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     493    |     541    |     517    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      53    |    1325    |    1307    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.15044713020325
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 20.652437210083008
--------------- finish training step 0
0 76.0340325832367
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1260 MiB |  17144 MiB |  20740 MiB |  19480 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 325299 KiB | 431116 KiB |  15082 MiB |  14765 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     493    |     541    |     517    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      53    |    1326    |    1308    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.03438949584961
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.11513328552246
--------------- finish training step 0
0 76.31243872642517
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1260 MiB |  17144 MiB |  20740 MiB |  19480 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 325299 KiB | 431116 KiB |  15110 MiB |  14793 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3912    |    3867    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     493    |     541    |     517    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      18    |      53    |    1327    |    1309    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.31317067146301
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 20.533926486968994
--------------- finish training step 0
0 76.00968861579895
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80696 MiB |  79754 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14938 MiB |  14653 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1262    |    1245    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.01003289222717
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.264805793762207
--------------- finish training step 0
0 76.76565074920654
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80696 MiB |  79754 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20724 MiB |  19496 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14938 MiB |  14653 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3664    |    3619    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1262    |    1245    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.7660026550293
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.0771701335907
--------------- finish training step 0
0 76.49457287788391
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20756 MiB |  19528 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14906 MiB |  14621 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     544    |     520    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1313    |    1296    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.49488115310669
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 21.173593997955322
--------------- finish training step 0
0 76.6202130317688
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81208 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81208 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80952 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20772 MiB |  19544 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  15002 MiB |  14717 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    4174    |    4129    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    4174    |    4129    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |     493    |     542    |     520    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      54    |    1379    |    1362    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.62052750587463
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 20.841976642608643
--------------- finish training step 0
0 76.59229898452759
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20756 MiB |  19528 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14938 MiB |  14653 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     544    |     520    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1315    |    1298    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.59267377853394
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 20.74573802947998
--------------- finish training step 0
0 74.3044331073761
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  79536 MiB |  78594 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  79536 MiB |  78594 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  79280 MiB |  78338 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  19180 MiB |  17952 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14926 MiB |  14641 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3872    |    3827    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3872    |    3827    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     515    |     491    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1311    |    1294    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 74.30521416664124
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
step time = 20.781208038330078
--------------- finish training step 0
0 75.95755577087402
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20756 MiB |  19528 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14906 MiB |  14621 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     544    |     520    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1313    |    1296    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 75.9579131603241
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 15.76 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 15.35 GB ; Persistent memory 0.31 GB
step time = 20.496040105819702
--------------- finish training step 0
0 77.72069883346558
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1228 MiB |  17144 MiB |  20756 MiB |  19528 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 292531 KiB | 501444 KiB |  14906 MiB |  14621 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3908    |    3863    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     544    |     520    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1313    |    1296    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.72125267982483
cuda 2: Peak memory 15.35 GB ; Persistent memory 0.31 GB
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 20.429121255874634
--------------- finish training step 0
0 75.77347016334534
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.80 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    814 MiB |  15972 MiB |  81080 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  15972 MiB |  81080 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  15860 MiB |  80824 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  17144 MiB |  20490 MiB |  19608 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  69299 KiB | 354628 KiB |  14640 MiB |  14573 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |     671    |    3908    |    3871    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |     671    |    3908    |    3871    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |     495    |     542    |     525    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      53    |    1310    |    1296    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 75.77425932884216
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
step time = 20.954367637634277
--------------- finish training step 0
0 76.39172005653381
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.80 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    814 MiB |  15972 MiB |  81208 MiB |  80394 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  15972 MiB |  81208 MiB |  80394 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  15860 MiB |  80952 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  17144 MiB |  20522 MiB |  19640 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  69299 KiB | 371012 KiB |  14080 MiB |  14013 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |     671    |    4174    |    4137    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |     671    |    4174    |    4137    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |     493    |     541    |     524    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      54    |    1335    |    1321    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.39201807975769
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 20.63593101501465
--------------- finish training step 0
0 76.20765519142151
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.80 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    814 MiB |  15972 MiB |  81080 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  15972 MiB |  81080 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  15860 MiB |  80824 MiB |  80010 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  17144 MiB |  20490 MiB |  19608 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  69299 KiB | 354628 KiB |  14640 MiB |  14573 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |     671    |    3908    |    3871    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |     671    |    3908    |    3871    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |     495    |     542    |     525    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      53    |    1310    |    1296    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.20802450180054
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
step time = 21.275840997695923
--------------- finish training step 0
0 77.03331899642944
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.80 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    814 MiB |  15972 MiB |  81336 MiB |  80522 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  15972 MiB |  81336 MiB |  80522 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  15860 MiB |  81080 MiB |  80266 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    882 MiB |  17144 MiB |  20554 MiB |  19672 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |  69299 KiB | 371012 KiB |  14929 MiB |  14861 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |     671    |    4410    |    4373    |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |     671    |    4410    |    4373    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      17    |     491    |     540    |     523    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |      54    |    1438    |    1424    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 77.03363752365112
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 20.576774835586548
--------------- finish training step 0
0 75.7938232421875
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17144 MiB |  20506 MiB |  19448 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118451 KiB | 354628 KiB |  13980 MiB |  13865 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1275    |    1258    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 75.79419159889221
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 20.806963443756104
--------------- finish training step 0
0 76.3141975402832
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17144 MiB |  20506 MiB |  19448 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118451 KiB | 354628 KiB |  13980 MiB |  13865 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1275    |    1258    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.31456279754639
num_iterations = 1
batch_size = 64
num_layers = 32
num_stages = 8
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 16.00 GB ; Persistent memory 0.81 GB
step time = 20.589351892471313
--------------- finish training step 0
0 76.03023505210876
cuda 0: Peak memory 15.60 GB ; Persistent memory 0.92 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Active memory         |    942 MiB |  15972 MiB |  81080 MiB |  80138 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |    942 MiB |  15860 MiB |  80824 MiB |  79882 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1058 MiB |  17144 MiB |  20506 MiB |  19448 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 118451 KiB | 354628 KiB |  13980 MiB |  13865 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |     671    |    3918    |    3873    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      24    |     495    |     543    |     519    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      53    |    1275    |    1258    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 76.03194212913513
num_iterations = 2
batch_size = 64
num_layers = 32
num_stages = 8
step time = 5.003614664077759
--------------- finish training step 0
0 21.1387722492218
cuda 1: Peak memory 4.64 GB ; Persistent memory 0.54 GB
cuda 3: Peak memory 5.04 GB ; Persistent memory 0.80 GB
step time = 3.981274127960205
--------------- finish training step 1
1 35.578662157058716
cuda 0: Peak memory 5.01 GB ; Persistent memory 1.03 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1058 MiB |   5130 MiB |  42910 MiB |  41852 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1058 MiB |   5130 MiB |  42910 MiB |  41852 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1058 MiB |   5102 MiB |  42782 MiB |  41724 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1238 MiB |   5482 MiB |  11988 MiB |  10750 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 183990 KiB | 332646 KiB |   9251 MiB |   9071 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1886    |    1851    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1886    |    1851    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     149    |     309    |     284    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |      27    |     650    |     634    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 35.57893252372742
cuda 2: Peak memory 4.64 GB ; Persistent memory 0.54 GB
num_iterations = 2
batch_size = 64
num_layers = 32
num_stages = 8
step time = 4.787933588027954
--------------- finish training step 0
0 21.044734716415405
cuda 2: Peak memory 4.64 GB ; Persistent memory 0.54 GB
cuda 3: Peak memory 5.04 GB ; Persistent memory 0.80 GB
step time = 4.01978325843811
--------------- finish training step 1
1 35.574968338012695
cuda 0: Peak memory 5.01 GB ; Persistent memory 1.03 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1058 MiB |   5130 MiB |  42910 MiB |  41852 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1058 MiB |   5130 MiB |  42910 MiB |  41852 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1058 MiB |   5102 MiB |  42782 MiB |  41724 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1238 MiB |   5482 MiB |  11988 MiB |  10750 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 183990 KiB | 332646 KiB |   9203 MiB |   9023 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1886    |    1851    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1886    |    1851    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     149    |     309    |     284    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |      27    |     647    |     631    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 35.57521390914917
cuda 1: Peak memory 4.64 GB ; Persistent memory 0.54 GB
num_iterations = 2
batch_size = 128
num_layers = 32
num_stages = 8
step time = 4.923277854919434
--------------- finish training step 0
0 21.317019939422607
cuda 1: Peak memory 7.77 GB ; Persistent memory 0.57 GB
cuda 3: Peak memory 8.25 GB ; Persistent memory 0.83 GB
step time = 3.6833555698394775
--------------- finish training step 1
1 36.09097957611084
cuda 0: Peak memory 8.26 GB ; Persistent memory 1.31 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1718 MiB |   8610 MiB |  17546 MiB |  15828 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380534 KiB | 380534 KiB |  14059 MiB |  13687 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     146    |     300    |     275    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      20    |     597    |     580    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 36.09118390083313
cuda 2: Peak memory 7.77 GB ; Persistent memory 0.57 GB
num_iterations = 2
batch_size = 128
num_layers = 32
num_stages = 8
num_iterations = 2
batch_size = 128
num_layers = 32
num_stages = 8
step time = 4.730547189712524
--------------- finish training step 0
0 21.800415992736816
cuda 2: Peak memory 7.77 GB ; Persistent memory 0.57 GB
cuda 1: Peak memory 7.77 GB ; Persistent memory 0.57 GB
step time = 3.4824869632720947
--------------- finish training step 1
1 35.85044002532959
cuda 0: Peak memory 8.26 GB ; Persistent memory 1.31 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1718 MiB |   8610 MiB |  17546 MiB |  15828 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380534 KiB | 380534 KiB |  14379 MiB |  14007 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     146    |     300    |     275    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      20    |     605    |     588    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 35.850566148757935
cuda 3: Peak memory 8.25 GB ; Persistent memory 0.83 GB
num_iterations = 2
batch_size = 128
num_layers = 32
num_stages = 8
step time = 4.6245927810668945
--------------- finish training step 0
0 21.696310997009277
cuda 1: Peak memory 7.77 GB ; Persistent memory 0.57 GB
step time = 3.6764023303985596
--------------- finish training step 1
1 36.56352758407593
cuda 0: Peak memory 8.26 GB ; Persistent memory 1.31 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1718 MiB |   8610 MiB |  17546 MiB |  15828 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380534 KiB | 380534 KiB |  14379 MiB |  14007 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     146    |     300    |     275    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      20    |     605    |     588    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 36.56383442878723
cuda 3: Peak memory 8.25 GB ; Persistent memory 0.83 GB
cuda 2: Peak memory 7.77 GB ; Persistent memory 0.57 GB
num_iterations = 2
batch_size = 128
num_layers = 32
num_stages = 8
step time = 4.635511875152588
--------------- finish training step 0
0 19.564704418182373
cuda 1: Peak memory 7.77 GB ; Persistent memory 0.57 GB
cuda 3: Peak memory 8.63 GB ; Persistent memory 1.21 GB
step time = 3.7366201877593994
--------------- finish training step 1
1 33.69670748710632
cuda 0: Peak memory 8.26 GB ; Persistent memory 1.31 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1346 MiB |   8460 MiB |  73262 MiB |  71915 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   1718 MiB |   8610 MiB |  17546 MiB |  15828 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 380534 KiB | 380534 KiB |  14485 MiB |  14113 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| Active allocs         |      35    |     201    |    1998    |    1963    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      25    |     146    |     300    |     275    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |      20    |     610    |     593    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 33.69693970680237
cuda 2: Peak memory 7.77 GB ; Persistent memory 0.57 GB
num_iterations = 4
batch_size = 128
num_layers = 32
num_stages = 8
step time = 4.969825983047485
--------------- finish training step 0
0 19.421085596084595
step time = 3.455084800720215
--------------- finish training step 1
1 32.91120791435242
step time = 3.9632742404937744
--------------- finish training step 2
2 47.71273112297058
cuda 1: Peak memory 7.77 GB ; Persistent memory 0.57 GB
cuda 3: Peak memory 8.63 GB ; Persistent memory 1.21 GB
step time = 4.143465518951416
--------------- finish training step 3
3 62.13854956626892
cuda 0: Peak memory 8.76 GB ; Persistent memory 1.81 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1858 MiB |   8972 MiB | 145972 MiB | 144113 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1858 MiB |   8972 MiB | 145972 MiB | 144113 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1858 MiB |   8972 MiB | 145972 MiB | 144113 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   2486 MiB |   9122 MiB |  33694 MiB |  31208 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642678 KiB | 642678 KiB |  31927 MiB |  31299 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      51    |     217    |    3984    |    3933    |
|---------------------------------------------------------------------------|
| Active allocs         |      51    |     217    |    3984    |    3933    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      39    |     154    |     577    |     538    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |      25    |    1309    |    1284    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 62.13880753517151
cuda 2: Peak memory 7.77 GB ; Persistent memory 0.57 GB

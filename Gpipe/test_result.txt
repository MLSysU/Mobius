num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 24.863731622695923
--------------- finish training step 0
0 68.13934707641602
step time = 22.984668731689453
--------------- finish training step 1
1 127.74417638778687
step time = 23.3493914604187
--------------- finish training step 2
2 189.0952832698822
step time = 20.478872299194336
--------------- finish training step 3
3 247.50443530082703
step time = 22.141541719436646
--------------- finish training step 4
4 306.92074847221375
step time = 22.200820207595825
--------------- finish training step 5
5 367.12718391418457
step time = 21.93042016029358
--------------- finish training step 6
6 426.7416923046112
step time = 21.84267282485962
--------------- finish training step 7
7 485.8287544250488
step time = 21.76569414138794
--------------- finish training step 8
8 545.2184550762177
step time = 21.302610635757446
--------------- finish training step 9
9 604.3844294548035
step time = 21.575194120407104
--------------- finish training step 10
10 663.5071449279785
step time = 21.432095050811768
--------------- finish training step 11
11 722.6437270641327
step time = 21.601568460464478
--------------- finish training step 12
12 781.7751159667969
step time = 21.758974313735962
--------------- finish training step 13
13 840.9825239181519
step time = 21.835991144180298
--------------- finish training step 14
14 900.3887033462524
step time = 22.09350562095642
--------------- finish training step 15
15 960.6304540634155
step time = 21.860145807266235
--------------- finish training step 16
16 1020.4389970302582
step time = 21.85204768180847
--------------- finish training step 17
17 1079.9416317939758
step time = 21.835456609725952
--------------- finish training step 18
18 1139.7707901000977
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 21.800004720687866
--------------- finish training step 19
19 1199.3761060237885
cuda 0: Peak memory 16.83 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17236 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17115 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17936 MiB | 421928 MiB | 417926 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    883 MiB | 446635 MiB | 446007 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     551    |   10980    |   10855    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   32272    |   32227    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1199.3764629364014
cuda 3: Peak memory 14.03 GB ; Persistent memory 0.80 GB


num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 19.516377925872803
--------------- finish training step 0
0 74.55824685096741
step time = 18.18209719657898
--------------- finish training step 1
1 136.20972180366516
step time = 18.6065993309021
--------------- finish training step 2
2 197.38808250427246
step time = 18.393953561782837
--------------- finish training step 3
3 258.9843258857727
step time = 18.51820158958435
--------------- finish training step 4
4 321.4902503490448
step time = 18.11265277862549
--------------- finish training step 5
5 382.9077935218811
step time = 18.495360374450684
--------------- finish training step 6
6 445.37020564079285
step time = 18.18320941925049
--------------- finish training step 7
7 507.059814453125
step time = 18.57143497467041
--------------- finish training step 8
8 569.9550542831421
step time = 18.128587245941162
--------------- finish training step 9
9 631.4895629882812
step time = 18.530179977416992
--------------- finish training step 10
10 694.1871271133423
step time = 18.247605562210083
--------------- finish training step 11
11 755.5223579406738
step time = 18.835952758789062
--------------- finish training step 12
12 818.6063349246979
step time = 26.69263243675232
--------------- finish training step 13
13 917.8313257694244
step time = 20.298486709594727
--------------- finish training step 14
14 987.9715349674225
step time = 20.068352699279785
--------------- finish training step 15
15 1057.7963345050812
step time = 19.626797437667847
--------------- finish training step 16
16 1125.567174911499
step time = 19.03800654411316
--------------- finish training step 17
17 1191.9485189914703
step time = 19.536311864852905
--------------- finish training step 18
18 1258.977870941162
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 18.995842456817627
--------------- finish training step 19
19 1324.6733400821686
cuda 0: Peak memory 16.17 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16558 MiB |   1593 GiB |   1590 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  17250 MiB | 413812 MiB | 409810 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    911 MiB | 423331 MiB | 422703 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     125    |     538    |   10846    |   10721    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      45    |      58    |   31209    |   31164    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1324.6737008094788
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 21.08063578605652
--------------- finish training step 0
0 80.2094738483429

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
offload_parallel=True
step time = 18.675775051116943
--------------- finish training step 0
0 44.61975407600403
step time = 15.529860496520996
--------------- finish training step 1
1 75.8632128238678
step time = 15.419750690460205
--------------- finish training step 2
2 107.04262399673462
step time = 15.288419246673584
--------------- finish training step 3
3 139.95732259750366
step time = 15.914733648300171
--------------- finish training step 4
4 172.97492575645447
step time = 17.275418281555176
--------------- finish training step 5
5 207.7070460319519
step time = 17.698665618896484
--------------- finish training step 6
6 242.28898644447327
step time = 17.438642501831055
--------------- finish training step 7
7 276.8655014038086
step time = 17.946666955947876
--------------- finish training step 8
8 313.2763681411743
step time = 18.066956281661987
--------------- finish training step 9
9 350.1675250530243
step time = 18.13210892677307
--------------- finish training step 10
10 385.66743659973145
step time = 17.614225149154663
--------------- finish training step 11
11 421.86288189888
step time = 17.73995804786682
--------------- finish training step 12
12 458.10243248939514
step time = 18.13353419303894
--------------- finish training step 13
13 493.3263623714447
step time = 18.168978691101074
--------------- finish training step 14
14 529.0224533081055
step time = 17.87777614593506
--------------- finish training step 15
15 565.2812049388885
step time = 17.624396800994873
--------------- finish training step 16
16 601.3664436340332
step time = 18.127846002578735
--------------- finish training step 17
17 637.271810054779
step time = 17.180988073349
--------------- finish training step 18
18 672.2906241416931
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
step time = 16.932090520858765
--------------- finish training step 19
19 706.4169690608978
cuda 0: Peak memory 16.74 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17143 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17030 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4002 MiB |  19826 MiB | 384664 MiB | 380662 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 642739 KiB |    858 MiB | 295201 MiB | 294574 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     152    |     596    |   10166    |   10014    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      47    |      66    |   22142    |   22095    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 706.4170227050781
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
step time = 24.710232973098755
--------------- finish training step 0
0 72.15781331062317
step time = 21.885071516036987
--------------- finish training step 1
1 133.18341493606567
step time = 25.32851767539978
--------------- finish training step 2
2 198.25091886520386
step time = 19.593878030776978
--------------- finish training step 3
3 258.63245677948
step time = 20.684062004089355
--------------- finish training step 4
4 321.7777247428894
step time = 20.418142080307007
--------------- finish training step 5
5 384.8710401058197
step time = 20.510064363479614
--------------- finish training step 6
6 447.6583638191223
step time = 20.512695789337158
--------------- finish training step 7
7 511.39996433258057
step time = 20.515226125717163
--------------- finish training step 8
8 575.8372778892517
step time = 20.16586709022522
--------------- finish training step 9
9 640.1412084102631
step time = 18.05255675315857
--------------- finish training step 10
10 700.7620093822479
step time = 17.180485486984253
--------------- finish training step 11
11 760.8219766616821
step time = 18.646287441253662
--------------- finish training step 12
12 821.7458672523499
step time = 18.600390672683716
--------------- finish training step 13
13 879.9301719665527
step time = 18.57701587677002
--------------- finish training step 14
14 938.7449312210083
step time = 18.697574615478516
--------------- finish training step 15
15 996.8560156822205
step time = 18.753479480743408
--------------- finish training step 16
16 1055.2936544418335
step time = 18.72821307182312
--------------- finish training step 17
17 1113.650264263153
step time = 18.480738162994385
--------------- finish training step 18
18 1172.1280798912048
step time = 18.248053312301636
--------------- finish training step 19
19 1229.496661901474
cuda 0: Peak memory 18.12 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18559 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18446 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  19736 MiB | 386172 MiB | 382026 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1080 MiB | 465214 MiB | 464443 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     790    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     577    |   10123    |    9984    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      79    |   28996    |   28940    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1229.4967288970947
cuda 3: Peak memory 14.68 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 14.12 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.12 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 23.53296160697937
--------------- finish training step 0
0 77.49955940246582
step time = 22.23126745223999
--------------- finish training step 1
1 141.22230553627014
step time = 22.730512857437134
--------------- finish training step 2
2 211.95583510398865
step time = 22.882915496826172
--------------- finish training step 3
3 280.39039158821106
step time = 19.194226026535034
--------------- finish training step 4
4 343.44962310791016
step time = 19.652443885803223
--------------- finish training step 5
5 407.216609954834
step time = 19.73197841644287
--------------- finish training step 6
6 471.59037494659424
step time = 19.678691387176514
--------------- finish training step 7
7 535.4801247119904
step time = 19.58760929107666
--------------- finish training step 8
8 599.254998922348
step time = 19.283612728118896
--------------- finish training step 9
9 662.7395868301392
step time = 20.258301973342896
--------------- finish training step 10
10 729.4503121376038
step time = 20.3509521484375
--------------- finish training step 11
11 795.1337962150574
step time = 20.559025287628174
--------------- finish training step 12
12 860.7982959747314
step time = 20.42425012588501
--------------- finish training step 13
13 925.2704739570618
step time = 20.448516845703125
--------------- finish training step 14
14 990.6466081142426
step time = 20.447324752807617
--------------- finish training step 15
15 1055.71058011055
step time = 20.395715951919556
--------------- finish training step 16
16 1121.2480461597443
step time = 20.650866508483887
--------------- finish training step 17
17 1187.3548674583435
step time = 20.26167941093445
--------------- finish training step 18
18 1252.5649244785309
step time = 20.615692615509033
--------------- finish training step 19
19 1318.4851989746094
cuda 0: Peak memory 16.71 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17110 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   4146 MiB |  18278 MiB | 383572 MiB | 379426 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory |    771 MiB |   1104 MiB | 453226 MiB | 452455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     139    |     550    |   10081    |    9942    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      56    |      78    |   28395    |   28339    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 1318.4852530956268
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB

num_iterations = 20
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
num_stages = 8
use_prefetch = True
step time = 21.424659967422485
step time = 21.424659967422485
--------------- finish training step 0
0 54.08203434944153
step time = 18.320717573165894
0 54.08203434944153
step time = 18.320717573165894
--------------- finish training step 1
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
1 45.21644139289856
step time = 19.100518941879272
--------------- finish training step 2
2 45.28731608390808
step time = 20.00524115562439
--------------- finish training step 3
3 50.03033995628357
step time = 19.15398359298706
--------------- finish training step 4
4 46.59624481201172
step time = 19.587273597717285
--------------- finish training step 5
5 47.776249408721924
step time = 19.267416954040527
--------------- finish training step 6
6 45.47434425354004
step time = 18.833250284194946
--------------- finish training step 7
7 45.65481400489807
step time = 18.49544095993042
--------------- finish training step 8
8 43.53238296508789
step time = 18.89436388015747
--------------- finish training step 9
9 39.869444131851196
step time = 18.544747591018677
--------------- finish training step 10
10 40.26069784164429
step time = 18.457677841186523
--------------- finish training step 11
11 40.815765142440796
step time = 18.920860290527344
--------------- finish training step 12
12 40.88063454627991
step time = 18.582810401916504
--------------- finish training step 13
13 41.227654457092285
step time = 18.825106859207153
--------------- finish training step 14
14 42.377315521240234
step time = 19.00838828086853
--------------- finish training step 15
15 42.99262452125549
step time = 19.20764660835266
--------------- finish training step 16
16 42.45132279396057
step time = 17.882002353668213
--------------- finish training step 17
17 40.20883083343506
step time = 18.5610990524292
--------------- finish training step 18
18 40.933167695999146
cuda 2: Peak memory 15.60 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 15.98 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 15.60 GB ; Persistent memory 0.55 GB
step time = 19.29251194000244
--------------- finish training step 19
19 41.514888048172
cuda 0: Peak memory 18.19 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  18625 MiB |   1570 GiB |   1566 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  18542 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  20692 MiB |  20692 MiB |  20692 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 306867 KiB |   1390 MiB | 514470 MiB | 514171 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     825    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     825    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     521    |     521    |     521    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      28    |     110    |   28575    |   28547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 496.8130054473877
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
step time = 18.776297330856323
--------------- finish training step 0
0 56.61219573020935
step time = 16.060291051864624
0 56.61219573020935
step time = 16.060291051864624
--------------- finish training step 1
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
1 44.030513286590576
step time = 17.680697441101074
--------------- finish training step 2
2 44.389137268066406
step time = 17.495293378829956
--------------- finish training step 3
3 43.440762996673584
step time = 17.715622186660767
--------------- finish training step 4
4 43.2867271900177
step time = 17.5337073802948
--------------- finish training step 5
5 43.75429940223694
step time = 17.674713611602783
--------------- finish training step 6
6 43.746741771698
step time = 17.594185829162598
--------------- finish training step 7
7 44.37555813789368
step time = 17.601651668548584
--------------- finish training step 8
8 44.20539212226868
step time = 17.764681816101074
--------------- finish training step 9
9 44.381417989730835
step time = 17.52109146118164
--------------- finish training step 10
10 43.960588693618774
step time = 17.5733745098114
--------------- finish training step 11
11 44.57829189300537
step time = 17.574456691741943
--------------- finish training step 12
12 43.72962474822998
step time = 17.863487005233765
--------------- finish training step 13
13 43.939537525177
step time = 17.718647956848145
--------------- finish training step 14
14 43.590102195739746
step time = 17.780826091766357
--------------- finish training step 15
15 43.2314293384552
step time = 17.761051416397095
--------------- finish training step 16
16 43.87802481651306
step time = 17.624540328979492
--------------- finish training step 17
17 43.863649129867554
step time = 17.64651370048523
--------------- finish training step 18
18 44.51986598968506
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
step time = 17.369051456451416
--------------- finish training step 19
19 44.156261682510376
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 539.3357164859772
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
step time = 19.18286156654358
--------------- finish training step 0
0 48.25616478919983
step time = 16.869024515151978
0 48.25616478919983
step time = 16.869024515151978
--------------- finish training step 1
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
1 39.60962414741516
step time = 18.05395793914795
--------------- finish training step 2
2 39.67685031890869
step time = 17.515487909317017
--------------- finish training step 3
3 40.86824679374695
step time = 17.811210870742798
--------------- finish training step 4
4 41.533878803253174
step time = 17.501463174819946
--------------- finish training step 5
5 40.4757034778595
step time = 17.657965421676636
--------------- finish training step 6
6 40.98753237724304
step time = 17.411598205566406
--------------- finish training step 7
7 40.1801381111145
step time = 17.515060663223267
--------------- finish training step 8
8 42.33772826194763
step time = 17.475871086120605
--------------- finish training step 9
9 39.75907325744629
step time = 17.64359974861145
--------------- finish training step 10
10 40.772146701812744
step time = 17.329419136047363
--------------- finish training step 11
11 38.78153443336487
step time = 17.6425940990448
--------------- finish training step 12
12 41.16215419769287
step time = 17.538352966308594
--------------- finish training step 13
13 41.203471183776855
step time = 17.592928171157837
--------------- finish training step 14
14 41.005051136016846
step time = 17.2771418094635
--------------- finish training step 15
15 39.86086583137512
step time = 17.557698726654053
--------------- finish training step 16
16 41.51578688621521
step time = 17.45529556274414
--------------- finish training step 17
17 40.2456328868866
step time = 17.51096200942993
--------------- finish training step 18
18 41.586878538131714
cuda 2: Peak memory 14.31 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.31 GB ; Persistent memory 0.55 GB
step time = 17.339086532592773
--------------- finish training step 19
19 40.147886514663696
cuda 0: Peak memory 16.90 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Allocated memory      |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
| Active memory         |   3374 MiB |  17306 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
| Requested memory      |   3374 MiB |  17210 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
| GPU reserved memory   |  18412 MiB |  18412 MiB |  18412 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
| Non-releasable memory | 163507 KiB |   1178 MiB | 497193 MiB | 497033 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     805    |   73550    |   73353    |
| Allocations           |     197    |     805    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     805    |   73550    |   73352    |
| Active allocs         |     198    |     805    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     507    |     507    |     507    |       0    |
| GPU reserved segments |     507    |     507    |     507    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
| Non-releasable allocs |      20    |     104    |   31386    |   31366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
training time = 468.08039712905884
cuda 3: Peak memory 14.69 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
step time = 22.406066179275513
use_prefetch = False
step time = 22.406066179275513
--------------- finish training step 0
0 65.700026512146
step time = 18.978885173797607
0 65.700026512146
step time = 18.978885173797607
--------------- finish training step 1
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations=3
use_prefetch=True
batch_size=64
step time = 20.160987377166748
1 48.52135348320007
step time = 19.763434410095215
--------------- finish training step 2
2 56.45196032524109
step time = 18.832136631011963
--------------- finish training step 3
3 47.96454620361328
step time = 18.586313724517822
--------------- finish training step 4
4 47.36571502685547
step time = 18.730540990829468
--------------- finish training step 5
5 49.71592378616333
step time = 18.74250364303589
--------------- finish training step 6
6 47.93625020980835
step time = 18.884562015533447
--------------- finish training step 7
7 47.00582814216614
step time = 19.10654878616333
--------------- finish training step 8
8 48.93899583816528
step time = 18.897255182266235
--------------- finish training step 9
9 47.816893339157104
step time = 18.985149383544922
--------------- finish training step 10
10 46.930092334747314
step time = 18.86396884918213
--------------- finish training step 11
11 48.11641049385071
step time = 19.093729734420776
--------------- finish training step 12
12 49.28684616088867
step time = 18.966659545898438
--------------- finish training step 13
13 47.60283422470093
step time = 18.841392278671265
--------------- finish training step 14
14 46.671252965927124
step time = 18.965394258499146
--------------- finish training step 15
15 48.203813314437866
step time = 18.8924241065979
--------------- finish training step 16
16 48.883673429489136
step time = 18.855632781982422
--------------- finish training step 17
17 47.730708360672
step time = 19.00878095626831
--------------- finish training step 18
18 46.50210237503052
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 19.244003295898438
--------------- finish training step 19
19 47.2113561630249
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 601.9070558547974
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB

num_iterations = 20
training time = 54.773149490356445
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = True
use_offload = False
step time = 19.949572324752808
use_offload = False
step time = 19.949572324752808
--------------- finish training step 0
0 48.54816651344299
step time = 17.192211866378784
0 48.54816651344299
step time = 17.192211866378784
--------------- finish training step 1
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
1 32.103787422180176
step time = 16.44982624053955
--------------- finish training step 2
2 33.14992022514343
step time = 16.533552646636963
--------------- finish training step 3
3 30.901418447494507
step time = 18.095605850219727
--------------- finish training step 4
4 33.18610167503357
step time = 17.76594877243042
--------------- finish training step 5
5 33.333815574645996
step time = 17.723686933517456
--------------- finish training step 6
6 33.12539100646973
step time = 17.813742876052856
--------------- finish training step 7
7 33.206478118896484
step time = 18.038920879364014
--------------- finish training step 8
8 33.50744438171387
step time = 17.66461968421936
--------------- finish training step 9
9 32.40119481086731
step time = 17.697691440582275
--------------- finish training step 10
10 32.70739960670471
step time = 17.325775861740112
--------------- finish training step 11
11 31.812811613082886
step time = 17.1203453540802
--------------- finish training step 12
12 31.73154067993164
step time = 18.089245557785034
--------------- finish training step 13
13 32.75497579574585
step time = 16.842804431915283
--------------- finish training step 14
14 32.052006244659424
step time = 16.124306201934814
--------------- finish training step 15
15 30.09652543067932
step time = 17.209527254104614
--------------- finish training step 16
16 31.460948705673218
step time = 17.50953722000122
--------------- finish training step 17
17 32.18345284461975
step time = 17.297082901000977
--------------- finish training step 18
18 32.26112079620361
step time = 17.28240704536438
--------------- finish training step 19
19 33.016340255737305


num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 18.91551637649536
--------------- finish training step 0
0 56.094202518463135
step time = 15.591644048690796
--------------- finish training step 1
1 35.02235245704651
step time = 16.700727224349976
--------------- finish training step 2
2 38.60233426094055
step time = 17.001978874206543
--------------- finish training step 3
3 39.75645852088928
step time = 16.900752305984497
--------------- finish training step 4
4 40.27200102806091
step time = 16.756003618240356
--------------- finish training step 5
5 40.851823568344116
step time = 16.70055389404297
--------------- finish training step 6
6 39.69031023979187
step time = 16.774975776672363
--------------- finish training step 7
7 39.70966196060181
step time = 16.835899591445923
--------------- finish training step 8
8 39.88544988632202
step time = 16.78721308708191
--------------- finish training step 9
9 40.85111713409424
step time = 16.470710039138794
--------------- finish training step 10
10 39.27714705467224
step time = 16.77328133583069
--------------- finish training step 11
11 39.446101903915405
step time = 17.013760566711426
--------------- finish training step 12
12 39.95293354988098
step time = 17.756729125976562
--------------- finish training step 13
13 40.70491600036621
step time = 16.870208501815796
--------------- finish training step 14
14 40.04653024673462
step time = 16.8820858001709
--------------- finish training step 15
15 39.71017932891846
step time = 16.948596239089966
--------------- finish training step 16
16 39.77425837516785
step time = 16.880694150924683
--------------- finish training step 17
17 39.8136043548584
step time = 17.142284870147705
--------------- finish training step 18
18 40.618656635284424
cuda 3: Peak memory 14.48 GB ; Persistent memory 0.80 GB
cuda 2: Peak memory 14.09 GB ; Persistent memory 0.55 GB
cuda 1: Peak memory 14.09 GB ; Persistent memory 0.55 GB
step time = 17.21035408973694
--------------- finish training step 19
19 40.442079067230225
cuda 0: Peak memory 16.68 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Allocated memory      |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
| Active memory         |   3374 MiB |  17081 MiB |   1570 GiB |   1567 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
| Requested memory      |   3374 MiB |  16998 MiB |   1565 GiB |   1562 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
| GPU reserved memory   |  18766 MiB |  18766 MiB |  18766 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
| Non-releasable memory | 339635 KiB |   1011 MiB | 486038 MiB | 485707 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     789    |   72710    |   72513    |
| Allocations           |     197    |     789    |   72710    |   72513    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     789    |   72710    |   72512    |
| Active allocs         |     198    |     789    |   72710    |   72512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     500    |     500    |     500    |       0    |
| GPU reserved segments |     500    |     500    |     500    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
| Non-releasable allocs |      30    |     106    |   28784    |   28754    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 471.60452485084534
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = True
use_offload = False
step time = 19.12251114845276
--------------- finish training step 0
0 43.66464161872864
step time = 15.67203664779663
--------------- finish training step 1
1 28.545896768569946
step time = 15.987875938415527
--------------- finish training step 2
2 28.66563391685486
step time = 17.17708444595337
--------------- finish training step 3
3 30.382317781448364
step time = 17.64166498184204
--------------- finish training step 4
4 31.663018941879272
step time = 17.64940333366394
--------------- finish training step 5
5 31.66824722290039
step time = 17.903267860412598
--------------- finish training step 6
6 31.436365604400635
step time = 20.92046594619751
--------------- finish training step 7
7 34.29251003265381
step time = 17.946186780929565
--------------- finish training step 8
8 31.8657443523407
step time = 19.449439525604248
--------------- finish training step 9
9 33.71455693244934
step time = 19.906930685043335
--------------- finish training step 10
10 34.53290939331055
step time = 19.109283685684204
--------------- finish training step 11
11 33.14331769943237
step time = 18.885144472122192
--------------- finish training step 12
12 33.04104280471802
step time = 20.192808866500854
--------------- finish training step 13
13 34.2590606212616
step time = 20.00261926651001
--------------- finish training step 14
14 34.37171030044556
step time = 18.838423013687134
--------------- finish training step 15
15 33.465172290802
step time = 17.021500825881958
--------------- finish training step 16
16 31.487219095230103
step time = 18.857378244400024
--------------- finish training step 17
17 32.70635223388672
step time = 17.46001148223877
--------------- finish training step 18
18 31.195889472961426
cuda 1: Peak memory 13.58 GB ; Persistent memory 0.55 GB
cuda 2: Peak memory 13.58 GB ; Persistent memory 0.55 GB
step time = 17.0458505153656
--------------- finish training step 19
19 30.199638843536377
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1592 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19220 MiB |  19220 MiB |  19220 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 163507 KiB |   1398 MiB | 513615 MiB | 513455 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     517    |     517    |     517    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |     108    |   31419    |   31399    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 287.50726985931396
cuda 3: Peak memory 14.06 GB ; Persistent memory 0.80 GB
num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 16
use_prefetch = False
use_offload = False
step time = 19.595433473587036
--------------- finish training step 0
0 59.64639115333557
step time = 16.14384126663208
--------------- finish training step 1
1 37.17316555976868
step time = 17.667024850845337
--------------- finish training step 2
2 42.135369062423706
step time = 17.03650736808777
--------------- finish training step 3
3 42.166722536087036
step time = 17.830848455429077
--------------- finish training step 4
4 49.358429193496704
step time = 17.866095542907715
--------------- finish training step 5
5 47.08287000656128
step time = 16.534761667251587
--------------- finish training step 6
6 40.93154001235962
step time = 16.39327621459961
--------------- finish training step 7
7 41.48125505447388
step time = 16.762920141220093
--------------- finish training step 8
8 41.99731421470642
step time = 16.659029483795166
--------------- finish training step 9
9 41.52932858467102
step time = 16.785332679748535
--------------- finish training step 10
10 41.74692916870117
step time = 18.795286417007446
--------------- finish training step 11
11 43.79169940948486
step time = 18.635895252227783
--------------- finish training step 12
12 44.471111536026
step time = 17.551458597183228
--------------- finish training step 13
13 42.78916692733765
step time = 17.15884256362915
--------------- finish training step 14
14 41.94341540336609
step time = 16.799932956695557
--------------- finish training step 15
15 41.48331809043884
step time = 16.756672382354736
--------------- finish training step 16
16 41.567408084869385
step time = 16.831297636032104
--------------- finish training step 17
17 42.88751435279846
step time = 16.82323718070984
--------------- finish training step 18
18 41.8032660484314
cuda 2: Peak memory 13.55 GB ; Persistent memory 0.55 GB
cuda 3: Peak memory 13.94 GB ; Persistent memory 0.80 GB
cuda 1: Peak memory 13.55 GB ; Persistent memory 0.55 GB
step time = 16.813072204589844
--------------- finish training step 19
19 42.38776755332947
cuda 0: Peak memory 16.15 GB ; Persistent memory 3.30 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Active memory         |   3374 MiB |  16534 MiB |   1593 GiB |   1589 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |   3374 MiB |  16438 MiB |   1588 GiB |   1585 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  17562 MiB |  17562 MiB |  17562 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  97971 KiB |   1194 MiB | 490917 MiB | 490821 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     787    |   73550    |   73353    |
|---------------------------------------------------------------------------|
| Active allocs         |     198    |     787    |   73550    |   73352    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |     103    |   31166    |   31150    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 522.9292905330658

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.180036067962646
step time = 10.180036067962646
--------------- finish training step 0
0 23.298501014709473
step time = 7.600374460220337
0 23.298501014709473
step time = 7.600374460220337
--------------- finish training step 1
1 19.86466693878174
step time = 7.146616220474243
1 19.86466693878174
step time = 7.146616220474243
--------------- finish training step 2
2 18.986379623413086
step time = 8.571488380432129
2 18.986379623413086
step time = 8.571488380432129
--------------- finish training step 3
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB

num_iterations = 4
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.600994110107422
--------------- finish training step 0
0 27.40497922897339
step time = 1.4444868564605713
--------------- finish training step 1
1 9.515098094940186
step time = 3.184945583343506
--------------- finish training step 2
2 11.176170587539673
step time = 1.7937588691711426
--------------- finish training step 3
3 11.166242361068726
cuda 0: Peak memory 16.22 GB ; Persistent memory 1.29 GB
3 20.874300003051758
step time = 9.946103811264038
--------------- finish training step 0
0 22.849830150604248
step time = 8.584599494934082
--------------- finish training step 1
1 21.514347791671753
step time = 7.197113990783691
--------------- finish training step 2
2 19.2327561378479
step time = 8.61336612701416
--------------- finish training step 3
3 23.963775396347046
step time = 9.548201322555542
--------------- finish training step 0
0 25.765099048614502
step time = 8.654855728149414
--------------- finish training step 1
1 22.421194553375244
step time = 8.095655679702759
--------------- finish training step 2
2 21.209608793258667
step time = 7.904263257980347
--------------- finish training step 3
3 21.226181745529175
step time = 10.227857828140259
--------------- finish training step 0
0 24.214826107025146
step time = 8.627290725708008
--------------- finish training step 1
1 21.255467176437378
step time = 8.576191902160645
--------------- finish training step 2
2 21.795112371444702
step time = 7.948586940765381
--------------- finish training step 3
3 21.182910203933716
step time = 10.375868320465088
--------------- finish training step 0
0 26.090709447860718
step time = 8.637608051300049
--------------- finish training step 1
1 21.860855102539062
step time = 8.497534990310669
--------------- finish training step 2
2 21.572016954421997
step time = 7.464922666549683
--------------- finish training step 3
3 19.84934425354004
step time = 10.245680093765259
--------------- finish training step 0
0 24.455897092819214
step time = 8.921340465545654
--------------- finish training step 1
1 21.86672854423523
step time = 8.372417688369751
--------------- finish training step 2
2 21.297621965408325
step time = 8.07869005203247
--------------- finish training step 3
3 20.776899576187134
step time = 8.758683919906616
--------------- finish training step 4
4 21.850149631500244
step time = 17.19256067276001
--------------- finish training step 5
5 30.107696294784546
step time = 10.55281949043274
--------------- finish training step 6
6 27.67627263069153
step time = 8.992091417312622
--------------- finish training step 7
7 22.83240509033203
step time = 10.405261039733887
--------------- finish training step 8
8 22.859561681747437
step time = 7.568641424179077
--------------- finish training step 9
9 20.387329816818237
step time = 7.844952344894409
--------------- finish training step 10
10 20.602288007736206
step time = 8.620687484741211
--------------- finish training step 11
11 21.860384941101074
step time = 7.409484624862671
--------------- finish training step 12
12 20.06096911430359
step time = 8.219304323196411
--------------- finish training step 13
13 21.070324659347534
step time = 7.894707441329956
--------------- finish training step 14
14 21.46690082550049
step time = 7.433696269989014
--------------- finish training step 15
15 19.93248748779297
step time = 8.59566617012024
--------------- finish training step 16
16 21.567813634872437
step time = 7.153587818145752
--------------- finish training step 17
17 19.8344783782959
step time = 8.451725959777832
--------------- finish training step 18
18 21.068260431289673
step time = 7.246865510940552
--------------- finish training step 19
19 19.484667539596558
cuda 0: Peak memory 18.27 GB ; Persistent memory 0.84 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 2         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    863 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    895 MiB |  18713 MiB |   3080 GiB |   3079 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    895 MiB |  18631 MiB |   3071 GiB |   3070 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  35746 MiB |  44108 MiB |  95014 MiB |  59268 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 311799 KiB |   1955 MiB |    922 GiB |    922 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      18    |     843    |  144902    |  144884    |
|---------------------------------------------------------------------------|
| Active allocs         |      20    |     843    |  144902    |  144882    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     964    |    1298    |    2707    |    1743    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     126    |   52389    |   52366    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 263.09644174575806
cuda 1: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 2: Peak memory 15.68 GB ; Persistent memory 0.60 GB
cuda 3: Peak memory 16.07 GB ; Persistent memory 0.84 GB

num_iterations = 20
batch_size = 64
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.525535583496094
--------------- finish training step 0
0 29.448948621749878
step time = 7.097088813781738
--------------- finish training step 1
1 17.279617309570312
step time = 9.885040283203125
--------------- finish training step 0
0 20.28204107284546
step time = 7.365418910980225
--------------- finish training step 1
1 17.43230366706848
step time = 10.103328466415405
--------------- finish training step 0
0 21.366511821746826
step time = 7.378365993499756
--------------- finish training step 1
1 17.410562753677368
step time = 10.049835443496704
--------------- finish training step 0
0 21.349315404891968
step time = 7.523381948471069
--------------- finish training step 1
1 17.91798758506775
step time = 10.078152894973755
--------------- finish training step 0
0 21.9055233001709
step time = 7.35413670539856
--------------- finish training step 1
1 17.3370840549469
step time = 8.77133846282959
--------------- finish training step 2
2 19.62940263748169
step time = 7.868212938308716
--------------- finish training step 3
3 18.316538095474243
step time = 8.322901248931885
--------------- finish training step 4
4 19.187187671661377
step time = 8.42562484741211
--------------- finish training step 5
5 19.067073822021484
step time = 7.64095664024353
--------------- finish training step 6
6 18.147786140441895
step time = 8.607338428497314
--------------- finish training step 7
7 19.30187726020813
step time = 7.363936424255371
--------------- finish training step 8
8 17.744693994522095
step time = 8.81081485748291
--------------- finish training step 9
9 19.62404155731201
step time = 7.384002923965454
--------------- finish training step 10
10 17.750698804855347
step time = 8.891631841659546
--------------- finish training step 11
11 19.908173322677612
step time = 7.578248739242554
--------------- finish training step 12
12 17.815377950668335
step time = 8.790925025939941
--------------- finish training step 13
13 20.015196323394775
step time = 7.724750518798828
--------------- finish training step 14
14 18.106260299682617
step time = 8.503696918487549
--------------- finish training step 15
15 19.586467742919922
step time = 8.070767879486084
--------------- finish training step 16
16 18.801446437835693
step time = 7.69559383392334
--------------- finish training step 17
17 18.35729956626892
step time = 8.202224731445312
--------------- finish training step 18
18 19.23240900039673
step time = 7.65532922744751
--------------- finish training step 19
19 18.771678924560547
cuda 0: Peak memory 18.21 GB ; Persistent memory 0.76 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    782 MiB |  18650 MiB |   2156 GiB |   2156 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    814 MiB |  18650 MiB |   2156 GiB |   2155 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    814 MiB |  18550 MiB |   2150 GiB |   2149 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  19914 MiB |  19914 MiB |  19914 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  85751 KiB |   1351 MiB | 752647 MiB | 752564 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     833    |  101427    |  101419    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     833    |  101427    |  101417    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     515    |     515    |     515    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      99    |   41271    |   41262    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 214.86233043670654
cuda 1: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 2: Peak memory 15.36 GB ; Persistent memory 0.28 GB
cuda 3: Peak memory 15.83 GB ; Persistent memory 0.60 GB

num_iterations = 20
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 10.388191223144531
--------------- finish training step 0
0 32.45280909538269
step time = 8.409068822860718
--------------- finish training step 1
1 19.320743083953857
step time = 9.658365964889526
--------------- finish training step 0
0 22.85837745666504
step time = 7.769536018371582
--------------- finish training step 1
1 21.189732313156128
step time = 9.534030199050903
--------------- finish training step 0
0 22.71248197555542
step time = 7.510866403579712
--------------- finish training step 1
1 17.773910999298096
step time = 9.858023405075073
--------------- finish training step 0
0 21.43290615081787
step time = 8.175463676452637
--------------- finish training step 1
1 18.77081608772278
step time = 9.75309705734253
--------------- finish training step 0
0 20.335635662078857
step time = 8.492257356643677
--------------- finish training step 1
1 19.33380889892578
step time = 7.165947914123535
--------------- finish training step 2
2 17.625859022140503
step time = 8.489813327789307
--------------- finish training step 3
3 19.619999647140503
step time = 7.180657386779785
--------------- finish training step 4
4 17.622913360595703
step time = 8.375628471374512
--------------- finish training step 5
5 19.78968644142151
step time = 7.544250965118408
--------------- finish training step 6
6 18.238121032714844
step time = 7.962826251983643
--------------- finish training step 7
7 19.00403618812561
step time = 8.010213375091553
--------------- finish training step 8
8 19.41239285469055
step time = 7.210340738296509
--------------- finish training step 9
9 17.620264291763306
step time = 8.352503538131714
--------------- finish training step 10
10 19.714614629745483
step time = 7.149158954620361
--------------- finish training step 11
11 17.475462913513184
step time = 8.404289722442627
--------------- finish training step 12
12 19.94911479949951
step time = 7.06643009185791
--------------- finish training step 13
13 17.447338104248047
step time = 8.445520401000977
--------------- finish training step 14
14 19.891947507858276
step time = 7.117880821228027
--------------- finish training step 15
15 17.51951241493225
step time = 8.329583644866943
--------------- finish training step 16
16 19.285008430480957
step time = 7.136727571487427
--------------- finish training step 17
17 17.623753309249878
step time = 8.27351450920105
--------------- finish training step 18
18 19.271270036697388
step time = 7.108473300933838
--------------- finish training step 19
19 17.45956587791443
cuda 0: Peak memory 32.12 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  32889 MiB |   3756 GiB |   3755 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34682 MiB |  34682 MiB |  34682 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB |   2110 MiB |   1118 GiB |   1118 GiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     833    |  102995    |  102987    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     833    |  102995    |  102985    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     559    |     559    |     559    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      82    |   40733    |   40728    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 216.66805577278137
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.700294971466064
--------------- finish training step 0
0 30.82059669494629
step time = 6.926929235458374
--------------- finish training step 1
1 16.85610604286194
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.33 GB
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.57 GB
step time = 7.726982593536377
--------------- finish training step 2
2 18.20749068260193
cuda 0: Peak memory 27.87 GB ; Persistent memory 1.57 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   1606 MiB |  28537 MiB | 412996 MiB | 411390 MiB |
|---------------------------------------------------------------------------|
| Active memory         |   1670 MiB |  28537 MiB | 412996 MiB | 411326 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |   1670 MiB |  28537 MiB | 412996 MiB | 411325 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 349813 KiB |    833 MiB |  83846 MiB |  83505 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      49    |     697    |   11424    |   11375    |
|---------------------------------------------------------------------------|
| Active allocs         |      52    |     697    |   11424    |   11372    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      36    |    3565    |    3550    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 41.52961826324463
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.33 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.825533151626587
--------------- finish training step 0
0 30.3154513835907
step time = 6.971526145935059
--------------- finish training step 1
1 16.7472927570343
step time = 9.742247581481934
--------------- finish training step 0
0 20.12493586540222
step time = 7.316663026809692
--------------- finish training step 1
1 17.430805683135986
step time = 10.103415966033936
--------------- finish training step 0
0 23.12777042388916
step time = 8.665213108062744
--------------- finish training step 1
1 19.87171483039856
step time = 14.87504267692566
--------------- finish training step 0
0 26.081040143966675
step time = 9.161521673202515
--------------- finish training step 1
1 22.653180599212646
step time = 10.025335788726807
--------------- finish training step 0
0 20.92841148376465
step time = 8.367968559265137
--------------- finish training step 1
1 18.990674257278442
step time = 7.18370509147644
--------------- finish training step 2
2 17.43733048439026
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 344846 MiB | 344764 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      35    |   14045    |   14040    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 31.77884578704834
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.323086261749268
--------------- finish training step 0
0 29.83410334587097
step time = 6.912308216094971
--------------- finish training step 1
1 16.987714767456055
step time = 9.932269811630249
--------------- finish training step 0
0 21.223907947540283
step time = 8.109301805496216
--------------- finish training step 1
1 19.40508460998535
step time = 9.785153865814209
--------------- finish training step 0
0 21.00533628463745
step time = 8.340044975280762
--------------- finish training step 1
1 19.265332460403442
step time = 9.672089338302612
--------------- finish training step 0
0 20.280792713165283
step time = 8.60212516784668
--------------- finish training step 1
1 20.143778085708618
step time = 10.235557317733765
--------------- finish training step 0
0 21.93871545791626
step time = 8.620615720748901
--------------- finish training step 1
1 19.923208236694336
step time = 10.133023500442505
--------------- finish training step 2
2 21.328728437423706
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.54 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 732693 KiB | 344590 MiB | 344508 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      35    |   14032    |   14027    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.20090174674988
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.819866418838501
--------------- finish training step 0
0 30.042145252227783
step time = 6.938736200332642
--------------- finish training step 1
1 16.763733386993408
step time = 9.607038974761963
--------------- finish training step 0
0 19.8370623588562
step time = 7.203342437744141
--------------- finish training step 1
1 17.45730757713318
step time = 9.787200212478638
--------------- finish training step 0
0 20.71773862838745
step time = 8.202457904815674
--------------- finish training step 1
1 18.72393560409546
step time = 10.080139636993408
--------------- finish training step 0
0 26.684693098068237
step time = 8.087461709976196
--------------- finish training step 1
1 19.05155062675476
step time = 9.538063049316406
--------------- finish training step 0
0 20.088014841079712
step time = 7.247832298278809
--------------- finish training step 1
1 17.866029977798462
step time = 7.980339050292969
--------------- finish training step 2
2 18.85814332962036
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.43 GB ; Persistent memory 0.61 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 345806 MiB | 345724 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      34    |   14055    |   14050    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 32.04544138908386
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.636011600494385
--------------- finish training step 0
0 29.67675018310547
step time = 6.998462200164795
--------------- finish training step 1
1 16.83334445953369
step time = 9.382531642913818
--------------- finish training step 0
0 19.174596309661865
step time = 9.668797731399536
--------------- finish training step 1
1 22.577726125717163
step time = 9.75375747680664
--------------- finish training step 0
0 25.191123962402344
step time = 7.331257104873657
--------------- finish training step 1
1 23.750856161117554
step time = 9.841214179992676
--------------- finish training step 0
0 21.667083263397217
step time = 8.330809831619263
--------------- finish training step 1
1 19.137477159500122
step time = 9.654526472091675
--------------- finish training step 0
0 19.920425415039062
step time = 8.590058326721191
--------------- finish training step 1
1 19.12352466583252
step time = 7.203738689422607
--------------- finish training step 2
2 17.582097053527832
cuda 3: Peak memory 27.35 GB ; Persistent memory 0.54 GB
cuda 2: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 26.88 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.87 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28537 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  29092 MiB |  29092 MiB |  29092 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 765461 KiB | 346062 MiB | 345980 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     697    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     697    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     494    |     494    |     494    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      34    |   14075    |   14070    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 31.17715549468994
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 9.758909225463867
--------------- finish training step 0
0 32.29473257064819
step time = 8.143991947174072
--------------- finish training step 1
1 20.583457231521606
step time = 9.784606456756592
--------------- finish training step 0
0 21.839608192443848
step time = 8.47372317314148
--------------- finish training step 1
1 19.831454753875732
step time = 9.59046721458435
--------------- finish training step 0
0 20.57792019844055
step time = 8.117748975753784
--------------- finish training step 1
1 19.348073482513428
step time = 9.703936576843262
--------------- finish training step 0
0 20.901787519454956
step time = 7.019090890884399
--------------- finish training step 1
1 18.3791401386261
step time = 9.828765869140625
--------------- finish training step 0
0 22.22789478302002
step time = 8.268155813217163
--------------- finish training step 1
1 19.551173210144043
step time = 7.268896102905273
--------------- finish training step 2
2 18.217031240463257
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.29 GB
cuda 0: Peak memory 27.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28820 MiB |  28820 MiB |  28820 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 691557 KiB | 337368 MiB | 337286 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     685    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     685    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     491    |     491    |     491    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      25    |   13463    |   13458    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.62977147102356
cuda 3: Peak memory 27.34 GB ; Persistent memory 0.54 GB
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.29 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 11.907840967178345
--------------- finish training step 0
0 37.96296167373657
step time = 10.536652088165283
--------------- finish training step 1
1 24.12561297416687
step time = 13.62424898147583
--------------- finish training step 0
0 26.755193948745728
step time = 10.089781999588013
--------------- finish training step 1
1 25.382238388061523
step time = 10.795048952102661
--------------- finish training step 0
0 25.2339768409729
step time = 8.129295349121094
--------------- finish training step 1
1 24.86712408065796
step time = 10.54201626777649
--------------- finish training step 0
0 23.905683517456055
step time = 8.65411901473999
--------------- finish training step 1
1 21.263031482696533
step time = 10.743642330169678
--------------- finish training step 0
0 22.64579749107361
step time = 9.044533014297485
--------------- finish training step 1
1 21.940186977386475
step time = 7.838865756988525
--------------- finish training step 2
2 20.6036958694458
cuda 0: Peak memory 27.86 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  28529 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  28820 MiB |  28820 MiB |  28820 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 691557 KiB | 338488 MiB | 338406 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     685    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     685    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     491    |     491    |     491    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      25    |   13498    |   13493    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 37.5621280670166
cuda 1: Peak memory 26.87 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 27.34 GB ; Persistent memory 0.54 GB
cuda 2: Peak memory 26.87 GB ; Persistent memory 0.29 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 11.916611433029175
--------------- finish training step 0
0 39.656327962875366
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 24.00110960006714
--------------- finish training step 0
0 69.80800104141235
step time = 0.0003046989440917969
--------------- finish training step 1
1 10.880838394165039
step time = 0.00026416778564453125
--------------- finish training step 2
2 11.02877688407898
cuda 2: Peak memory 32.94 GB ; Persistent memory 12.43 GB
cuda 0: Peak memory 33.92 GB ; Persistent memory 13.67 GB
cuda 3: Peak memory 33.40 GB ; Persistent memory 12.68 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  13998 MiB |  34737 MiB | 412612 MiB | 398613 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34956 MiB |  34956 MiB |  34956 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory | 527467 KiB | 658783 KiB |  67261 MiB |  66746 MiB |
|---------------------------------------------------------------------------|
| Allocations           |     397    |     881    |   11040    |   10643    |
|---------------------------------------------------------------------------|
| Active allocs         |     398    |     881    |   11040    |   10642    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     599    |     599    |     599    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      20    |      23    |    2921    |    2901    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 67.71541786193848
cuda 1: Peak memory 32.94 GB ; Persistent memory 12.43 GB
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 22.6373929977417
--------------- finish training step 0
0 67.95425415039062
step time = 0.00030040740966796875
--------------- finish training step 1
1 10.211488723754883
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 25.637232542037964
--------------- finish training step 0
0 70.5726523399353
step time = 0.00025463104248046875
--------------- finish training step 1
1 9.481906414031982
step time = 27.25737476348877
--------------- finish training step 0
0 56.48922300338745
step time = 0.0008327960968017578
--------------- finish training step 1
1 10.822683572769165
step time = 27.83768892288208
--------------- finish training step 0
0 57.51945734024048
step time = 0.00028824806213378906
--------------- finish training step 1
1 10.166680335998535
step time = 27.149933338165283
--------------- finish training step 0
0 55.92431163787842
step time = 0.0002884864807128906
--------------- finish training step 1
1 10.2383394241333
step time = 27.493374347686768
--------------- finish training step 0
0 57.42056894302368
step time = 0.00031185150146484375
--------------- finish training step 1
1 9.352262020111084
step time = 0.0008356571197509766
--------------- finish training step 2
2 9.261133909225464
cuda 2: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 33.40 GB ; Persistent memory 0.54 GB
cuda 0: Peak memory 33.92 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  34956 MiB |  34956 MiB |  34956 MiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  83703 KiB | 658783 KiB | 312755 MiB | 312674 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     881    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     881    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     599    |     599    |     599    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      32    |   13047    |   13042    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 48.53898477554321
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 26.469393491744995
--------------- finish training step 0
0 56.06120443344116
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
num_iterations = 3
batch_size = 128
num_layers = 32
num_stages = 8
use_prefetch = False
use_offload = False
step time = 25.660261631011963
--------------- finish training step 0
0 56.489152669906616
step time = 0.0003230571746826172
--------------- finish training step 1
1 10.703224897384644
step time = 26.44949197769165
--------------- finish training step 0
0 42.74637985229492
step time = 0.0006339550018310547
--------------- finish training step 1
1 11.330305337905884
step time = 25.192777395248413
--------------- finish training step 0
0 41.80966806411743
step time = 0.0002827644348144531
--------------- finish training step 1
1 10.0082426071167
step time = 26.548762798309326
--------------- finish training step 0
0 41.60054397583008
step time = 0.0006091594696044922
--------------- finish training step 1
1 11.121718168258667
step time = 27.443828344345093
--------------- finish training step 0
0 41.876142740249634
step time = 0.0003058910369873047
--------------- finish training step 1
1 10.153691530227661
step time = 0.0008194446563720703
--------------- finish training step 2
2 9.622679233551025
cuda 0: Peak memory 33.92 GB ; Persistent memory 0.78 GB
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    798 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Active memory         |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |    862 MiB |  34737 MiB |   1476 GiB |   1475 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  14620 MiB |  35138 MiB | 118014 MiB | 103394 MiB |
|---------------------------------------------------------------------------|
| Non-releasable memory | 116471 KiB |   1099 MiB | 285957 MiB | 285843 MiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |     881    |   40469    |   40461    |
|---------------------------------------------------------------------------|
| Active allocs         |      10    |     881    |   40469    |   40459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     257    |     600    |    2001    |    1744    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      39    |   10807    |   10801    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

training time = 34.207101583480835
cuda 2: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 1: Peak memory 32.94 GB ; Persistent memory 0.29 GB
cuda 3: Peak memory 33.48 GB ; Persistent memory 0.61 GB
